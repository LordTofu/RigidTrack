<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Rigid Track: RigidTrack/main.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="icon.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Rigid Track
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('main_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">main.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Header file for <a class="el" href="main_8cpp.html" title="Rigid Track main file that contains most functionallity. ">main.cpp</a>.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;fstream&gt;</code><br />
<code>#include &lt;windows.h&gt;</code><br />
<code>#include &lt;conio.h&gt;</code><br />
<code>#include &lt;tchar.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;stdarg.h&gt;</code><br />
<code>#include &lt;ctype.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;gl/glu.h&gt;</code><br />
<code>#include &lt;sstream&gt;</code><br />
<code>#include &lt;thread&gt;</code><br />
<code>#include &lt;future&gt;</code><br />
<code>#include &lt;atomic&gt;</code><br />
<code>#include &quot;communication.h&quot;</code><br />
<code>#include &quot;<a class="el" href="_rigid_track_8h_source.html">RigidTrack.h</a>&quot;</code><br />
<code>#include &lt;QtWidgets/QApplication&gt;</code><br />
<code>#include &lt;QUdpSocket&gt;</code><br />
<code>#include &quot;cameralibrary.h&quot;</code><br />
<code>#include &quot;modulevector.h&quot;</code><br />
<code>#include &quot;modulevectorprocessing.h&quot;</code><br />
<code>#include &quot;coremath.h&quot;</code><br />
<code>#include &lt;opencv\cv.h&gt;</code><br />
<code>#include &quot;opencv2\core.hpp&quot;</code><br />
<code>#include &quot;opencv2\calib3d.hpp&quot;</code><br />
<code>#include &lt;opencv2/imgproc/imgproc.hpp&gt;</code><br />
<code>#include &lt;opencv2/calib3d/calib3d.hpp&gt;</code><br />
<code>#include &lt;opencv2/highgui/highgui.hpp&gt;</code><br />
<code>#include &lt;opencv2\video\tracking.hpp&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for main.h:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="main_8h__incl.svg" width="100%" height="496"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="main_8h__dep__incl.svg" width="376" height="187"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<p><a href="main_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3d3afd29ce54eb7fc5cc7e74ab666586"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#a3d3afd29ce54eb7fc5cc7e74ab666586">startTracking</a> ()</td></tr>
<tr class="separator:a3d3afd29ce54eb7fc5cc7e74ab666586"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25183e8d0b386ef12b557efc712a0261"><td class="memItemLeft" align="right" valign="top"><a id="a25183e8d0b386ef12b557efc712a0261"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#a25183e8d0b386ef12b557efc712a0261">startStopCamera</a> ()</td></tr>
<tr class="memdesc:a25183e8d0b386ef12b557efc712a0261"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start or stop the tracking depending on if the camera is currently running or not. <br /></td></tr>
<tr class="separator:a25183e8d0b386ef12b557efc712a0261"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e6662e0f16887fe97c7bebe05065972"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#a1e6662e0f16887fe97c7bebe05065972">setReference</a> ()</td></tr>
<tr class="separator:a1e6662e0f16887fe97c7bebe05065972"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f7c5996cd5a271d0277e0741f73a5b4"><td class="memItemLeft" align="right" valign="top"><a id="a5f7c5996cd5a271d0277e0741f73a5b4"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#a5f7c5996cd5a271d0277e0741f73a5b4">calibrateCamera</a> ()</td></tr>
<tr class="memdesc:a5f7c5996cd5a271d0277e0741f73a5b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start the camera calibration routine that computes the camera matrix and distortion coefficients. <br /></td></tr>
<tr class="separator:a5f7c5996cd5a271d0277e0741f73a5b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad39626702ff983d5fdab4b703bfaf964"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#ad39626702ff983d5fdab4b703bfaf964">loadCalibration</a> (int method)</td></tr>
<tr class="separator:ad39626702ff983d5fdab4b703bfaf964"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a847c0fbd3e513fb76ff145b31a9f5c37"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#a847c0fbd3e513fb76ff145b31a9f5c37">testAlgorithms</a> ()</td></tr>
<tr class="separator:a847c0fbd3e513fb76ff145b31a9f5c37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2104a5d9d6b9f1e29bc4cd858c59882e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#a2104a5d9d6b9f1e29bc4cd858c59882e">projectCoordinateFrame</a> (Mat pictureFrame)</td></tr>
<tr class="separator:a2104a5d9d6b9f1e29bc4cd858c59882e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae624b0189bc5e32cbbb1f178b9f1a360"><td class="memItemLeft" align="right" valign="top"><a id="ae624b0189bc5e32cbbb1f178b9f1a360"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#ae624b0189bc5e32cbbb1f178b9f1a360">setUpUDP</a> ()</td></tr>
<tr class="memdesc:ae624b0189bc5e32cbbb1f178b9f1a360"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open the UDP ports for communication. <br /></td></tr>
<tr class="separator:ae624b0189bc5e32cbbb1f178b9f1a360"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad19da4e648bbdc80d3123eb94711588e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#ad19da4e648bbdc80d3123eb94711588e">setHeadingOffset</a> (double d)</td></tr>
<tr class="separator:ad19da4e648bbdc80d3123eb94711588e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54b6b6db348b48d21e1265e22829c61f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#a54b6b6db348b48d21e1265e22829c61f">sendDataUDP</a> (cv::Vec3d &amp;Position, cv::Vec3d &amp;Euler)</td></tr>
<tr class="separator:a54b6b6db348b48d21e1265e22829c61f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2a8b7de0b15dc17198c147ba39e85f3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#af2a8b7de0b15dc17198c147ba39e85f3">closeUDP</a> ()</td></tr>
<tr class="separator:af2a8b7de0b15dc17198c147ba39e85f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56c7f641859cb2b6b99b0947d03be800"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#a56c7f641859cb2b6b99b0947d03be800">loadMarkerConfig</a> (int method)</td></tr>
<tr class="separator:a56c7f641859cb2b6b99b0947d03be800"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6430ad2592a955a3618549547dfc5be"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#af6430ad2592a955a3618549547dfc5be">drawPositionText</a> (cv::Mat &amp;Picture, cv::Vec3d &amp;Position, cv::Vec3d &amp;Euler, double error)</td></tr>
<tr class="separator:af6430ad2592a955a3618549547dfc5be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af39fa6c3a36ad6bc24a327db7a9d73c2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#af39fa6c3a36ad6bc24a327db7a9d73c2">loadCameraPosition</a> ()</td></tr>
<tr class="separator:af39fa6c3a36ad6bc24a327db7a9d73c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0416912fce6274568e80019b10ba294f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#a0416912fce6274568e80019b10ba294f">determineExposure</a> ()</td></tr>
<tr class="separator:a0416912fce6274568e80019b10ba294f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11ff459289305229597defd39f510959"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#a11ff459289305229597defd39f510959">determineOrder</a> ()</td></tr>
<tr class="separator:a11ff459289305229597defd39f510959"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ad2e3cfb5056dbab2098e0dd3bd353f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#a7ad2e3cfb5056dbab2098e0dd3bd353f">calibrateGround</a> ()</td></tr>
<tr class="separator:a7ad2e3cfb5056dbab2098e0dd3bd353f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab5e634b66221f494504aea1557af5df9"><td class="memItemLeft" align="right" valign="top"><a id="ab5e634b66221f494504aea1557af5df9"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#ab5e634b66221f494504aea1557af5df9">methodPNP</a></td></tr>
<tr class="memdesc:ab5e634b66221f494504aea1557af5df9"><td class="mdescLeft">&#160;</td><td class="mdescRight">solvePNP algorithm 0 = iterative 1 = EPNP 2 = P3P 4 = UPNP //!&lt; 4 and 1 are the same and not implemented correctly by OpenCV <br /></td></tr>
<tr class="separator:ab5e634b66221f494504aea1557af5df9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6266eedab8b3c011be53baffbfc42ab"><td class="memItemLeft" align="right" valign="top"><a id="aa6266eedab8b3c011be53baffbfc42ab"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#aa6266eedab8b3c011be53baffbfc42ab">safetyEnable</a></td></tr>
<tr class="memdesc:aa6266eedab8b3c011be53baffbfc42ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">is the safety feature enabled <br /></td></tr>
<tr class="separator:aa6266eedab8b3c011be53baffbfc42ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a436fb814ccc3f02617dade4dc6511143"><td class="memItemLeft" align="right" valign="top"><a id="a436fb814ccc3f02617dade4dc6511143"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#a436fb814ccc3f02617dade4dc6511143">safety2Enable</a></td></tr>
<tr class="memdesc:a436fb814ccc3f02617dade4dc6511143"><td class="mdescLeft">&#160;</td><td class="mdescRight">is the second receiver enabled <br /></td></tr>
<tr class="separator:a436fb814ccc3f02617dade4dc6511143"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c1b807fcb2de5a6759bd60ccae6dd7e"><td class="memItemLeft" align="right" valign="top"><a id="a2c1b807fcb2de5a6759bd60ccae6dd7e"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#a2c1b807fcb2de5a6759bd60ccae6dd7e">safetyBoxLength</a></td></tr>
<tr class="memdesc:a2c1b807fcb2de5a6759bd60ccae6dd7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">length of the safety area cube in meters <br /></td></tr>
<tr class="separator:a2c1b807fcb2de5a6759bd60ccae6dd7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae65386c3310ab826e84fba757296de9a"><td class="memItemLeft" align="right" valign="top"><a id="ae65386c3310ab826e84fba757296de9a"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#ae65386c3310ab826e84fba757296de9a">safetyAngle</a></td></tr>
<tr class="memdesc:ae65386c3310ab826e84fba757296de9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">bank and pitch angle protection in degrees <br /></td></tr>
<tr class="separator:ae65386c3310ab826e84fba757296de9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab97ac0d82b1753d0eef37089be17e5e1"><td class="memItemLeft" align="right" valign="top"><a id="ab97ac0d82b1753d0eef37089be17e5e1"></a>
QHostAddress&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#ab97ac0d82b1753d0eef37089be17e5e1">IPAdressObject</a></td></tr>
<tr class="memdesc:ab97ac0d82b1753d0eef37089be17e5e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">IPv4 adress of receiver 1. <br /></td></tr>
<tr class="separator:ab97ac0d82b1753d0eef37089be17e5e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afefb1102a8a4a71b55d6f24f46404cc5"><td class="memItemLeft" align="right" valign="top"><a id="afefb1102a8a4a71b55d6f24f46404cc5"></a>
QHostAddress&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#afefb1102a8a4a71b55d6f24f46404cc5">IPAdressSafety</a></td></tr>
<tr class="memdesc:afefb1102a8a4a71b55d6f24f46404cc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">IPv4 adress of safety receiver. <br /></td></tr>
<tr class="separator:afefb1102a8a4a71b55d6f24f46404cc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a354806cf8cbface3575f2541d8fbcbda"><td class="memItemLeft" align="right" valign="top"><a id="a354806cf8cbface3575f2541d8fbcbda"></a>
QHostAddress&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#a354806cf8cbface3575f2541d8fbcbda">IPAdressSafety2</a></td></tr>
<tr class="memdesc:a354806cf8cbface3575f2541d8fbcbda"><td class="mdescLeft">&#160;</td><td class="mdescRight">IPv4 adress of receiver 2. <br /></td></tr>
<tr class="separator:a354806cf8cbface3575f2541d8fbcbda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a00043c93a3362969c1c1fcd3a70fea"><td class="memItemLeft" align="right" valign="top"><a id="a9a00043c93a3362969c1c1fcd3a70fea"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#a9a00043c93a3362969c1c1fcd3a70fea">portObject</a></td></tr>
<tr class="memdesc:a9a00043c93a3362969c1c1fcd3a70fea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Port of receiver 1. <br /></td></tr>
<tr class="separator:a9a00043c93a3362969c1c1fcd3a70fea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a137bc8cc9d53ad9b176c988a99bc7142"><td class="memItemLeft" align="right" valign="top"><a id="a137bc8cc9d53ad9b176c988a99bc7142"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#a137bc8cc9d53ad9b176c988a99bc7142">portSafety</a></td></tr>
<tr class="memdesc:a137bc8cc9d53ad9b176c988a99bc7142"><td class="mdescLeft">&#160;</td><td class="mdescRight">Port of the safety receiver. <br /></td></tr>
<tr class="separator:a137bc8cc9d53ad9b176c988a99bc7142"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2601be9c226be24c71ec8282f632e723"><td class="memItemLeft" align="right" valign="top"><a id="a2601be9c226be24c71ec8282f632e723"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#a2601be9c226be24c71ec8282f632e723">portSafety2</a></td></tr>
<tr class="memdesc:a2601be9c226be24c71ec8282f632e723"><td class="mdescLeft">&#160;</td><td class="mdescRight">Port of receiver 2. <br /></td></tr>
<tr class="separator:a2601be9c226be24c71ec8282f632e723"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cc3bd09f5801804b7ae65846e0b9824"><td class="memItemLeft" align="right" valign="top"><a id="a5cc3bd09f5801804b7ae65846e0b9824"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#a5cc3bd09f5801804b7ae65846e0b9824">invertZ</a></td></tr>
<tr class="memdesc:a5cc3bd09f5801804b7ae65846e0b9824"><td class="mdescLeft">&#160;</td><td class="mdescRight">dummy variable to invert Z direction on request <br /></td></tr>
<tr class="separator:a5cc3bd09f5801804b7ae65846e0b9824"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af29e7fc07ae0979d5fb61b473241d33d"><td class="memItemLeft" align="right" valign="top">commObject&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8h.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a></td></tr>
<tr class="memdesc:af29e7fc07ae0979d5fb61b473241d33d"><td class="mdescLeft">&#160;</td><td class="mdescRight">class that handles the communication from <a class="el" href="main_8cpp.html" title="Rigid Track main file that contains most functionallity. ">main.cpp</a> to the GUI  <a href="#af29e7fc07ae0979d5fb61b473241d33d">More...</a><br /></td></tr>
<tr class="separator:af29e7fc07ae0979d5fb61b473241d33d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header file for <a class="el" href="main_8cpp.html" title="Rigid Track main file that contains most functionallity. ">main.cpp</a>. </p>
<dl class="section author"><dt>Author</dt><dd>Florian J.T. Wachter </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>April, 8th 2017 </dd></dl>

<p class="definition">Definition in file <a class="el" href="main_8h_source.html">main.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a7ad2e3cfb5056dbab2098e0dd3bd353f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ad2e3cfb5056dbab2098e0dd3bd353f">&#9670;&nbsp;</a></span>calibrateGround()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int calibrateGround </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the pose of the camera w.r.t the ground calibration frame. This frame sets the navigation frame for later results. The pose is averaged over 200 samples and then saved in the file referenceData.xml. This routine is basically the same as setReference. </p>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l01581">1581</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;{<span class="comment"></span></div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;<span class="comment">    //! initialize the variables with starting values</span></div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;<span class="comment"></span>    <a class="code" href="main_8cpp.html#acf655f393e3996144226399a338e8d3b">gotOrder</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    <a class="code" href="main_8cpp.html#a9d2e25dbfda0ebcdbb488652c8b15fad">posRef</a> = 0;</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    <a class="code" href="main_8cpp.html#acd6966c004a57c4080ba204152200e7f">eulerRef</a> = 0;</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    <a class="code" href="main_8cpp.html#a4ee4d2abbe47b92c21b81c5c4389086e">RmatRef</a> = 0;</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    <a class="code" href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a> = <a class="code" href="main_8cpp.html#ae101daeaec726e27690c862b7edea825">RvecOriginal</a>;</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    <a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a> = <a class="code" href="main_8cpp.html#a043bf1deaf5d42d47e0cce8982c1f18b">TvecOriginal</a>;</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    <a class="code" href="main_8cpp.html#a0416912fce6274568e80019b10ba294f">determineExposure</a>();</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(<span class="stringliteral">&quot;Started ground calibration&quot;</span>);</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    CameraLibrary_EnableDevelopment();<span class="comment"></span></div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;<span class="comment">    //! Initialize Camera SDK ==--</span></div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="comment"></span>    CameraLibrary::CameraManager::X();</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;<span class="comment">    //! At this point the Camera SDK is actively looking for all connected cameras and will initialize</span></div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="comment">    //! them on it&#39;s own.</span></div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;<span class="comment"></span><span class="comment"></span></div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;<span class="comment">    //! Get a connected camera ================----</span></div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;<span class="comment"></span>    CameraManager::X().WaitForInitialization();</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    Camera *camera = CameraManager::X().GetCamera();</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;<span class="comment">    //! If no device connected, pop a message box and exit ==--</span></div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;<span class="comment"></span>    <span class="keywordflow">if</span> (camera == 0)</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    {</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;        <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(<span class="stringliteral">&quot;No camera found!&quot;</span>);</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;        <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    }</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;<span class="comment">    //! Determine camera resolution to size application window ==----</span></div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;<span class="comment"></span>    <span class="keywordtype">int</span> cameraWidth = camera-&gt;Width();</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    <span class="keywordtype">int</span> cameraHeight = camera-&gt;Height();</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    camera-&gt;GetDistortionModel(<a class="code" href="main_8cpp.html#a9fba099569a2da23e458c2571f69652a">distModel</a>);</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    cv::Mat matFrame(cv::Size(cameraWidth, cameraHeight), CV_8UC1);</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;<span class="comment">    //! Set camera mode to precision mode, it directly provides marker coordinates</span></div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;<span class="comment"></span>    camera-&gt;SetVideoType(Core::PrecisionMode);</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;<span class="comment">    //! Start camera output ==--</span></div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;<span class="comment"></span>    camera-&gt;Start();</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;<span class="comment">    //! Turn on some overlay text so it&#39;s clear things are     ===---</span></div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;<span class="comment">    //! working even if there is nothing in the camera&#39;s view. ===---</span></div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;<span class="comment">    //! Set some other parameters as well of the camera</span></div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;<span class="comment"></span>    camera-&gt;SetTextOverlay(<span class="keyword">true</span>);</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    camera-&gt;SetFrameRate(<a class="code" href="main_8cpp.html#aa5b833b78b107a1a04eb4edba151c0ba">intFrameRate</a>);</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    camera-&gt;SetIntensity(<a class="code" href="main_8cpp.html#a4e18b0b26ecc511ca7d2f2205313e537">intIntensity</a>);</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    camera-&gt;SetIRFilter(<span class="keyword">true</span>);</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    camera-&gt;SetContinuousIR(<span class="keyword">false</span>);</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    camera-&gt;SetHighPowerMode(<span class="keyword">false</span>);</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;<span class="comment">    //! sample some frames and calculate the position and attitude. then average those values and use that as zero position</span></div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;<span class="comment"></span>    <span class="keywordtype">int</span> numberSamples = 0;</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    <span class="keywordtype">int</span> numberToSample = 200;</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    <span class="keywordtype">double</span> projectionError = 0;</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    <span class="keywordflow">while</span> (numberSamples &lt; numberToSample)</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    {<span class="comment"></span></div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;<span class="comment">        //! Fetch a new frame from the camera ===---</span></div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;<span class="comment"></span>        Frame *frame = camera-&gt;GetFrame();</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;        <span class="keywordflow">if</span> (frame)</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;        {<span class="comment"></span></div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;<span class="comment">            //! Ok, we&#39;ve received a new frame, lets do something</span></div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;<span class="comment">            //! with it.</span></div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;<span class="comment"></span>            <span class="keywordflow">if</span> (frame-&gt;ObjectCount() == <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>)</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;            {<span class="comment"></span></div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;<span class="comment">                //!for(int i=0; i&lt;frame-&gt;ObjectCount(); i++)</span></div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;<span class="comment"></span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>; i++)</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                {</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;                    cObject *obj = frame-&gt;Object(i);</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;                    <a class="code" href="main_8cpp.html#a54cb682bd037283c18b5a9a447ff5e5e">list_points2dUnsorted</a>[i] = cv::Point2d(obj-&gt;X(), obj-&gt;Y());</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;                }</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="main_8cpp.html#acf655f393e3996144226399a338e8d3b">gotOrder</a> == <span class="keyword">false</span>)</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;                {</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;                    <a class="code" href="main_8cpp.html#a11ff459289305229597defd39f510959">determineOrder</a>();</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;                }</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;<span class="comment">                //! sort the 2d points with the correct indices as found in the preceeding order determination algorithm</span></div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;<span class="comment"></span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> w = 0; w &lt; <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>; w++)</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;                {</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;                    <a class="code" href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a>[w] = <a class="code" href="main_8cpp.html#a54cb682bd037283c18b5a9a447ff5e5e">list_points2dUnsorted</a>[<a class="code" href="main_8cpp.html#ac06fee052099b9fc9f0826315bb64a4a">pointOrderIndices</a>[w]];</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;                }</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;                <a class="code" href="main_8cpp.html#a85d3d8c8a0e3e9cfb6157c247470d934">list_points2dOld</a> = <a class="code" href="main_8cpp.html#a54cb682bd037283c18b5a9a447ff5e5e">list_points2dUnsorted</a>;</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;<span class="comment">                //!Compute the pose from the 3D-2D corresponses</span></div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;<span class="comment"></span>                solvePnP(<a class="code" href="main_8cpp.html#a933edb4ba1c0589d59020164c2f1ff87">list_points3d</a>, <a class="code" href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a>, <a class="code" href="main_8cpp.html#a53e8957a459b639ca82d938157f3b085">cameraMatrix</a>, <a class="code" href="main_8cpp.html#a8d67876da148be9118bba1c0d017fb57">distCoeffs</a>, <a class="code" href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a>, <a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>, <a class="code" href="main_8cpp.html#ab1cc9be1ff0871bc5de1eb4c2811ae3e">useGuess</a>, <a class="code" href="main_8cpp.html#ab5e634b66221f494504aea1557af5df9">methodPNP</a>);</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;<span class="comment">                //! project the marker 3d points with the solution into the camera image CoSy and calculate difference to true camera image</span></div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;<span class="comment"></span>                projectPoints(<a class="code" href="main_8cpp.html#a933edb4ba1c0589d59020164c2f1ff87">list_points3d</a>, <a class="code" href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a>, <a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>, <a class="code" href="main_8cpp.html#a53e8957a459b639ca82d938157f3b085">cameraMatrix</a>, <a class="code" href="main_8cpp.html#a8d67876da148be9118bba1c0d017fb57">distCoeffs</a>, <a class="code" href="main_8cpp.html#a7b88d0425a68875639d40a17079df819">list_points2dProjected</a>);</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;                projectionError = norm(<a class="code" href="main_8cpp.html#a7b88d0425a68875639d40a17079df819">list_points2dProjected</a>, <a class="code" href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a>);</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;                <span class="keywordflow">if</span> (projectionError &gt; 3)</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;                {</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;                    <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(<span class="stringliteral">&quot;Reprojection error is bigger than 3 pixel. Correct marker configuration loaded?\nMarker position measured precisely?&quot;</span>);</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;                    frame-&gt;Release();</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;                    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;                }</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;                <span class="keywordtype">double</span> maxValue = 0;</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;                <span class="keywordtype">double</span> minValue = 0;</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;                minMaxLoc(<a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>.at&lt;<span class="keywordtype">double</span>&gt;(2), &amp;minValue, &amp;maxValue);</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                <span class="keywordflow">if</span> (maxValue &gt; 10000 || minValue &lt; 0)</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                {</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;                    <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(<span class="stringliteral">&quot;Negative z distance, thats not possible. Start the set zero routine again and check marker configurations.&quot;</span>);</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;                    frame-&gt;Release();</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;                    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;                }</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;                <span class="keywordflow">if</span> (norm(<a class="code" href="main_8cpp.html#a1d543a183197268bcb54a06bf157852c">positionOld</a>) - norm(<a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>) &lt; 0.05)  <span class="comment">//!&lt;Iterative Method needs time to converge to solution</span></div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;<span class="comment"></span>                {</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;                    add(<a class="code" href="main_8cpp.html#a9d2e25dbfda0ebcdbb488652c8b15fad">posRef</a>, <a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>, <a class="code" href="main_8cpp.html#a9d2e25dbfda0ebcdbb488652c8b15fad">posRef</a>);</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;                    add(<a class="code" href="main_8cpp.html#acd6966c004a57c4080ba204152200e7f">eulerRef</a>, <a class="code" href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a>, <a class="code" href="main_8cpp.html#acd6966c004a57c4080ba204152200e7f">eulerRef</a>); <span class="comment">//!&lt; That are not the values of yaw, roll and pitch yet! Rodriguez has to be called first. </span></div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;<span class="comment"></span>                    numberSamples++;    <span class="comment">//!&lt;-- one sample more :D</span></div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;<span class="comment"></span>                    <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.progressUpdate(numberSamples * 100 / numberToSample);</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;                }</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;                <a class="code" href="main_8cpp.html#a1d543a183197268bcb54a06bf157852c">positionOld</a> = <a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>;</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                Mat cFrame(480, 640, CV_8UC3, Scalar(0, 0, 0));</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>; i++)</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;                {</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;                    circle(cFrame, Point(<a class="code" href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a>[i].x, <a class="code" href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a>[i].y), 6, Scalar(0, 225, 0), 3);</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;                }</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;                <a class="code" href="main_8cpp.html#a2104a5d9d6b9f1e29bc4cd858c59882e">projectCoordinateFrame</a>(cFrame);</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;                projectPoints(<a class="code" href="main_8cpp.html#a933edb4ba1c0589d59020164c2f1ff87">list_points3d</a>, <a class="code" href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a>, <a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>, <a class="code" href="main_8cpp.html#a53e8957a459b639ca82d938157f3b085">cameraMatrix</a>, <a class="code" href="main_8cpp.html#a8d67876da148be9118bba1c0d017fb57">distCoeffs</a>, <a class="code" href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a>);</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>; i++)</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;                {</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;                    circle(cFrame, Point(<a class="code" href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a>[i].x, <a class="code" href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a>[i].y), 3, Scalar(225, 0, 0), 3);</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;                }</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;                QPixmap QPFrame;</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;                QPFrame = <a class="code" href="main_8cpp.html#a3e3cc959a7ab6f93ea52863d86373ce5">Mat2QPixmap</a>(cFrame);</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;                <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.changeImage(QPFrame);</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;                QCoreApplication::processEvents();</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;            }</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;            frame-&gt;Release();</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;        }</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    }<span class="comment"></span></div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;<span class="comment">    //! Release camera ==--</span></div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;<span class="comment"></span>    camera-&gt;Release();</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;<span class="comment">    //!Divide by the number of samples to get the mean of the reference position</span></div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;<span class="comment"></span>    divide(<a class="code" href="main_8cpp.html#a9d2e25dbfda0ebcdbb488652c8b15fad">posRef</a>, numberToSample, <a class="code" href="main_8cpp.html#a9d2e25dbfda0ebcdbb488652c8b15fad">posRef</a>);</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    divide(<a class="code" href="main_8cpp.html#acd6966c004a57c4080ba204152200e7f">eulerRef</a>, numberToSample, <a class="code" href="main_8cpp.html#acd6966c004a57c4080ba204152200e7f">eulerRef</a>); <span class="comment">//!&lt; eulerRef is here in Axis Angle notation</span></div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    Rodrigues(<a class="code" href="main_8cpp.html#acd6966c004a57c4080ba204152200e7f">eulerRef</a>, <a class="code" href="main_8cpp.html#a4ee4d2abbe47b92c21b81c5c4389086e">RmatRef</a>);               <span class="comment">//!&lt; axis angle to rotation matrix</span></div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    <a class="code" href="main_8cpp.html#ab2b71933055cf32cc8e5e2100fd7723f">getEulerAngles</a>(<a class="code" href="main_8cpp.html#a4ee4d2abbe47b92c21b81c5c4389086e">RmatRef</a>, <a class="code" href="main_8cpp.html#acd6966c004a57c4080ba204152200e7f">eulerRef</a>);  <span class="comment">//!&lt;  rotation matrix to euler</span></div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;<span class="comment"></span>    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;RmatRef is:\n&quot;</span>;</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <a class="code" href="main_8cpp.html#a4ee4d2abbe47b92c21b81c5c4389086e">RmatRef</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;Reference Position is:\n&quot;</span>;</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <a class="code" href="main_8cpp.html#a9d2e25dbfda0ebcdbb488652c8b15fad">posRef</a> &lt;&lt; <span class="stringliteral">&quot;[mm] \n&quot;</span>;</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;Reference Euler angles are:\n&quot;</span>;</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <a class="code" href="main_8cpp.html#acd6966c004a57c4080ba204152200e7f">eulerRef</a> &lt;&lt; <span class="stringliteral">&quot;[deg] \n&quot;</span>;</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;<span class="comment">    //! Save the obtained calibration coefficients in a file for later use</span></div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<span class="comment"></span>    QString fileName = QFileDialog::getSaveFileName(<span class="keyword">nullptr</span>, <span class="stringliteral">&quot;Save ground calibration file&quot;</span>, <span class="stringliteral">&quot;referenceData.xml&quot;</span>, <span class="stringliteral">&quot;Calibration File (*.xml);;All Files (*)&quot;</span>);</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    FileStorage fs(fileName.toUtf8().constData(), FileStorage::WRITE);</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    fs &lt;&lt; <span class="stringliteral">&quot;M_NC&quot;</span> &lt;&lt; <a class="code" href="main_8cpp.html#a4ee4d2abbe47b92c21b81c5c4389086e">RmatRef</a>;</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    fs &lt;&lt; <span class="stringliteral">&quot;eulerRef&quot;</span> &lt;&lt; <a class="code" href="main_8cpp.html#acd6966c004a57c4080ba204152200e7f">eulerRef</a>;</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    <a class="code" href="main_8cpp.html#a7b795a27447192fa68ef7c2d8ee1adab">strBuf</a> = fs.releaseAndGetString();</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.changeStatus(QString::fromStdString(<a class="code" href="main_8cpp.html#a7b795a27447192fa68ef7c2d8ee1adab">strBuf</a>));</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(<span class="stringliteral">&quot;Saved ground calibration!&quot;</span>);</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.progressUpdate(0);</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;}</div><div class="ttc" id="main_8cpp_html_ac06fee052099b9fc9f0826315bb64a4a"><div class="ttname"><a href="main_8cpp.html#ac06fee052099b9fc9f0826315bb64a4a">pointOrderIndices</a></div><div class="ttdeci">int pointOrderIndices[]</div><div class="ttdoc">old correspondence from list_points3d and list_points_2d </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00115">main.cpp:115</a></div></div>
<div class="ttc" id="main_8cpp_html_ae095f10a005e68d20233dc15b4077ca6"><div class="ttname"><a href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a></div><div class="ttdeci">Mat Rvec</div><div class="ttdoc">rotation vector (axis-angle notation) from camera CoSy to marker CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00099">main.cpp:99</a></div></div>
<div class="ttc" id="main_8cpp_html_a54cb682bd037283c18b5a9a447ff5e5e"><div class="ttname"><a href="main_8cpp.html#a54cb682bd037283c18b5a9a447ff5e5e">list_points2dUnsorted</a></div><div class="ttdeci">std::vector&lt; Point2d &gt; list_points2dUnsorted</div><div class="ttdoc">marker points in 2D camera image CoSy, sorted with increasing x (camera image CoSy) but not sorted to...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00112">main.cpp:112</a></div></div>
<div class="ttc" id="main_8cpp_html_a7b88d0425a68875639d40a17079df819"><div class="ttname"><a href="main_8cpp.html#a7b88d0425a68875639d40a17079df819">list_points2dProjected</a></div><div class="ttdeci">std::vector&lt; Point2d &gt; list_points2dProjected</div><div class="ttdoc">3D marker points projected to 2D in camera image CoSy with the algorithm projectPoints ...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00111">main.cpp:111</a></div></div>
<div class="ttc" id="main_8cpp_html_a3e3cc959a7ab6f93ea52863d86373ce5"><div class="ttname"><a href="main_8cpp.html#a3e3cc959a7ab6f93ea52863d86373ce5">Mat2QPixmap</a></div><div class="ttdeci">QPixmap Mat2QPixmap(cv::Mat src)</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00225">main.cpp:225</a></div></div>
<div class="ttc" id="main_8cpp_html_af29e7fc07ae0979d5fb61b473241d33d"><div class="ttname"><a href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a></div><div class="ttdeci">commObject commObj</div><div class="ttdoc">class that handles the communication from main.cpp to the GUI </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00068">main.cpp:68</a></div></div>
<div class="ttc" id="main_8cpp_html_ab1cc9be1ff0871bc5de1eb4c2811ae3e"><div class="ttname"><a href="main_8cpp.html#ab1cc9be1ff0871bc5de1eb4c2811ae3e">useGuess</a></div><div class="ttdeci">bool useGuess</div><div class="ttdoc">set to true and the algorithm uses the last result as starting value </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00104">main.cpp:104</a></div></div>
<div class="ttc" id="main_8cpp_html_a9fba099569a2da23e458c2571f69652a"><div class="ttname"><a href="main_8cpp.html#a9fba099569a2da23e458c2571f69652a">distModel</a></div><div class="ttdeci">Core::DistortionModel distModel</div><div class="ttdoc">distortion model of the camera </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00126">main.cpp:126</a></div></div>
<div class="ttc" id="main_8cpp_html_a8d67876da148be9118bba1c0d017fb57"><div class="ttname"><a href="main_8cpp.html#a8d67876da148be9118bba1c0d017fb57">distCoeffs</a></div><div class="ttdeci">Mat distCoeffs</div><div class="ttdoc">distortion coefficients of the camera </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00125">main.cpp:125</a></div></div>
<div class="ttc" id="main_8cpp_html_acf655f393e3996144226399a338e8d3b"><div class="ttname"><a href="main_8cpp.html#acf655f393e3996144226399a338e8d3b">gotOrder</a></div><div class="ttdeci">bool gotOrder</div><div class="ttdoc">order of the list_points3d and list_points3d already tetermined or not, has to be done once ...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00120">main.cpp:120</a></div></div>
<div class="ttc" id="main_8cpp_html_a2104a5d9d6b9f1e29bc4cd858c59882e"><div class="ttname"><a href="main_8cpp.html#a2104a5d9d6b9f1e29bc4cd858c59882e">projectCoordinateFrame</a></div><div class="ttdeci">void projectCoordinateFrame(Mat pictureFrame)</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l01099">main.cpp:1099</a></div></div>
<div class="ttc" id="main_8cpp_html_a85d3d8c8a0e3e9cfb6157c247470d934"><div class="ttname"><a href="main_8cpp.html#a85d3d8c8a0e3e9cfb6157c247470d934">list_points2dOld</a></div><div class="ttdeci">std::vector&lt; Point2d &gt; list_points2dOld</div><div class="ttdoc">marker positions in previous picture in 2D in camera image CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00109">main.cpp:109</a></div></div>
<div class="ttc" id="main_8cpp_html_a53e8957a459b639ca82d938157f3b085"><div class="ttname"><a href="main_8cpp.html#a53e8957a459b639ca82d938157f3b085">cameraMatrix</a></div><div class="ttdeci">Mat cameraMatrix</div><div class="ttdoc">camera matrix of the camera </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00124">main.cpp:124</a></div></div>
<div class="ttc" id="main_8cpp_html_a4e18b0b26ecc511ca7d2f2205313e537"><div class="ttname"><a href="main_8cpp.html#a4e18b0b26ecc511ca7d2f2205313e537">intIntensity</a></div><div class="ttdeci">int intIntensity</div><div class="ttdoc">max infrared spot light intensity is 15 1-6 is strobe 7-15 is continuous 13 and 14 are meaningless ...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00089">main.cpp:89</a></div></div>
<div class="ttc" id="main_8cpp_html_a11ff459289305229597defd39f510959"><div class="ttname"><a href="main_8cpp.html#a11ff459289305229597defd39f510959">determineOrder</a></div><div class="ttdeci">void determineOrder()</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l01516">main.cpp:1516</a></div></div>
<div class="ttc" id="main_8cpp_html_a1d543a183197268bcb54a06bf157852c"><div class="ttname"><a href="main_8cpp.html#a1d543a183197268bcb54a06bf157852c">positionOld</a></div><div class="ttdeci">Vec3d positionOld</div><div class="ttdoc">old position in O-CoSy for finite differences velocity calculation </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00083">main.cpp:83</a></div></div>
<div class="ttc" id="main_8cpp_html_ae101daeaec726e27690c862b7edea825"><div class="ttname"><a href="main_8cpp.html#ae101daeaec726e27690c862b7edea825">RvecOriginal</a></div><div class="ttdeci">Mat RvecOriginal</div><div class="ttdoc">initial values as start values for algorithms and algorithm tests </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00101">main.cpp:101</a></div></div>
<div class="ttc" id="main_8cpp_html_a4ee4d2abbe47b92c21b81c5c4389086e"><div class="ttname"><a href="main_8cpp.html#a4ee4d2abbe47b92c21b81c5c4389086e">RmatRef</a></div><div class="ttdeci">Mat RmatRef</div><div class="ttdoc">reference rotation matrix from camera CoSy to marker CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00096">main.cpp:96</a></div></div>
<div class="ttc" id="main_8cpp_html_a9215ba881de0242c883e5b065d6d2ff9"><div class="ttname"><a href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a></div><div class="ttdeci">Mat Tvec</div><div class="ttdoc">translation vector from camera CoSy to marker CoSy in camera CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00100">main.cpp:100</a></div></div>
<div class="ttc" id="main_8cpp_html_a8fc3524f4e679a41dcc8d0f302d637ed"><div class="ttname"><a href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a></div><div class="ttdeci">std::stringstream ss</div><div class="ttdoc">stream that sends the strBuf buffer to the Qt GUI </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00142">main.cpp:142</a></div></div>
<div class="ttc" id="main_8cpp_html_a7b795a27447192fa68ef7c2d8ee1adab"><div class="ttname"><a href="main_8cpp.html#a7b795a27447192fa68ef7c2d8ee1adab">strBuf</a></div><div class="ttdeci">std::string strBuf</div><div class="ttdoc">buffer that holds the strings that are sent to the Qt GUI </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00141">main.cpp:141</a></div></div>
<div class="ttc" id="main_8cpp_html_aa5b833b78b107a1a04eb4edba151c0ba"><div class="ttname"><a href="main_8cpp.html#aa5b833b78b107a1a04eb4edba151c0ba">intFrameRate</a></div><div class="ttdeci">int intFrameRate</div><div class="ttdoc">CoSy rate of camera, maximum is 100 fps. </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00091">main.cpp:91</a></div></div>
<div class="ttc" id="main_8cpp_html_ae1d37a43f631aefe76b6e540da786064"><div class="ttname"><a href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a></div><div class="ttdeci">int numberMarkers</div><div class="ttdoc">number of markers. Is loaded during start up from the marker configuration file </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00106">main.cpp:106</a></div></div>
<div class="ttc" id="main_8cpp_html_ab2b71933055cf32cc8e5e2100fd7723f"><div class="ttname"><a href="main_8cpp.html#ab2b71933055cf32cc8e5e2100fd7723f">getEulerAngles</a></div><div class="ttdeci">void getEulerAngles(Mat &amp;rotCamerMatrix, Vec3d &amp;eulerAngles)</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00256">main.cpp:256</a></div></div>
<div class="ttc" id="main_8cpp_html_a0416912fce6274568e80019b10ba294f"><div class="ttname"><a href="main_8cpp.html#a0416912fce6274568e80019b10ba294f">determineExposure</a></div><div class="ttdeci">int determineExposure()</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l01380">main.cpp:1380</a></div></div>
<div class="ttc" id="main_8cpp_html_acd6966c004a57c4080ba204152200e7f"><div class="ttname"><a href="main_8cpp.html#acd6966c004a57c4080ba204152200e7f">eulerRef</a></div><div class="ttdeci">Vec3d eulerRef</div><div class="ttdoc">initial euler angle of object respectivley to camera CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00086">main.cpp:86</a></div></div>
<div class="ttc" id="main_8cpp_html_ad583e75f176dafdb7de3f214673851de"><div class="ttname"><a href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a></div><div class="ttdeci">std::vector&lt; Point2d &gt; list_points2d</div><div class="ttdoc">marker positions projected in 2D in camera image CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00108">main.cpp:108</a></div></div>
<div class="ttc" id="main_8cpp_html_a043bf1deaf5d42d47e0cce8982c1f18b"><div class="ttname"><a href="main_8cpp.html#a043bf1deaf5d42d47e0cce8982c1f18b">TvecOriginal</a></div><div class="ttdeci">Mat TvecOriginal</div><div class="ttdoc">initial values as start values for algorithms and algorithm tests </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00102">main.cpp:102</a></div></div>
<div class="ttc" id="main_8cpp_html_a933edb4ba1c0589d59020164c2f1ff87"><div class="ttname"><a href="main_8cpp.html#a933edb4ba1c0589d59020164c2f1ff87">list_points3d</a></div><div class="ttdeci">std::vector&lt; Point3d &gt; list_points3d</div><div class="ttdoc">marker positions in marker CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00107">main.cpp:107</a></div></div>
<div class="ttc" id="main_8cpp_html_ab5e634b66221f494504aea1557af5df9"><div class="ttname"><a href="main_8cpp.html#ab5e634b66221f494504aea1557af5df9">methodPNP</a></div><div class="ttdeci">int methodPNP</div><div class="ttdoc">solvePNP algorithm 0 = iterative 1 = EPNP 2 = P3P 4 = UPNP //!&lt; 4 and 1 are the same and not implemen...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00105">main.cpp:105</a></div></div>
<div class="ttc" id="main_8cpp_html_a9d2e25dbfda0ebcdbb488652c8b15fad"><div class="ttname"><a href="main_8cpp.html#a9d2e25dbfda0ebcdbb488652c8b15fad">posRef</a></div><div class="ttdeci">Vec3d posRef</div><div class="ttdoc">initial position of object in camera CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00085">main.cpp:85</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="main_8h_a7ad2e3cfb5056dbab2098e0dd3bd353f_cgraph.svg" width="332" height="240"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="af2a8b7de0b15dc17198c147ba39e85f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2a8b7de0b15dc17198c147ba39e85f3">&#9670;&nbsp;</a></span>closeUDP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void closeUDP </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Close the UDP ports again to release network interfaces etc. If this is not done the network resources are still occupied and the program can't exit properly. </p>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l01191">1191</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;{<span class="comment"></span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="comment">    //! check if the socket is open and if yes close it</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="comment"></span>    <span class="keywordflow">if</span> (<a class="code" href="main_8cpp.html#ae628b9aba095776b7134cf188486e174">udpSocketObject</a>-&gt;isOpen())</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    {</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        <a class="code" href="main_8cpp.html#ae628b9aba095776b7134cf188486e174">udpSocketObject</a>-&gt;close();</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    }</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="main_8cpp.html#a6aa0c3a69dc10d5c4432dcf62e2155d3">udpSocketSafety</a>-&gt;isOpen())</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    {</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        <a class="code" href="main_8cpp.html#a6aa0c3a69dc10d5c4432dcf62e2155d3">udpSocketSafety</a>-&gt;close();</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    }</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="main_8cpp.html#a4260e46da4e0e430642b2d8d8d3c7dd1">udpSocketSafety2</a>-&gt;isOpen())</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    {</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;        <a class="code" href="main_8cpp.html#a4260e46da4e0e430642b2d8d8d3c7dd1">udpSocketSafety2</a>-&gt;close();</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    }</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(<span class="stringliteral">&quot;Closed all UDP ports.&quot;</span>);</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;}</div><div class="ttc" id="main_8cpp_html_a6aa0c3a69dc10d5c4432dcf62e2155d3"><div class="ttname"><a href="main_8cpp.html#a6aa0c3a69dc10d5c4432dcf62e2155d3">udpSocketSafety</a></div><div class="ttdeci">QUdpSocket * udpSocketSafety</div><div class="ttdoc">socket for the communication with safety receiver </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00129">main.cpp:129</a></div></div>
<div class="ttc" id="main_8cpp_html_a4260e46da4e0e430642b2d8d8d3c7dd1"><div class="ttname"><a href="main_8cpp.html#a4260e46da4e0e430642b2d8d8d3c7dd1">udpSocketSafety2</a></div><div class="ttdeci">QUdpSocket * udpSocketSafety2</div><div class="ttdoc">socket for the communication with receiver 3 </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00130">main.cpp:130</a></div></div>
<div class="ttc" id="main_8cpp_html_af29e7fc07ae0979d5fb61b473241d33d"><div class="ttname"><a href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a></div><div class="ttdeci">commObject commObj</div><div class="ttdoc">class that handles the communication from main.cpp to the GUI </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00068">main.cpp:68</a></div></div>
<div class="ttc" id="main_8cpp_html_ae628b9aba095776b7134cf188486e174"><div class="ttname"><a href="main_8cpp.html#ae628b9aba095776b7134cf188486e174">udpSocketObject</a></div><div class="ttdeci">QUdpSocket * udpSocketObject</div><div class="ttdoc">socket for the communication with receiver 1 </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00128">main.cpp:128</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="main_8h_af2a8b7de0b15dc17198c147ba39e85f3_icgraph.svg" width="404" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a0416912fce6274568e80019b10ba294f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0416912fce6274568e80019b10ba294f">&#9670;&nbsp;</a></span>determineExposure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int determineExposure </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the optimal exposure for the camera. For that find the minimum and maximum exposure were the right number of markers are detected. Then the mean of those two values is used as exposure. </p>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l01380">1380</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;{<span class="comment"></span></div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;<span class="comment">    //! For OptiTrack Ethernet cameras, it&#39;s important to enable development mode if you</span></div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;<span class="comment">    //! want to stop execution for an extended time while debugging without disconnecting</span></div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;<span class="comment">    //! the Ethernet devices.  Lets do that now:</span></div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    CameraLibrary_EnableDevelopment();</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;<span class="comment">    //! Initialize Camera SDK ==--</span></div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;<span class="comment"></span>    CameraLibrary::CameraManager::X();</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;<span class="comment">    //! At this point the Camera SDK is actively looking for all connected cameras and will initialize</span></div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;<span class="comment">    //! them on it&#39;s own.</span></div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;<span class="comment"></span><span class="comment"></span></div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<span class="comment">    //! Get a connected camera ================----</span></div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<span class="comment"></span>    CameraManager::X().WaitForInitialization();</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    Camera *camera = CameraManager::X().GetCamera();</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;<span class="comment">    //! If no device connected, pop a message box and exit ==--</span></div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;<span class="comment"></span>    <span class="keywordflow">if</span> (camera == 0)</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    {</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;        <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(<span class="stringliteral">&quot;No camera found!&quot;</span>);</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;        <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    }</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;<span class="comment">    //! Determine camera resolution to size application window ==----</span></div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;<span class="comment"></span>    <span class="keywordtype">int</span> cameraWidth = camera-&gt;Width();</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <span class="keywordtype">int</span> cameraHeight = camera-&gt;Height();</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    camera-&gt;SetVideoType(Core::PrecisionMode);  <span class="comment">//! set the camera mode to precision mode, it used greyscale imformation for marker property calculations</span></div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="comment"></span><span class="comment"></span></div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;<span class="comment">                                                //! Start camera output ==--</span></div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;<span class="comment"></span>    camera-&gt;Start();</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;<span class="comment">    //! Turn on some overlay text so it&#39;s clear things are     ===---</span></div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="comment">    //! working even if there is nothing in the camera&#39;s view. ===---</span></div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;<span class="comment"></span>    camera-&gt;SetTextOverlay(<span class="keyword">true</span>);</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    camera-&gt;SetExposure(<a class="code" href="main_8cpp.html#afcaebd6cfd12b2e558363a06db8396ea">intExposure</a>);   <span class="comment">//! set the camera exposure</span></div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;<span class="comment"></span>    camera-&gt;SetIntensity(<a class="code" href="main_8cpp.html#a4e18b0b26ecc511ca7d2f2205313e537">intIntensity</a>); <span class="comment">//! set the camera infrared LED intensity</span></div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="comment"></span>    camera-&gt;SetFrameRate(<a class="code" href="main_8cpp.html#aa5b833b78b107a1a04eb4edba151c0ba">intFrameRate</a>); <span class="comment">//! set the camera framerate to 100 Hz</span></div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="comment"></span>    camera-&gt;SetIRFilter(<span class="keyword">true</span>);  <span class="comment">//! enable the filter that blocks visible light and only passes infrared light</span></div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;<span class="comment"></span>    camera-&gt;SetHighPowerMode(<span class="keyword">true</span>); <span class="comment">//! enable high power mode of the leds</span></div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="comment"></span>    camera-&gt;SetContinuousIR(<span class="keyword">false</span>); <span class="comment">//! enable continuous LED light</span></div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;<span class="comment"></span>    camera-&gt;SetThreshold(<a class="code" href="main_8cpp.html#ac61559ce6020b8ec00161bc3a994ddcc">intThreshold</a>); <span class="comment">//! set threshold for marker detection</span></div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;<span class="comment"></span><span class="comment"></span></div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;<span class="comment">    //!set exposure such that num markers are visible</span></div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;<span class="comment"></span>    <span class="keywordtype">int</span> numberObjects = 0;  <span class="comment">//! Number of objects (markers) found in the current picture with the given exposure    </span></div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="comment"></span>    <span class="keywordtype">int</span> minExposure = 1;    <span class="comment">//! exposure when objects detected the first time is numberMarkers </span></div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;<span class="comment"></span>    <span class="keywordtype">int</span> maxExposure = 480;  <span class="comment">//! exposure when objects detected is first time numberMarkers+1</span></div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;<span class="comment"></span>    <a class="code" href="main_8cpp.html#afcaebd6cfd12b2e558363a06db8396ea">intExposure</a> = minExposure;  <span class="comment">//! set the exposure to the smallest value possible</span></div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;<span class="comment"></span>    <span class="keywordtype">int</span> numberTries = 0;    <span class="comment">//! if the markers arent found after numberTries then there might be no markers at all in the real world</span></div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;<span class="comment"></span><span class="comment"></span></div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;<span class="comment">                            //! Determine minimum exposure, hence when are numberMarkers objects detected</span></div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;<span class="comment"></span>    camera-&gt;SetExposure(<a class="code" href="main_8cpp.html#afcaebd6cfd12b2e558363a06db8396ea">intExposure</a>);</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    <span class="keywordflow">while</span> (numberObjects != <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a> &amp;&amp; numberTries &lt; 48)</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    {<span class="comment"></span></div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="comment">        //! get a new camera frame</span></div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;<span class="comment"></span>        Frame *frame = camera-&gt;GetFrame();</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;        <span class="keywordflow">if</span> (frame) <span class="comment">//! frame received</span></div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;<span class="comment"></span>        {</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;            numberObjects = frame-&gt;ObjectCount();   <span class="comment">//! how many objects are detected in the image</span></div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="comment"></span>            <span class="keywordflow">if</span> (numberObjects == <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>) { minExposure = <a class="code" href="main_8cpp.html#afcaebd6cfd12b2e558363a06db8396ea">intExposure</a>; frame-&gt;Release(); <span class="keywordflow">break</span>; } <span class="comment">//! if the right amount if markers is found, exit while loop</span></div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="comment"></span><span class="comment">            //! not the right amount of markers was found so increase the exposure and try again</span></div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;<span class="comment"></span>            numberTries++;</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;            <a class="code" href="main_8cpp.html#afcaebd6cfd12b2e558363a06db8396ea">intExposure</a> += 10;</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;            camera-&gt;SetExposure(<a class="code" href="main_8cpp.html#afcaebd6cfd12b2e558363a06db8396ea">intExposure</a>);</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;            <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;            <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;Exposure: &quot;</span> &lt;&lt; <a class="code" href="main_8cpp.html#afcaebd6cfd12b2e558363a06db8396ea">intExposure</a> &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;            <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;Objects found: &quot;</span> &lt;&lt; numberObjects;</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;            <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(QString::fromStdString(<a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str()));</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;            frame-&gt;Release();</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;        }</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    }</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="comment">    //! Now determine maximum exposure, hence when are numberMarkers+1 objects detected</span></div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;<span class="comment"></span>    numberTries = 0;    <span class="comment">//! if the markers arent found after numberTries then there might be no markers at all in the real world</span></div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;<span class="comment"></span>    intExposure = maxExposure;</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    camera-&gt;SetExposure(intExposure);</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    numberObjects = 0;</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    <span class="keywordflow">while</span> (numberObjects != <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a> &amp;&amp; numberTries &lt; 48)</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    {</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;        Frame *frame = camera-&gt;GetFrame();</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;        <span class="keywordflow">if</span> (frame)</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;        {</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;            numberObjects = frame-&gt;ObjectCount(); <span class="comment">//! how many objects are detected in the image</span></div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;<span class="comment"></span>            <span class="keywordflow">if</span> (numberObjects == <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>) { maxExposure = <a class="code" href="main_8cpp.html#afcaebd6cfd12b2e558363a06db8396ea">intExposure</a>; frame-&gt;Release(); <span class="keywordflow">break</span>; } <span class="comment">//! if the right amount if markers is found, exit while loop</span></div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;<span class="comment"></span><span class="comment"></span></div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;<span class="comment">            //! not the right amount of markers was found so decrease the exposure and try again</span></div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;<span class="comment"></span>            intExposure -= 10;</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;            numberTries++;</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;            camera-&gt;SetExposure(intExposure);</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;            <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;            <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;Exposure: &quot;</span> &lt;&lt; intExposure &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;            <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;Objects found: &quot;</span> &lt;&lt; numberObjects;</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;            <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(QString::fromStdString(<a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str()));</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;            frame-&gt;Release();</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;        }</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    }</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;<span class="comment">    //! set the exposure to the mean of min and max exposure determined</span></div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;<span class="comment"></span>    camera-&gt;SetExposure((minExposure + maxExposure) / 2.0);</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;<span class="comment">    //! and now check if the correct amount of markers is detected with that new value</span></div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;<span class="comment"></span>    <span class="keywordflow">while</span> (1)</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    {</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;        Frame *frame = camera-&gt;GetFrame();</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;        <span class="keywordflow">if</span> (frame)</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;        {</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;            numberObjects = frame-&gt;ObjectCount(); <span class="comment">//! how many objects are detected in the image</span></div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;<span class="comment"></span>            <span class="keywordflow">if</span> (numberObjects != <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>) <span class="comment">//! are all markers and not more or less detected in the image</span></div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;<span class="comment"></span>            {</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;                frame-&gt;Release();</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(<span class="stringliteral">&quot;Was not able to detect the right amount of markers.&quot;</span>);<span class="comment"></span></div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="comment">                //! Release camera ==--</span></div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;<span class="comment"></span>                camera-&gt;Release();</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;            }</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;            <span class="keywordflow">else</span>  <span class="comment">//! all markers and not more or less are found</span></div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;<span class="comment"></span>            {</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                frame-&gt;Release();</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                intExposure = (minExposure + maxExposure) / 2.0;</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(<span class="stringliteral">&quot;Found the correct number of markers.&quot;</span>);</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(<span class="stringliteral">&quot;Exposure set to:&quot;</span>);</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(QString::number(intExposure));</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;            }</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        }</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    }</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    camera-&gt;Release();</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;}</div><div class="ttc" id="main_8cpp_html_afcaebd6cfd12b2e558363a06db8396ea"><div class="ttname"><a href="main_8cpp.html#afcaebd6cfd12b2e558363a06db8396ea">intExposure</a></div><div class="ttdeci">int intExposure</div><div class="ttdoc">max is 480 increase if markers are badly visible but should be determined automatically during setRef...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00090">main.cpp:90</a></div></div>
<div class="ttc" id="main_8cpp_html_ac61559ce6020b8ec00161bc3a994ddcc"><div class="ttname"><a href="main_8cpp.html#ac61559ce6020b8ec00161bc3a994ddcc">intThreshold</a></div><div class="ttdeci">int intThreshold</div><div class="ttdoc">threshold value for marker detection. If markers are badly visible lower this value but should not be...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00092">main.cpp:92</a></div></div>
<div class="ttc" id="main_8cpp_html_af29e7fc07ae0979d5fb61b473241d33d"><div class="ttname"><a href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a></div><div class="ttdeci">commObject commObj</div><div class="ttdoc">class that handles the communication from main.cpp to the GUI </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00068">main.cpp:68</a></div></div>
<div class="ttc" id="main_8cpp_html_a4e18b0b26ecc511ca7d2f2205313e537"><div class="ttname"><a href="main_8cpp.html#a4e18b0b26ecc511ca7d2f2205313e537">intIntensity</a></div><div class="ttdeci">int intIntensity</div><div class="ttdoc">max infrared spot light intensity is 15 1-6 is strobe 7-15 is continuous 13 and 14 are meaningless ...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00089">main.cpp:89</a></div></div>
<div class="ttc" id="main_8cpp_html_a8fc3524f4e679a41dcc8d0f302d637ed"><div class="ttname"><a href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a></div><div class="ttdeci">std::stringstream ss</div><div class="ttdoc">stream that sends the strBuf buffer to the Qt GUI </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00142">main.cpp:142</a></div></div>
<div class="ttc" id="main_8cpp_html_aa5b833b78b107a1a04eb4edba151c0ba"><div class="ttname"><a href="main_8cpp.html#aa5b833b78b107a1a04eb4edba151c0ba">intFrameRate</a></div><div class="ttdeci">int intFrameRate</div><div class="ttdoc">CoSy rate of camera, maximum is 100 fps. </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00091">main.cpp:91</a></div></div>
<div class="ttc" id="main_8cpp_html_ae1d37a43f631aefe76b6e540da786064"><div class="ttname"><a href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a></div><div class="ttdeci">int numberMarkers</div><div class="ttdoc">number of markers. Is loaded during start up from the marker configuration file </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00106">main.cpp:106</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="main_8h_a0416912fce6274568e80019b10ba294f_icgraph.svg" width="475" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a11ff459289305229597defd39f510959"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11ff459289305229597defd39f510959">&#9670;&nbsp;</a></span>determineOrder()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void determineOrder </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the order of the marker points in 2D so they are the same as in the 3D array. Hence marker 1 must be in first place for both, list_points2d and list_points3d. </p>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l01516">1516</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;{<span class="comment"></span></div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="comment">    //! determine the 3D-2D correspondences that are crucial for the PnP algorithm</span></div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="comment">    //! Try every possible correspondence and solve PnP</span></div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="comment">    //! Then project the 3D marker points into the 2D camera image and check the difference </span></div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="comment">    //! between projected points and points as seen by the camera</span></div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="comment">    //! the corresponce with the smallest difference is probably the correct one</span></div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="comment"></span><span class="comment"></span></div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="comment">        //! the difference between true 2D points and projected points is super big</span></div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;<span class="comment"></span>    <a class="code" href="main_8cpp.html#ab826a7ca5876afdd6c0bccf04b73b30b">minPointDistance</a> = 5000;</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    std::sort(<a class="code" href="main_8cpp.html#ac06fee052099b9fc9f0826315bb64a4a">pointOrderIndices</a>, <a class="code" href="main_8cpp.html#ac06fee052099b9fc9f0826315bb64a4a">pointOrderIndices</a> + 4);</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;<span class="comment">    //! now try every possible permutation of correspondence</span></div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;<span class="comment"></span>    <span class="keywordflow">do</span> {<span class="comment"></span></div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;<span class="comment">        //! reset the starting values for solvePnP</span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;<span class="comment"></span>        <a class="code" href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a> = <a class="code" href="main_8cpp.html#ae101daeaec726e27690c862b7edea825">RvecOriginal</a>;</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;        <a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a> = <a class="code" href="main_8cpp.html#a043bf1deaf5d42d47e0cce8982c1f18b">TvecOriginal</a>;</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;<span class="comment">        //! sort the 2d points with the current permutation</span></div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="comment"></span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>; m++)</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;        {</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;            <a class="code" href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a>[m] = <a class="code" href="main_8cpp.html#a54cb682bd037283c18b5a9a447ff5e5e">list_points2dUnsorted</a>[<a class="code" href="main_8cpp.html#ac06fee052099b9fc9f0826315bb64a4a">pointOrderIndices</a>[m]];</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;        }</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;<span class="comment">        //! Call solve PNP with P3P since its more robust and sufficient for start value determination</span></div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;<span class="comment"></span>        solvePnP(<a class="code" href="main_8cpp.html#a933edb4ba1c0589d59020164c2f1ff87">list_points3d</a>, <a class="code" href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a>, <a class="code" href="main_8cpp.html#a53e8957a459b639ca82d938157f3b085">cameraMatrix</a>, <a class="code" href="main_8cpp.html#a8d67876da148be9118bba1c0d017fb57">distCoeffs</a>, <a class="code" href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a>, <a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>, <a class="code" href="main_8cpp.html#ab1cc9be1ff0871bc5de1eb4c2811ae3e">useGuess</a>, SOLVEPNP_P3P);</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="comment">        //! set the current difference of all point correspondences to zero</span></div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<span class="comment"></span>        <a class="code" href="main_8cpp.html#afe37bd67ad83a2d897cf5977cba70ef3">currentPointDistance</a> = 0;</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;<span class="comment">        //! project the 3D points with the solvePnP solution onto 2D</span></div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="comment"></span>        projectPoints(<a class="code" href="main_8cpp.html#a933edb4ba1c0589d59020164c2f1ff87">list_points3d</a>, <a class="code" href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a>, <a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>, <a class="code" href="main_8cpp.html#a53e8957a459b639ca82d938157f3b085">cameraMatrix</a>, <a class="code" href="main_8cpp.html#a8d67876da148be9118bba1c0d017fb57">distCoeffs</a>, <a class="code" href="main_8cpp.html#a7b88d0425a68875639d40a17079df819">list_points2dProjected</a>);</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;<span class="comment">        //! now compute the absolute difference (error)</span></div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;<span class="comment"></span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>; n++)</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;        {</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;            <a class="code" href="main_8cpp.html#afe37bd67ad83a2d897cf5977cba70ef3">currentPointDistance</a> += norm(<a class="code" href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a>[n] - <a class="code" href="main_8cpp.html#a7b88d0425a68875639d40a17079df819">list_points2dProjected</a>[n]);</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;        }</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="comment">        //! if the difference with the current permutation is smaller than the smallest value till now</span></div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;<span class="comment">        //! it is probably the more correct permutation</span></div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;<span class="comment"></span>        <span class="keywordflow">if</span> (<a class="code" href="main_8cpp.html#afe37bd67ad83a2d897cf5977cba70ef3">currentPointDistance</a> &lt; <a class="code" href="main_8cpp.html#ab826a7ca5876afdd6c0bccf04b73b30b">minPointDistance</a>)</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;        {</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;            <a class="code" href="main_8cpp.html#ab826a7ca5876afdd6c0bccf04b73b30b">minPointDistance</a> = <a class="code" href="main_8cpp.html#afe37bd67ad83a2d897cf5977cba70ef3">currentPointDistance</a>;    <span class="comment">//!&lt; set the smallest value of difference to the current one</span></div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<span class="comment"></span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b = 0; b &lt; <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>; b++) <span class="comment">//!&lt; now safe the better permutation</span></div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="comment"></span>            {</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;                <a class="code" href="main_8cpp.html#acc9e758efd664582db86f976cec195fa">pointOrderIndicesNew</a>[b] = <a class="code" href="main_8cpp.html#ac06fee052099b9fc9f0826315bb64a4a">pointOrderIndices</a>[b];</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;            }</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;        }</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    }<span class="comment"></span></div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;<span class="comment">    //! try every permutation </span></div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="comment"></span>    <span class="keywordflow">while</span> (std::next_permutation(<a class="code" href="main_8cpp.html#ac06fee052099b9fc9f0826315bb64a4a">pointOrderIndices</a>, <a class="code" href="main_8cpp.html#ac06fee052099b9fc9f0826315bb64a4a">pointOrderIndices</a> + 4));</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="comment">    //! now that the correct order is found assign it to the indices array</span></div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;<span class="comment"></span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> w = 0; w &lt; <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>; w++)</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    {</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;        <a class="code" href="main_8cpp.html#ac06fee052099b9fc9f0826315bb64a4a">pointOrderIndices</a>[w] = <a class="code" href="main_8cpp.html#acc9e758efd664582db86f976cec195fa">pointOrderIndicesNew</a>[w];</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    }</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    <a class="code" href="main_8cpp.html#acf655f393e3996144226399a338e8d3b">gotOrder</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;}</div><div class="ttc" id="main_8cpp_html_ac06fee052099b9fc9f0826315bb64a4a"><div class="ttname"><a href="main_8cpp.html#ac06fee052099b9fc9f0826315bb64a4a">pointOrderIndices</a></div><div class="ttdeci">int pointOrderIndices[]</div><div class="ttdoc">old correspondence from list_points3d and list_points_2d </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00115">main.cpp:115</a></div></div>
<div class="ttc" id="main_8cpp_html_ae095f10a005e68d20233dc15b4077ca6"><div class="ttname"><a href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a></div><div class="ttdeci">Mat Rvec</div><div class="ttdoc">rotation vector (axis-angle notation) from camera CoSy to marker CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00099">main.cpp:99</a></div></div>
<div class="ttc" id="main_8cpp_html_a54cb682bd037283c18b5a9a447ff5e5e"><div class="ttname"><a href="main_8cpp.html#a54cb682bd037283c18b5a9a447ff5e5e">list_points2dUnsorted</a></div><div class="ttdeci">std::vector&lt; Point2d &gt; list_points2dUnsorted</div><div class="ttdoc">marker points in 2D camera image CoSy, sorted with increasing x (camera image CoSy) but not sorted to...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00112">main.cpp:112</a></div></div>
<div class="ttc" id="main_8cpp_html_a7b88d0425a68875639d40a17079df819"><div class="ttname"><a href="main_8cpp.html#a7b88d0425a68875639d40a17079df819">list_points2dProjected</a></div><div class="ttdeci">std::vector&lt; Point2d &gt; list_points2dProjected</div><div class="ttdoc">3D marker points projected to 2D in camera image CoSy with the algorithm projectPoints ...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00111">main.cpp:111</a></div></div>
<div class="ttc" id="main_8cpp_html_ab1cc9be1ff0871bc5de1eb4c2811ae3e"><div class="ttname"><a href="main_8cpp.html#ab1cc9be1ff0871bc5de1eb4c2811ae3e">useGuess</a></div><div class="ttdeci">bool useGuess</div><div class="ttdoc">set to true and the algorithm uses the last result as starting value </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00104">main.cpp:104</a></div></div>
<div class="ttc" id="main_8cpp_html_a8d67876da148be9118bba1c0d017fb57"><div class="ttname"><a href="main_8cpp.html#a8d67876da148be9118bba1c0d017fb57">distCoeffs</a></div><div class="ttdeci">Mat distCoeffs</div><div class="ttdoc">distortion coefficients of the camera </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00125">main.cpp:125</a></div></div>
<div class="ttc" id="main_8cpp_html_acf655f393e3996144226399a338e8d3b"><div class="ttname"><a href="main_8cpp.html#acf655f393e3996144226399a338e8d3b">gotOrder</a></div><div class="ttdeci">bool gotOrder</div><div class="ttdoc">order of the list_points3d and list_points3d already tetermined or not, has to be done once ...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00120">main.cpp:120</a></div></div>
<div class="ttc" id="main_8cpp_html_a53e8957a459b639ca82d938157f3b085"><div class="ttname"><a href="main_8cpp.html#a53e8957a459b639ca82d938157f3b085">cameraMatrix</a></div><div class="ttdeci">Mat cameraMatrix</div><div class="ttdoc">camera matrix of the camera </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00124">main.cpp:124</a></div></div>
<div class="ttc" id="main_8cpp_html_ae101daeaec726e27690c862b7edea825"><div class="ttname"><a href="main_8cpp.html#ae101daeaec726e27690c862b7edea825">RvecOriginal</a></div><div class="ttdeci">Mat RvecOriginal</div><div class="ttdoc">initial values as start values for algorithms and algorithm tests </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00101">main.cpp:101</a></div></div>
<div class="ttc" id="main_8cpp_html_a9215ba881de0242c883e5b065d6d2ff9"><div class="ttname"><a href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a></div><div class="ttdeci">Mat Tvec</div><div class="ttdoc">translation vector from camera CoSy to marker CoSy in camera CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00100">main.cpp:100</a></div></div>
<div class="ttc" id="main_8cpp_html_afe37bd67ad83a2d897cf5977cba70ef3"><div class="ttname"><a href="main_8cpp.html#afe37bd67ad83a2d897cf5977cba70ef3">currentPointDistance</a></div><div class="ttdeci">double currentPointDistance</div><div class="ttdoc">distance from the projected 3D points (hence in 2d) to the real 2d marker positions in camera image C...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00117">main.cpp:117</a></div></div>
<div class="ttc" id="main_8cpp_html_acc9e758efd664582db86f976cec195fa"><div class="ttname"><a href="main_8cpp.html#acc9e758efd664582db86f976cec195fa">pointOrderIndicesNew</a></div><div class="ttdeci">int pointOrderIndicesNew[]</div><div class="ttdoc">new correspondence from list_points3d and list_points_2d </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00116">main.cpp:116</a></div></div>
<div class="ttc" id="main_8cpp_html_ae1d37a43f631aefe76b6e540da786064"><div class="ttname"><a href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a></div><div class="ttdeci">int numberMarkers</div><div class="ttdoc">number of markers. Is loaded during start up from the marker configuration file </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00106">main.cpp:106</a></div></div>
<div class="ttc" id="main_8cpp_html_ad583e75f176dafdb7de3f214673851de"><div class="ttname"><a href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a></div><div class="ttdeci">std::vector&lt; Point2d &gt; list_points2d</div><div class="ttdoc">marker positions projected in 2D in camera image CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00108">main.cpp:108</a></div></div>
<div class="ttc" id="main_8cpp_html_a043bf1deaf5d42d47e0cce8982c1f18b"><div class="ttname"><a href="main_8cpp.html#a043bf1deaf5d42d47e0cce8982c1f18b">TvecOriginal</a></div><div class="ttdeci">Mat TvecOriginal</div><div class="ttdoc">initial values as start values for algorithms and algorithm tests </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00102">main.cpp:102</a></div></div>
<div class="ttc" id="main_8cpp_html_a933edb4ba1c0589d59020164c2f1ff87"><div class="ttname"><a href="main_8cpp.html#a933edb4ba1c0589d59020164c2f1ff87">list_points3d</a></div><div class="ttdeci">std::vector&lt; Point3d &gt; list_points3d</div><div class="ttdoc">marker positions in marker CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00107">main.cpp:107</a></div></div>
<div class="ttc" id="main_8cpp_html_ab826a7ca5876afdd6c0bccf04b73b30b"><div class="ttname"><a href="main_8cpp.html#ab826a7ca5876afdd6c0bccf04b73b30b">minPointDistance</a></div><div class="ttdeci">double minPointDistance</div><div class="ttdoc">minimum distance from the projected 3D points (hence in 2d) to the real 2d marker positions in camera...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00118">main.cpp:118</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="main_8h_a11ff459289305229597defd39f510959_icgraph.svg" width="451" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="af6430ad2592a955a3618549547dfc5be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6430ad2592a955a3618549547dfc5be">&#9670;&nbsp;</a></span>drawPositionText()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void drawPositionText </td>
          <td>(</td>
          <td class="paramtype">cv::Mat &amp;&#160;</td>
          <td class="paramname"><em>Picture</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cv::Vec3d &amp;&#160;</td>
          <td class="paramname"><em>Position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cv::Vec3d &amp;&#160;</td>
          <td class="paramname"><em>Euler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Draw the position, attitude and reprojection error in the picture. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Picture</td><td>is the camera image in OpenCV matrix format. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Position</td><td>is the position of the tracked object in navigation CoSy. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Euler</td><td>are the Euler angles with respect to the navigation frame. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">error</td><td>is the reprojection error of the pose estimation. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l01333">1333</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;{</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;X: &quot;</span> &lt;&lt; Position[0] &lt;&lt; <span class="stringliteral">&quot; m&quot;</span>;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    putText(Picture, <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str(), cv::Point(200, 440), 1, 1, cv::Scalar(255, 255, 255));</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;Y: &quot;</span> &lt;&lt; Position[1] &lt;&lt; <span class="stringliteral">&quot; m&quot;</span>;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    putText(Picture, <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str(), cv::Point(200, 455), 1, 1, cv::Scalar(255, 255, 255));</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;Z: &quot;</span> &lt;&lt; Position[2] &lt;&lt; <span class="stringliteral">&quot; m&quot;</span>;</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    putText(Picture, <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str(), cv::Point(200, 470), 1, 1, cv::Scalar(255, 255, 255));</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;Heading: &quot;</span> &lt;&lt; Euler[2]*180/3.1415 &lt;&lt; <span class="stringliteral">&quot; deg&quot;</span>;</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    putText(Picture, <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str(), cv::Point(350, 440), 1, 1, cv::Scalar(255, 255, 255));</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;Pitch: &quot;</span> &lt;&lt; Euler[1] * 180 / 3.1415 &lt;&lt; <span class="stringliteral">&quot; deg&quot;</span>;</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    putText(Picture, <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str(), cv::Point(350, 455), 1, 1, cv::Scalar(255, 255, 255));</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;Roll: &quot;</span> &lt;&lt; Euler[0] * 180 / 3.1415 &lt;&lt; <span class="stringliteral">&quot; deg&quot;</span>;</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    putText(Picture, <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str(), cv::Point(350, 470), 1, 1, cv::Scalar(255, 255, 255));</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;Error: &quot;</span> &lt;&lt; error &lt;&lt; <span class="stringliteral">&quot; px&quot;</span>;</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    putText(Picture, <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str(), cv::Point(10, 470), 1, 1, cv::Scalar(255, 255, 255));</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;}</div><div class="ttc" id="main_8cpp_html_a8fc3524f4e679a41dcc8d0f302d637ed"><div class="ttname"><a href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a></div><div class="ttdeci">std::stringstream ss</div><div class="ttdoc">stream that sends the strBuf buffer to the Qt GUI </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00142">main.cpp:142</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="main_8h_af6430ad2592a955a3618549547dfc5be_icgraph.svg" width="455" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ad39626702ff983d5fdab4b703bfaf964"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad39626702ff983d5fdab4b703bfaf964">&#9670;&nbsp;</a></span>loadCalibration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void loadCalibration </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>method</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Load a previously saved camera calibration from a file. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">method</td><td>whether or not load the camera calibration from calibration.xml. If ==0 then yes, if != 0 then let the user select a different file. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l00941">941</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                                 {</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    QString fileName;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="keywordflow">if</span> (method == 0)</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    {</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        fileName = <span class="stringliteral">&quot;calibration.xml&quot;</span>;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    }</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    {</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        fileName = QFileDialog::getOpenFileName(<span class="keyword">nullptr</span>, <span class="stringliteral">&quot;Choose a previous saved calibration file&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;Calibration Files (*.xml);;All Files (*)&quot;</span>);</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        <span class="keywordflow">if</span> (fileName.length() == 0)</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        {</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;            fileName = <span class="stringliteral">&quot;calibration.xml&quot;</span>;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        }</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    }</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    FileStorage fs;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    fs.open(fileName.toUtf8().constData(), FileStorage::READ);</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    fs[<span class="stringliteral">&quot;CameraMatrix&quot;</span>] &gt;&gt; <a class="code" href="main_8cpp.html#a53e8957a459b639ca82d938157f3b085">cameraMatrix</a>;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    fs[<span class="stringliteral">&quot;DistCoeff&quot;</span>] &gt;&gt; <a class="code" href="main_8cpp.html#a8d67876da148be9118bba1c0d017fb57">distCoeffs</a>;</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(<span class="stringliteral">&quot;Loaded calibration from file:&quot;</span>);</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(fileName);</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;\nCamera Matrix is&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; cameraMatrix &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;\nDistortion Coefficients are&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; distCoeffs &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(QString::fromStdString(<a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str()));</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;}</div><div class="ttc" id="main_8cpp_html_af29e7fc07ae0979d5fb61b473241d33d"><div class="ttname"><a href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a></div><div class="ttdeci">commObject commObj</div><div class="ttdoc">class that handles the communication from main.cpp to the GUI </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00068">main.cpp:68</a></div></div>
<div class="ttc" id="main_8cpp_html_a8d67876da148be9118bba1c0d017fb57"><div class="ttname"><a href="main_8cpp.html#a8d67876da148be9118bba1c0d017fb57">distCoeffs</a></div><div class="ttdeci">Mat distCoeffs</div><div class="ttdoc">distortion coefficients of the camera </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00125">main.cpp:125</a></div></div>
<div class="ttc" id="main_8cpp_html_a53e8957a459b639ca82d938157f3b085"><div class="ttname"><a href="main_8cpp.html#a53e8957a459b639ca82d938157f3b085">cameraMatrix</a></div><div class="ttdeci">Mat cameraMatrix</div><div class="ttdoc">camera matrix of the camera </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00124">main.cpp:124</a></div></div>
<div class="ttc" id="main_8cpp_html_a8fc3524f4e679a41dcc8d0f302d637ed"><div class="ttname"><a href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a></div><div class="ttdeci">std::stringstream ss</div><div class="ttdoc">stream that sends the strBuf buffer to the Qt GUI </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00142">main.cpp:142</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="main_8h_ad39626702ff983d5fdab4b703bfaf964_icgraph.svg" width="216" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="af39fa6c3a36ad6bc24a327db7a9d73c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af39fa6c3a36ad6bc24a327db7a9d73c2">&#9670;&nbsp;</a></span>loadCameraPosition()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void loadCameraPosition </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Load the rotation matrix from camera CoSy to ground CoSy It is determined during <a class="el" href="main_8cpp.html#a7ad2e3cfb5056dbab2098e0dd3bd353f">calibrateGround()</a> and stays the same once the camera is mounted and fixed. </p>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l01366">1366</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;{<span class="comment"></span></div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;<span class="comment">    //! Open the referenceData.xml that contains the rotation from camera CoSy to ground CoSy</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;<span class="comment"></span>    FileStorage fs;</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    fs.open(<span class="stringliteral">&quot;referenceData.xml&quot;</span>, FileStorage::READ);</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    fs[<span class="stringliteral">&quot;M_NC&quot;</span>] &gt;&gt; <a class="code" href="main_8cpp.html#af604b9538ec8923428a78439eaf55f8e">M_CN</a>;</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    fs[<span class="stringliteral">&quot;M_NC&quot;</span>] &gt;&gt; <a class="code" href="main_8cpp.html#a4ee4d2abbe47b92c21b81c5c4389086e">RmatRef</a>;</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    fs[<span class="stringliteral">&quot;posRef&quot;</span>] &gt;&gt; <a class="code" href="main_8cpp.html#a9d2e25dbfda0ebcdbb488652c8b15fad">posRef</a>;</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    fs[<span class="stringliteral">&quot;eulerRef&quot;</span>] &gt;&gt; <a class="code" href="main_8cpp.html#acd6966c004a57c4080ba204152200e7f">eulerRef</a>;</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(<span class="stringliteral">&quot;Loaded reference pose.&quot;</span>);</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;}</div><div class="ttc" id="main_8cpp_html_af604b9538ec8923428a78439eaf55f8e"><div class="ttname"><a href="main_8cpp.html#af604b9538ec8923428a78439eaf55f8e">M_CN</a></div><div class="ttdeci">Mat M_CN</div><div class="ttdoc">rotation matrix from camera to ground, fixed for given camera position </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00097">main.cpp:97</a></div></div>
<div class="ttc" id="main_8cpp_html_af29e7fc07ae0979d5fb61b473241d33d"><div class="ttname"><a href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a></div><div class="ttdeci">commObject commObj</div><div class="ttdoc">class that handles the communication from main.cpp to the GUI </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00068">main.cpp:68</a></div></div>
<div class="ttc" id="main_8cpp_html_a4ee4d2abbe47b92c21b81c5c4389086e"><div class="ttname"><a href="main_8cpp.html#a4ee4d2abbe47b92c21b81c5c4389086e">RmatRef</a></div><div class="ttdeci">Mat RmatRef</div><div class="ttdoc">reference rotation matrix from camera CoSy to marker CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00096">main.cpp:96</a></div></div>
<div class="ttc" id="main_8cpp_html_acd6966c004a57c4080ba204152200e7f"><div class="ttname"><a href="main_8cpp.html#acd6966c004a57c4080ba204152200e7f">eulerRef</a></div><div class="ttdeci">Vec3d eulerRef</div><div class="ttdoc">initial euler angle of object respectivley to camera CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00086">main.cpp:86</a></div></div>
<div class="ttc" id="main_8cpp_html_a9d2e25dbfda0ebcdbb488652c8b15fad"><div class="ttname"><a href="main_8cpp.html#a9d2e25dbfda0ebcdbb488652c8b15fad">posRef</a></div><div class="ttdeci">Vec3d posRef</div><div class="ttdoc">initial position of object in camera CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00085">main.cpp:85</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="main_8h_af39fa6c3a36ad6bc24a327db7a9d73c2_icgraph.svg" width="248" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a56c7f641859cb2b6b99b0947d03be800"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56c7f641859cb2b6b99b0947d03be800">&#9670;&nbsp;</a></span>loadMarkerConfig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void loadMarkerConfig </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>method</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Load a marker configuration from file. This file has to be created by hand, use the standard marker configuration file as template. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">method</td><td>whether or not load the configuration from the markerStandard.xml. If ==0 load it, if != 0 let the user select a different file. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l01213">1213</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;{</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    QString fileName;<span class="comment"></span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment">    //! during start up of the programm load the standard marker configuration</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="comment"></span>    <span class="keywordflow">if</span> (method == 0)</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    {<span class="comment"></span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="comment">        //! open the standard marker configuration file</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="comment"></span>        FileStorage fs;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        fs.open(<span class="stringliteral">&quot;markerStandard.xml&quot;</span>, FileStorage::READ);</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="comment">        //! copy the values to the respective variables</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="comment"></span>        fs[<span class="stringliteral">&quot;numberMarkers&quot;</span>] &gt;&gt; <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="comment">        //! inizialise vectors with correct length depending on the number of markers</span></div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="comment"></span>        <a class="code" href="main_8cpp.html#a933edb4ba1c0589d59020164c2f1ff87">list_points3d</a> = std::vector&lt;Point3d&gt;(<a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>);</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        <a class="code" href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a> = std::vector&lt;Point2d&gt;(<a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>);</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        <a class="code" href="main_8cpp.html#a85d3d8c8a0e3e9cfb6157c247470d934">list_points2dOld</a> = std::vector&lt;Point2d&gt;(<a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>);</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        <a class="code" href="main_8cpp.html#aea88a68a83d84419dd1c5a93b21b1958">list_points2dDifference</a> = std::vector&lt;double&gt;(<a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>);</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        <a class="code" href="main_8cpp.html#a7b88d0425a68875639d40a17079df819">list_points2dProjected</a> = std::vector&lt;Point2d&gt;(<a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>);</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;        <a class="code" href="main_8cpp.html#a54cb682bd037283c18b5a9a447ff5e5e">list_points2dUnsorted</a> = std::vector&lt;Point2d&gt;(<a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>);</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="comment">        //! save the marker locations in the points3d vector</span></div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="comment"></span>        fs[<span class="stringliteral">&quot;list_points3d&quot;</span>] &gt;&gt; <a class="code" href="main_8cpp.html#a933edb4ba1c0589d59020164c2f1ff87">list_points3d</a>;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;        fs.release();</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(<span class="stringliteral">&quot;Loaded marker configuration from file:&quot;</span>);</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;        <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(fileName);</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    }</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    {<span class="comment"></span></div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="comment">        //! if the load marker configuration button was clicked show a open file dialog </span></div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="comment"></span>        fileName = QFileDialog::getOpenFileName(<span class="keyword">nullptr</span>, <span class="stringliteral">&quot;Choose a previous saved marker configuration file&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;marker configuratio files (*.xml);;All Files (*)&quot;</span>);</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="comment">        //! was cancel or abort clicked </span></div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;<span class="comment"></span>        <span class="keywordflow">if</span> (fileName.length() == 0)</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        {<span class="comment"></span></div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="comment">            //! if yes load the standard marker configuration</span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="comment"></span>            fileName = <span class="stringliteral">&quot;markerStandard.xml&quot;</span>;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        }</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="comment">        //! open the selected marker configuration file</span></div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="comment"></span>        FileStorage fs;</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        fs.open(fileName.toUtf8().constData(), FileStorage::READ);</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="comment">        //! copy the values to the respective variables</span></div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="comment"></span>        fs[<span class="stringliteral">&quot;numberMarkers&quot;</span>] &gt;&gt; <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="comment">        //! inizialise vectors with correct length depending on the number of markers</span></div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="comment"></span>        list_points3d = std::vector&lt;Point3d&gt;(<a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>);</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        list_points2d = std::vector&lt;Point2d&gt;(<a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>);</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        list_points2dOld = std::vector&lt;Point2d&gt;(<a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>);</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        list_points2dDifference = std::vector&lt;double&gt;(<a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>);</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        list_points2dProjected = std::vector&lt;Point2d&gt;(<a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>);</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        list_points2dUnsorted = std::vector&lt;Point2d&gt;(<a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>);</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<span class="comment">        //! save the marker locations in the points3d vector</span></div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="comment"></span>        fs[<span class="stringliteral">&quot;list_points3d&quot;</span>] &gt;&gt; <a class="code" href="main_8cpp.html#a933edb4ba1c0589d59020164c2f1ff87">list_points3d</a>;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        fs.release();</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;        <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(<span class="stringliteral">&quot;Loaded marker configuration from file:&quot;</span>);</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(fileName);</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    }</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;<span class="comment">    //! Print out the number of markers and their position to the GUI</span></div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;<span class="comment"></span>    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;Number of Markers: &quot;</span> &lt;&lt; numberMarkers &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;Marker 3D Points X,Y and Z [mm]: \n&quot;</span>;</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>; i++)</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    {</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;        <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;Marker &quot;</span> &lt;&lt; i + 1 &lt;&lt; <span class="stringliteral">&quot;:\t&quot;</span> &lt;&lt; list_points3d[i].x &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; list_points3d[i].y &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; list_points3d[i].z &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    }</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(QString::fromStdString(<a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str()));</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;<span class="comment">    //! check if P3P algorithm can be enabled, it needs exactly 4 marker points to work</span></div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;<span class="comment"></span>    <span class="keywordflow">if</span> (numberMarkers == 4)</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    {<span class="comment"></span></div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="comment">        //! if P3P is possible, let the user choose which algorithm he wants but keep iterative active</span></div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="comment"></span>        <a class="code" href="main_8cpp.html#ab5e634b66221f494504aea1557af5df9">methodPNP</a> = 0;</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;        <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.enableP3P(<span class="keyword">true</span>);</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    }</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    {<span class="comment"></span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="comment">        //! More (or less) marker than 4 loaded, P3P is not possible, hence user cant select P3P in GUI</span></div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;<span class="comment"></span>        <a class="code" href="main_8cpp.html#ab5e634b66221f494504aea1557af5df9">methodPNP</a> = 0;</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.enableP3P(<span class="keyword">false</span>);</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(<span class="stringliteral">&quot;P3P algorithm disabled, only works with 4 markers.&quot;</span>);</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    }</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;<span class="comment">    //! now display the marker configuration in the camera view </span></div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<span class="comment"></span>    Mat cFrame(480, 640, CV_8UC3, Scalar(0, 0, 0));</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="comment">    //! Set the camera pose parallel to the marker coordinate system</span></div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<span class="comment"></span>    <a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>.at&lt;<span class="keywordtype">double</span>&gt;(0) = 0;</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>.at&lt;<span class="keywordtype">double</span>&gt;(1) = 0;</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>.at&lt;<span class="keywordtype">double</span>&gt;(2) = 4500;</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <a class="code" href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a>.at&lt;<span class="keywordtype">double</span>&gt;(0) = 0 * 3.141592653589 / 180.0;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    <a class="code" href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a>.at&lt;<span class="keywordtype">double</span>&gt;(1) = 0 * 3.141592653589 / 180.0;</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <a class="code" href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a>.at&lt;<span class="keywordtype">double</span>&gt;(2) = -90. * 3.141592653589 / 180.0;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    projectPoints(list_points3d, <a class="code" href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a>, <a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>, <a class="code" href="main_8cpp.html#a53e8957a459b639ca82d938157f3b085">cameraMatrix</a>, <a class="code" href="main_8cpp.html#a8d67876da148be9118bba1c0d017fb57">distCoeffs</a>, list_points2dProjected);</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>; i++)</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    {</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;        circle(cFrame, Point(list_points2dProjected[i].x, list_points2dProjected[i].y), 3, Scalar(255, 0, 0), 3);</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    }</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <a class="code" href="main_8cpp.html#a2104a5d9d6b9f1e29bc4cd858c59882e">projectCoordinateFrame</a>(cFrame);</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    QPixmap QPFrame;</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    QPFrame = <a class="code" href="main_8cpp.html#a3e3cc959a7ab6f93ea52863d86373ce5">Mat2QPixmap</a>(cFrame);</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.changeImage(QPFrame);</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    QCoreApplication::processEvents();</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;}</div><div class="ttc" id="main_8cpp_html_ae095f10a005e68d20233dc15b4077ca6"><div class="ttname"><a href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a></div><div class="ttdeci">Mat Rvec</div><div class="ttdoc">rotation vector (axis-angle notation) from camera CoSy to marker CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00099">main.cpp:99</a></div></div>
<div class="ttc" id="main_8cpp_html_a54cb682bd037283c18b5a9a447ff5e5e"><div class="ttname"><a href="main_8cpp.html#a54cb682bd037283c18b5a9a447ff5e5e">list_points2dUnsorted</a></div><div class="ttdeci">std::vector&lt; Point2d &gt; list_points2dUnsorted</div><div class="ttdoc">marker points in 2D camera image CoSy, sorted with increasing x (camera image CoSy) but not sorted to...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00112">main.cpp:112</a></div></div>
<div class="ttc" id="main_8cpp_html_a7b88d0425a68875639d40a17079df819"><div class="ttname"><a href="main_8cpp.html#a7b88d0425a68875639d40a17079df819">list_points2dProjected</a></div><div class="ttdeci">std::vector&lt; Point2d &gt; list_points2dProjected</div><div class="ttdoc">3D marker points projected to 2D in camera image CoSy with the algorithm projectPoints ...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00111">main.cpp:111</a></div></div>
<div class="ttc" id="main_8cpp_html_a3e3cc959a7ab6f93ea52863d86373ce5"><div class="ttname"><a href="main_8cpp.html#a3e3cc959a7ab6f93ea52863d86373ce5">Mat2QPixmap</a></div><div class="ttdeci">QPixmap Mat2QPixmap(cv::Mat src)</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00225">main.cpp:225</a></div></div>
<div class="ttc" id="main_8cpp_html_af29e7fc07ae0979d5fb61b473241d33d"><div class="ttname"><a href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a></div><div class="ttdeci">commObject commObj</div><div class="ttdoc">class that handles the communication from main.cpp to the GUI </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00068">main.cpp:68</a></div></div>
<div class="ttc" id="main_8cpp_html_a8d67876da148be9118bba1c0d017fb57"><div class="ttname"><a href="main_8cpp.html#a8d67876da148be9118bba1c0d017fb57">distCoeffs</a></div><div class="ttdeci">Mat distCoeffs</div><div class="ttdoc">distortion coefficients of the camera </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00125">main.cpp:125</a></div></div>
<div class="ttc" id="main_8cpp_html_a2104a5d9d6b9f1e29bc4cd858c59882e"><div class="ttname"><a href="main_8cpp.html#a2104a5d9d6b9f1e29bc4cd858c59882e">projectCoordinateFrame</a></div><div class="ttdeci">void projectCoordinateFrame(Mat pictureFrame)</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l01099">main.cpp:1099</a></div></div>
<div class="ttc" id="main_8cpp_html_a85d3d8c8a0e3e9cfb6157c247470d934"><div class="ttname"><a href="main_8cpp.html#a85d3d8c8a0e3e9cfb6157c247470d934">list_points2dOld</a></div><div class="ttdeci">std::vector&lt; Point2d &gt; list_points2dOld</div><div class="ttdoc">marker positions in previous picture in 2D in camera image CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00109">main.cpp:109</a></div></div>
<div class="ttc" id="main_8cpp_html_a53e8957a459b639ca82d938157f3b085"><div class="ttname"><a href="main_8cpp.html#a53e8957a459b639ca82d938157f3b085">cameraMatrix</a></div><div class="ttdeci">Mat cameraMatrix</div><div class="ttdoc">camera matrix of the camera </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00124">main.cpp:124</a></div></div>
<div class="ttc" id="main_8cpp_html_a9215ba881de0242c883e5b065d6d2ff9"><div class="ttname"><a href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a></div><div class="ttdeci">Mat Tvec</div><div class="ttdoc">translation vector from camera CoSy to marker CoSy in camera CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00100">main.cpp:100</a></div></div>
<div class="ttc" id="main_8cpp_html_aea88a68a83d84419dd1c5a93b21b1958"><div class="ttname"><a href="main_8cpp.html#aea88a68a83d84419dd1c5a93b21b1958">list_points2dDifference</a></div><div class="ttdeci">std::vector&lt; double &gt; list_points2dDifference</div><div class="ttdoc">difference of the old and new 2D marker position to determine the order of the points ...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00110">main.cpp:110</a></div></div>
<div class="ttc" id="main_8cpp_html_a8fc3524f4e679a41dcc8d0f302d637ed"><div class="ttname"><a href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a></div><div class="ttdeci">std::stringstream ss</div><div class="ttdoc">stream that sends the strBuf buffer to the Qt GUI </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00142">main.cpp:142</a></div></div>
<div class="ttc" id="main_8cpp_html_ae1d37a43f631aefe76b6e540da786064"><div class="ttname"><a href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a></div><div class="ttdeci">int numberMarkers</div><div class="ttdoc">number of markers. Is loaded during start up from the marker configuration file </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00106">main.cpp:106</a></div></div>
<div class="ttc" id="main_8cpp_html_ad583e75f176dafdb7de3f214673851de"><div class="ttname"><a href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a></div><div class="ttdeci">std::vector&lt; Point2d &gt; list_points2d</div><div class="ttdoc">marker positions projected in 2D in camera image CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00108">main.cpp:108</a></div></div>
<div class="ttc" id="main_8cpp_html_a933edb4ba1c0589d59020164c2f1ff87"><div class="ttname"><a href="main_8cpp.html#a933edb4ba1c0589d59020164c2f1ff87">list_points3d</a></div><div class="ttdeci">std::vector&lt; Point3d &gt; list_points3d</div><div class="ttdoc">marker positions in marker CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00107">main.cpp:107</a></div></div>
<div class="ttc" id="main_8cpp_html_ab5e634b66221f494504aea1557af5df9"><div class="ttname"><a href="main_8cpp.html#ab5e634b66221f494504aea1557af5df9">methodPNP</a></div><div class="ttdeci">int methodPNP</div><div class="ttdoc">solvePNP algorithm 0 = iterative 1 = EPNP 2 = P3P 4 = UPNP //!&lt; 4 and 1 are the same and not implemen...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00105">main.cpp:105</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="main_8h_a56c7f641859cb2b6b99b0947d03be800_cgraph.svg" width="342" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="main_8h_a56c7f641859cb2b6b99b0947d03be800_icgraph.svg" width="232" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a2104a5d9d6b9f1e29bc4cd858c59882e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2104a5d9d6b9f1e29bc4cd858c59882e">&#9670;&nbsp;</a></span>projectCoordinateFrame()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void projectCoordinateFrame </td>
          <td>(</td>
          <td class="paramtype">Mat&#160;</td>
          <td class="paramname"><em>pictureFrame</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Project the coordinate CoSy origin and axis direction of the marker CoSy with the rotation and translation of the object for visualization. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pictureFrame</td><td>the image in which the CoSy frame should be pasted. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l01099">1099</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;{</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    projectPoints(<a class="code" href="main_8cpp.html#ab34a04f5429de54d618fe1c9bd363c4e">coordinateFrame</a>, <a class="code" href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a>, <a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>, <a class="code" href="main_8cpp.html#a53e8957a459b639ca82d938157f3b085">cameraMatrix</a>, <a class="code" href="main_8cpp.html#a8d67876da148be9118bba1c0d017fb57">distCoeffs</a>, <a class="code" href="main_8cpp.html#a25a0b285905c7882d629b8f561425a2f">coordinateFrameProjected</a>);</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    line(pictureFrame, <a class="code" href="main_8cpp.html#a25a0b285905c7882d629b8f561425a2f">coordinateFrameProjected</a>[0], <a class="code" href="main_8cpp.html#a25a0b285905c7882d629b8f561425a2f">coordinateFrameProjected</a>[3], Scalar(0, 0, 255), 2); <span class="comment">//!&lt;z-axis</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="comment"></span>    line(pictureFrame, <a class="code" href="main_8cpp.html#a25a0b285905c7882d629b8f561425a2f">coordinateFrameProjected</a>[0], <a class="code" href="main_8cpp.html#a25a0b285905c7882d629b8f561425a2f">coordinateFrameProjected</a>[1], Scalar(255, 0, 0), 2); <span class="comment">//!&lt;x-axis</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="comment"></span>    line(pictureFrame, <a class="code" href="main_8cpp.html#a25a0b285905c7882d629b8f561425a2f">coordinateFrameProjected</a>[0], <a class="code" href="main_8cpp.html#a25a0b285905c7882d629b8f561425a2f">coordinateFrameProjected</a>[2], Scalar(0, 255, 0), 2); <span class="comment">//!&lt;y-axis</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="comment"></span>}</div><div class="ttc" id="main_8cpp_html_ae095f10a005e68d20233dc15b4077ca6"><div class="ttname"><a href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a></div><div class="ttdeci">Mat Rvec</div><div class="ttdoc">rotation vector (axis-angle notation) from camera CoSy to marker CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00099">main.cpp:99</a></div></div>
<div class="ttc" id="main_8cpp_html_a8d67876da148be9118bba1c0d017fb57"><div class="ttname"><a href="main_8cpp.html#a8d67876da148be9118bba1c0d017fb57">distCoeffs</a></div><div class="ttdeci">Mat distCoeffs</div><div class="ttdoc">distortion coefficients of the camera </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00125">main.cpp:125</a></div></div>
<div class="ttc" id="main_8cpp_html_ab34a04f5429de54d618fe1c9bd363c4e"><div class="ttname"><a href="main_8cpp.html#ab34a04f5429de54d618fe1c9bd363c4e">coordinateFrame</a></div><div class="ttdeci">std::vector&lt; Point3d &gt; coordinateFrame</div><div class="ttdoc">coordinate visualisazion of marker CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00113">main.cpp:113</a></div></div>
<div class="ttc" id="main_8cpp_html_a53e8957a459b639ca82d938157f3b085"><div class="ttname"><a href="main_8cpp.html#a53e8957a459b639ca82d938157f3b085">cameraMatrix</a></div><div class="ttdeci">Mat cameraMatrix</div><div class="ttdoc">camera matrix of the camera </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00124">main.cpp:124</a></div></div>
<div class="ttc" id="main_8cpp_html_a9215ba881de0242c883e5b065d6d2ff9"><div class="ttname"><a href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a></div><div class="ttdeci">Mat Tvec</div><div class="ttdoc">translation vector from camera CoSy to marker CoSy in camera CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00100">main.cpp:100</a></div></div>
<div class="ttc" id="main_8cpp_html_a25a0b285905c7882d629b8f561425a2f"><div class="ttname"><a href="main_8cpp.html#a25a0b285905c7882d629b8f561425a2f">coordinateFrameProjected</a></div><div class="ttdeci">std::vector&lt; Point2d &gt; coordinateFrameProjected</div><div class="ttdoc">marker CoSy projected from 3D to 2D camera image CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00114">main.cpp:114</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="main_8h_a2104a5d9d6b9f1e29bc4cd858c59882e_icgraph.svg" width="510" height="240"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a54b6b6db348b48d21e1265e22829c61f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54b6b6db348b48d21e1265e22829c61f">&#9670;&nbsp;</a></span>sendDataUDP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sendDataUDP </td>
          <td>(</td>
          <td class="paramtype">cv::Vec3d &amp;&#160;</td>
          <td class="paramname"><em>Position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cv::Vec3d &amp;&#160;</td>
          <td class="paramname"><em>Euler</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Send the position and attitude over UDP to every receiver, the safety receiver is handled on its own in the startTracking function because its send rate is less than 100 Hz. </p>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l01172">1172</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;{</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <a class="code" href="main_8cpp.html#af38b495bf1b0e0651895215823059d30">datagram</a>.clear();</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    QDataStream out(&amp;<a class="code" href="main_8cpp.html#af38b495bf1b0e0651895215823059d30">datagram</a>, QIODevice::WriteOnly);</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    out.setVersion(QDataStream::Qt_4_3);</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    out &lt;&lt; (float)Position[0] &lt;&lt; (<span class="keywordtype">float</span>)Position[1] &lt;&lt; (float)Position[2];</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    out &lt;&lt; (float)Euler[0] &lt;&lt; (<span class="keywordtype">float</span>)Euler[1] &lt;&lt; (float)Euler[2]; <span class="comment">//! Roll Pitch Heading</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="comment"></span>    <a class="code" href="main_8cpp.html#ae628b9aba095776b7134cf188486e174">udpSocketObject</a>-&gt;writeDatagram(<a class="code" href="main_8cpp.html#af38b495bf1b0e0651895215823059d30">datagram</a>, <a class="code" href="main_8cpp.html#ab97ac0d82b1753d0eef37089be17e5e1">IPAdressObject</a>, <a class="code" href="main_8cpp.html#a9a00043c93a3362969c1c1fcd3a70fea">portObject</a>);</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="comment">    //! if second receiver is activated send it also the tracking data</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="comment"></span>    <span class="keywordflow">if</span> (<a class="code" href="main_8cpp.html#a436fb814ccc3f02617dade4dc6511143">safety2Enable</a>)</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    {</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        <a class="code" href="main_8cpp.html#a4260e46da4e0e430642b2d8d8d3c7dd1">udpSocketSafety2</a>-&gt;writeDatagram(<a class="code" href="main_8cpp.html#af38b495bf1b0e0651895215823059d30">datagram</a>, <a class="code" href="main_8cpp.html#a354806cf8cbface3575f2541d8fbcbda">IPAdressSafety2</a>, <a class="code" href="main_8cpp.html#a2601be9c226be24c71ec8282f632e723">portSafety2</a>);</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    }</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;}</div><div class="ttc" id="main_8cpp_html_a4260e46da4e0e430642b2d8d8d3c7dd1"><div class="ttname"><a href="main_8cpp.html#a4260e46da4e0e430642b2d8d8d3c7dd1">udpSocketSafety2</a></div><div class="ttdeci">QUdpSocket * udpSocketSafety2</div><div class="ttdoc">socket for the communication with receiver 3 </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00130">main.cpp:130</a></div></div>
<div class="ttc" id="main_8cpp_html_a354806cf8cbface3575f2541d8fbcbda"><div class="ttname"><a href="main_8cpp.html#a354806cf8cbface3575f2541d8fbcbda">IPAdressSafety2</a></div><div class="ttdeci">QHostAddress IPAdressSafety2</div><div class="ttdoc">IPv4 adress of receiver 2. </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00133">main.cpp:133</a></div></div>
<div class="ttc" id="main_8cpp_html_af38b495bf1b0e0651895215823059d30"><div class="ttname"><a href="main_8cpp.html#af38b495bf1b0e0651895215823059d30">datagram</a></div><div class="ttdeci">QByteArray datagram</div><div class="ttdoc">data package that is sent to receiver 1 and 2 </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00137">main.cpp:137</a></div></div>
<div class="ttc" id="main_8cpp_html_a436fb814ccc3f02617dade4dc6511143"><div class="ttname"><a href="main_8cpp.html#a436fb814ccc3f02617dade4dc6511143">safety2Enable</a></div><div class="ttdeci">bool safety2Enable</div><div class="ttdoc">is the second receiver enabled </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00071">main.cpp:71</a></div></div>
<div class="ttc" id="main_8cpp_html_ab97ac0d82b1753d0eef37089be17e5e1"><div class="ttname"><a href="main_8cpp.html#ab97ac0d82b1753d0eef37089be17e5e1">IPAdressObject</a></div><div class="ttdeci">QHostAddress IPAdressObject</div><div class="ttdoc">IPv4 adress of receiver 1. </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00131">main.cpp:131</a></div></div>
<div class="ttc" id="main_8cpp_html_a9a00043c93a3362969c1c1fcd3a70fea"><div class="ttname"><a href="main_8cpp.html#a9a00043c93a3362969c1c1fcd3a70fea">portObject</a></div><div class="ttdeci">int portObject</div><div class="ttdoc">Port of receiver 1. </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00134">main.cpp:134</a></div></div>
<div class="ttc" id="main_8cpp_html_a2601be9c226be24c71ec8282f632e723"><div class="ttname"><a href="main_8cpp.html#a2601be9c226be24c71ec8282f632e723">portSafety2</a></div><div class="ttdeci">int portSafety2</div><div class="ttdoc">Port of receiver 2. </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00136">main.cpp:136</a></div></div>
<div class="ttc" id="main_8cpp_html_ae628b9aba095776b7134cf188486e174"><div class="ttname"><a href="main_8cpp.html#ae628b9aba095776b7134cf188486e174">udpSocketObject</a></div><div class="ttdeci">QUdpSocket * udpSocketObject</div><div class="ttdoc">socket for the communication with receiver 1 </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00128">main.cpp:128</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="main_8h_a54b6b6db348b48d21e1265e22829c61f_icgraph.svg" width="428" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ad19da4e648bbdc80d3123eb94711588e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad19da4e648bbdc80d3123eb94711588e">&#9670;&nbsp;</a></span>setHeadingOffset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setHeadingOffset </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a heading offset to the attitude for the case it is wanted by the user. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>denotes heading offset in degrees. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l01140">1140</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;{</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <a class="code" href="main_8cpp.html#a377d62efbf6892902616cb71a4a5d5d7">headingOffset</a> = d;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    d = d * 3.141592653589 / 180.0; <span class="comment">//! Convert heading offset from degrees to rad</span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="comment"></span><span class="comment"></span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="comment">    //! Calculate rotation about x axis</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="comment"></span>    Mat R_x = (Mat_&lt;double&gt;(3, 3) &lt;&lt;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        1, 0, 0,</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        0, 1, 0,</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        0, 0, 1</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        );</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;<span class="comment">    //! Calculate rotation about y axis</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="comment"></span>    Mat R_y = (Mat_&lt;double&gt;(3, 3) &lt;&lt;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        1, 0, 0,</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        0, 1, 0,</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;        0, 0, 1</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;        );</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="comment">    //! Calculate rotation about z axis</span></div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="comment"></span>    Mat R_z = (Mat_&lt;double&gt;(3, 3) &lt;&lt;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        cos(d), -sin(d), 0,</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        sin(d), cos(d), 0,</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;        0, 0, 1);</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="comment">    //! Combined rotation matrix</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="comment"></span>    <a class="code" href="main_8cpp.html#a7b0c222d472eacfd5b0d73ed769baae0">M_HeadingOffset</a> = R_z * R_y * R_x;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;}</div><div class="ttc" id="main_8cpp_html_a377d62efbf6892902616cb71a4a5d5d7"><div class="ttname"><a href="main_8cpp.html#a377d62efbf6892902616cb71a4a5d5d7">headingOffset</a></div><div class="ttdeci">double headingOffset</div><div class="ttdoc">heading offset variable for aligning INS heading with tracking heading </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00087">main.cpp:87</a></div></div>
<div class="ttc" id="main_8cpp_html_a7b0c222d472eacfd5b0d73ed769baae0"><div class="ttname"><a href="main_8cpp.html#a7b0c222d472eacfd5b0d73ed769baae0">M_HeadingOffset</a></div><div class="ttdeci">Mat M_HeadingOffset</div><div class="ttdoc">rotation matrix that turns the ground system to the INS magnetic heading for alignment ...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00098">main.cpp:98</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="main_8h_ad19da4e648bbdc80d3123eb94711588e_icgraph.svg" width="231" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a1e6662e0f16887fe97c7bebe05065972"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e6662e0f16887fe97c7bebe05065972">&#9670;&nbsp;</a></span>setReference()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int setReference </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Determine the initial position of the object that serves as reference point or as ground frame origin. Computes the pose 200 times and then averages it. The position and attitude are from now on used as navigation CoSy. </p>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l00613">613</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;{<span class="comment"></span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">    //! initialize the variables with starting values</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment"></span>    <a class="code" href="main_8cpp.html#acf655f393e3996144226399a338e8d3b">gotOrder</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <a class="code" href="main_8cpp.html#a9d2e25dbfda0ebcdbb488652c8b15fad">posRef</a> = 0;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <a class="code" href="main_8cpp.html#acd6966c004a57c4080ba204152200e7f">eulerRef</a> = 0;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <a class="code" href="main_8cpp.html#a4ee4d2abbe47b92c21b81c5c4389086e">RmatRef</a> = 0;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <a class="code" href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a> = <a class="code" href="main_8cpp.html#ae101daeaec726e27690c862b7edea825">RvecOriginal</a>;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a> = <a class="code" href="main_8cpp.html#a043bf1deaf5d42d47e0cce8982c1f18b">TvecOriginal</a>;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <a class="code" href="main_8cpp.html#a0416912fce6274568e80019b10ba294f">determineExposure</a>();</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(<span class="stringliteral">&quot;Started reference coordinate determination.&quot;</span>);</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    CameraLibrary_EnableDevelopment();<span class="comment"></span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">    //! Initialize Camera SDK ==--</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment"></span>    CameraLibrary::CameraManager::X();</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment">    //! At this point the Camera SDK is actively looking for all connected cameras and will initialize</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">    //! them on it&#39;s own.</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment"></span><span class="comment"></span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">    //! Get a connected camera ================----</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment"></span>    CameraManager::X().WaitForInitialization();</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    Camera *camera = CameraManager::X().GetCamera();</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">    //! If no device connected, pop a message box and exit ==--</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment"></span>    <span class="keywordflow">if</span> (camera == 0)</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    {</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(<span class="stringliteral">&quot;No camera found!&quot;</span>);</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    }</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">    //! Determine camera resolution to size application window ==----</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment"></span>    <span class="keywordtype">int</span> cameraWidth = camera-&gt;Width();</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="keywordtype">int</span> cameraHeight = camera-&gt;Height();</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    camera-&gt;GetDistortionModel(<a class="code" href="main_8cpp.html#a9fba099569a2da23e458c2571f69652a">distModel</a>);</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    cv::Mat matFrame(cv::Size(cameraWidth, cameraHeight), CV_8UC1);</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment">    //! Set camera mode to precision mode, it directly provides marker coordinates</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment"></span>    camera-&gt;SetVideoType(Core::PrecisionMode);</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">    //! Start camera output ==--</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment"></span>    camera-&gt;Start();</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">    //! Turn on some overlay text so it&#39;s clear things are     ===---</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment">    //! working even if there is nothing in the camera&#39;s view. ===---</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">    //! Set some other parameters as well of the camera</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment"></span>    camera-&gt;SetTextOverlay(<span class="keyword">true</span>);</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    camera-&gt;SetFrameRate(<a class="code" href="main_8cpp.html#aa5b833b78b107a1a04eb4edba151c0ba">intFrameRate</a>);</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    camera-&gt;SetIntensity(<a class="code" href="main_8cpp.html#a4e18b0b26ecc511ca7d2f2205313e537">intIntensity</a>);</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    camera-&gt;SetIRFilter(<span class="keyword">true</span>);</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    camera-&gt;SetContinuousIR(<span class="keyword">false</span>);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    camera-&gt;SetHighPowerMode(<span class="keyword">false</span>);</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">    //! sample some frames and calculate the position and attitude. then average those values and use that as zero position</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment"></span>    <span class="keywordtype">int</span> numberSamples = 0;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keywordtype">int</span> numberToSample = 200;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keywordtype">double</span> projectionError = 0; <span class="comment">//!&lt; difference between the marker points as seen by the camera and the projected marker points with Rvec and Tvec</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="keywordflow">while</span> (numberSamples &lt; numberToSample)</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    {<span class="comment"></span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">        //! Fetch a new frame from the camera ===---</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment"></span>        Frame *frame = camera-&gt;GetFrame();</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <span class="keywordflow">if</span> (frame)</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        {<span class="comment"></span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">            //! Ok, we&#39;ve received a new frame, lets do something</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment">            //! with it.</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment"></span>            <span class="keywordflow">if</span> (frame-&gt;ObjectCount() == <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>)</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            {<span class="comment"></span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">                //!for(int i=0; i&lt;frame-&gt;ObjectCount(); i++)</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment"></span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>; i++)</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                {</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                    cObject *obj = frame-&gt;Object(i);</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                    <a class="code" href="main_8cpp.html#a54cb682bd037283c18b5a9a447ff5e5e">list_points2dUnsorted</a>[i] = cv::Point2d(obj-&gt;X(), obj-&gt;Y());</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                }</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="main_8cpp.html#acf655f393e3996144226399a338e8d3b">gotOrder</a> == <span class="keyword">false</span>)</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                {</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                    <a class="code" href="main_8cpp.html#a11ff459289305229597defd39f510959">determineOrder</a>();</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                }</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment">                //! sort the 2d points with the correct indices as found in the preceeding order determination algorithm</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment"></span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> w = 0; w &lt; <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>; w++)</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                {</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                    <a class="code" href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a>[w] = <a class="code" href="main_8cpp.html#a54cb682bd037283c18b5a9a447ff5e5e">list_points2dUnsorted</a>[<a class="code" href="main_8cpp.html#ac06fee052099b9fc9f0826315bb64a4a">pointOrderIndices</a>[w]];</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                }</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                <a class="code" href="main_8cpp.html#a85d3d8c8a0e3e9cfb6157c247470d934">list_points2dOld</a> = <a class="code" href="main_8cpp.html#a54cb682bd037283c18b5a9a447ff5e5e">list_points2dUnsorted</a>;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">                //!Compute the pose from the 3D-2D corresponses</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment"></span>                solvePnP(<a class="code" href="main_8cpp.html#a933edb4ba1c0589d59020164c2f1ff87">list_points3d</a>, <a class="code" href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a>, <a class="code" href="main_8cpp.html#a53e8957a459b639ca82d938157f3b085">cameraMatrix</a>, <a class="code" href="main_8cpp.html#a8d67876da148be9118bba1c0d017fb57">distCoeffs</a>, <a class="code" href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a>, <a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>, <a class="code" href="main_8cpp.html#ab1cc9be1ff0871bc5de1eb4c2811ae3e">useGuess</a>, <a class="code" href="main_8cpp.html#ab5e634b66221f494504aea1557af5df9">methodPNP</a>);</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">                //! project the marker 3d points with the solution into the camera image CoSy and calculate difference to true camera image</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment"></span>                projectPoints(<a class="code" href="main_8cpp.html#a933edb4ba1c0589d59020164c2f1ff87">list_points3d</a>, <a class="code" href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a>, <a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>, <a class="code" href="main_8cpp.html#a53e8957a459b639ca82d938157f3b085">cameraMatrix</a>, <a class="code" href="main_8cpp.html#a8d67876da148be9118bba1c0d017fb57">distCoeffs</a>, <a class="code" href="main_8cpp.html#a7b88d0425a68875639d40a17079df819">list_points2dProjected</a>);</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                projectionError = norm(<a class="code" href="main_8cpp.html#a7b88d0425a68875639d40a17079df819">list_points2dProjected</a>, <a class="code" href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a>);</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                <span class="keywordtype">double</span> maxValue = 0;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                <span class="keywordtype">double</span> minValue = 0;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                minMaxLoc(<a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>.at&lt;<span class="keywordtype">double</span>&gt;(2), &amp;minValue, &amp;maxValue);</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                <span class="keywordflow">if</span> (maxValue &gt; 10000 || minValue &lt; 0)</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                {</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;Negative z distance, thats not possible. Start the set zero routine again or restart Programm.&quot;</span>;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                    <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(QString::fromStdString(<a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str()));</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                    frame-&gt;Release();</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                }</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                <span class="keywordflow">if</span> (projectionError &gt; 5)</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                {</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                    <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(<span class="stringliteral">&quot;Reprojection error is bigger than 5 pixel. Correct marker configuration loaded?\nMarker position measured precisely?&quot;</span>);</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                    frame-&gt;Release();</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                }</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                <span class="keywordflow">if</span> (norm(<a class="code" href="main_8cpp.html#a1d543a183197268bcb54a06bf157852c">positionOld</a>) - norm(<a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>) &lt; 0.05)  <span class="comment">//!&lt;Iterative Method needs time to converge to solution</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment"></span>                {</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                    add(<a class="code" href="main_8cpp.html#a9d2e25dbfda0ebcdbb488652c8b15fad">posRef</a>, <a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>, <a class="code" href="main_8cpp.html#a9d2e25dbfda0ebcdbb488652c8b15fad">posRef</a>);</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                    add(<a class="code" href="main_8cpp.html#acd6966c004a57c4080ba204152200e7f">eulerRef</a>, <a class="code" href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a>, <a class="code" href="main_8cpp.html#acd6966c004a57c4080ba204152200e7f">eulerRef</a>); <span class="comment">//!&lt; That are not the values of yaw, roll and pitch yet! Rodriguez has to be called first. </span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment"></span>                    numberSamples++;    <span class="comment">//!&lt;  one sample more :D</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment"></span>                    <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.progressUpdate(numberSamples * 100 / numberToSample);</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                }</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                <a class="code" href="main_8cpp.html#a1d543a183197268bcb54a06bf157852c">positionOld</a> = <a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                Mat cFrame(480, 640, CV_8UC3, Scalar(0, 0, 0));</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>; i++)</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                {</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                    circle(cFrame, Point(<a class="code" href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a>[i].x, <a class="code" href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a>[i].y), 6, Scalar(0, 225, 0), 3);</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                }</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                <a class="code" href="main_8cpp.html#a2104a5d9d6b9f1e29bc4cd858c59882e">projectCoordinateFrame</a>(cFrame);</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                projectPoints(<a class="code" href="main_8cpp.html#a933edb4ba1c0589d59020164c2f1ff87">list_points3d</a>, <a class="code" href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a>, <a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>, <a class="code" href="main_8cpp.html#a53e8957a459b639ca82d938157f3b085">cameraMatrix</a>, <a class="code" href="main_8cpp.html#a8d67876da148be9118bba1c0d017fb57">distCoeffs</a>, <a class="code" href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a>);</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>; i++)</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                {</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                    circle(cFrame, Point(<a class="code" href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a>[i].x, <a class="code" href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a>[i].y), 3, Scalar(225, 0, 0), 3);</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                }</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                <a class="code" href="main_8cpp.html#af6430ad2592a955a3618549547dfc5be">drawPositionText</a>(cFrame, <a class="code" href="main_8cpp.html#ac6dab448fd1f9b3aed1205fbd8179f5d">position</a>, <a class="code" href="main_8cpp.html#a0a53d01e06c71d6360afcb0fabf2aa8e">eulerAngles</a>, projectionError);</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                QPixmap QPFrame;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                QPFrame = <a class="code" href="main_8cpp.html#a3e3cc959a7ab6f93ea52863d86373ce5">Mat2QPixmap</a>(cFrame);</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.changeImage(QPFrame);</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                QCoreApplication::processEvents();</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            }</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            frame-&gt;Release();</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        }</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    }<span class="comment"></span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">    //! Release camera ==--</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment"></span>    camera-&gt;Release();</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment">    //!Divide by the number of samples to get the mean of the reference position</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment"></span>    divide(<a class="code" href="main_8cpp.html#a9d2e25dbfda0ebcdbb488652c8b15fad">posRef</a>, numberToSample, <a class="code" href="main_8cpp.html#a9d2e25dbfda0ebcdbb488652c8b15fad">posRef</a>);</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    divide(<a class="code" href="main_8cpp.html#acd6966c004a57c4080ba204152200e7f">eulerRef</a>, numberToSample, <a class="code" href="main_8cpp.html#acd6966c004a57c4080ba204152200e7f">eulerRef</a>); <span class="comment">//!&lt; eulerRef is here in Axis Angle notation</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    Rodrigues(<a class="code" href="main_8cpp.html#acd6966c004a57c4080ba204152200e7f">eulerRef</a>, <a class="code" href="main_8cpp.html#a4ee4d2abbe47b92c21b81c5c4389086e">RmatRef</a>);               <span class="comment">//!&lt; axis angle to rotation matrix</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment"></span><span class="comment">    //!-- Euler Angles, finally </span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment"></span>    <a class="code" href="main_8cpp.html#ab2b71933055cf32cc8e5e2100fd7723f">getEulerAngles</a>(<a class="code" href="main_8cpp.html#a4ee4d2abbe47b92c21b81c5c4389086e">RmatRef</a>, <a class="code" href="main_8cpp.html#acd6966c004a57c4080ba204152200e7f">eulerRef</a>);  <span class="comment">//!&lt;  rotation matrix to euler</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment"></span>    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;RmatRef is:\n&quot;</span>;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <a class="code" href="main_8cpp.html#a4ee4d2abbe47b92c21b81c5c4389086e">RmatRef</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;Reference Position is:\n&quot;</span>;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <a class="code" href="main_8cpp.html#a9d2e25dbfda0ebcdbb488652c8b15fad">posRef</a> &lt;&lt; <span class="stringliteral">&quot;[mm] \n&quot;</span>;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;Reference Euler Angles are:\n&quot;</span>;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <a class="code" href="main_8cpp.html#acd6966c004a57c4080ba204152200e7f">eulerRef</a> &lt;&lt; <span class="stringliteral">&quot;[deg] \n&quot;</span>;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment">    //! compute the difference between last obtained TVec and the average Value</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment">    //! When it is large the iterative method has not converged properly so it is advised to start the setReference() function once again</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> error = norm(posRef) - norm(<a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>);</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="keywordflow">if</span> (error &gt; 5.0)</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    {</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;Caution, distance between reference position and last position is: &quot;</span> &lt;&lt; error &lt;&lt; <span class="stringliteral">&quot;\n Start the set zero routine once again.&quot;</span>;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    }</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(QString::fromStdString(<a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str()));</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.progressUpdate(0);</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;}</div><div class="ttc" id="main_8cpp_html_ac06fee052099b9fc9f0826315bb64a4a"><div class="ttname"><a href="main_8cpp.html#ac06fee052099b9fc9f0826315bb64a4a">pointOrderIndices</a></div><div class="ttdeci">int pointOrderIndices[]</div><div class="ttdoc">old correspondence from list_points3d and list_points_2d </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00115">main.cpp:115</a></div></div>
<div class="ttc" id="main_8cpp_html_ae095f10a005e68d20233dc15b4077ca6"><div class="ttname"><a href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a></div><div class="ttdeci">Mat Rvec</div><div class="ttdoc">rotation vector (axis-angle notation) from camera CoSy to marker CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00099">main.cpp:99</a></div></div>
<div class="ttc" id="main_8cpp_html_a54cb682bd037283c18b5a9a447ff5e5e"><div class="ttname"><a href="main_8cpp.html#a54cb682bd037283c18b5a9a447ff5e5e">list_points2dUnsorted</a></div><div class="ttdeci">std::vector&lt; Point2d &gt; list_points2dUnsorted</div><div class="ttdoc">marker points in 2D camera image CoSy, sorted with increasing x (camera image CoSy) but not sorted to...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00112">main.cpp:112</a></div></div>
<div class="ttc" id="main_8cpp_html_a7b88d0425a68875639d40a17079df819"><div class="ttname"><a href="main_8cpp.html#a7b88d0425a68875639d40a17079df819">list_points2dProjected</a></div><div class="ttdeci">std::vector&lt; Point2d &gt; list_points2dProjected</div><div class="ttdoc">3D marker points projected to 2D in camera image CoSy with the algorithm projectPoints ...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00111">main.cpp:111</a></div></div>
<div class="ttc" id="main_8cpp_html_a3e3cc959a7ab6f93ea52863d86373ce5"><div class="ttname"><a href="main_8cpp.html#a3e3cc959a7ab6f93ea52863d86373ce5">Mat2QPixmap</a></div><div class="ttdeci">QPixmap Mat2QPixmap(cv::Mat src)</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00225">main.cpp:225</a></div></div>
<div class="ttc" id="main_8cpp_html_af29e7fc07ae0979d5fb61b473241d33d"><div class="ttname"><a href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a></div><div class="ttdeci">commObject commObj</div><div class="ttdoc">class that handles the communication from main.cpp to the GUI </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00068">main.cpp:68</a></div></div>
<div class="ttc" id="main_8cpp_html_ab1cc9be1ff0871bc5de1eb4c2811ae3e"><div class="ttname"><a href="main_8cpp.html#ab1cc9be1ff0871bc5de1eb4c2811ae3e">useGuess</a></div><div class="ttdeci">bool useGuess</div><div class="ttdoc">set to true and the algorithm uses the last result as starting value </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00104">main.cpp:104</a></div></div>
<div class="ttc" id="main_8cpp_html_a9fba099569a2da23e458c2571f69652a"><div class="ttname"><a href="main_8cpp.html#a9fba099569a2da23e458c2571f69652a">distModel</a></div><div class="ttdeci">Core::DistortionModel distModel</div><div class="ttdoc">distortion model of the camera </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00126">main.cpp:126</a></div></div>
<div class="ttc" id="main_8cpp_html_a8d67876da148be9118bba1c0d017fb57"><div class="ttname"><a href="main_8cpp.html#a8d67876da148be9118bba1c0d017fb57">distCoeffs</a></div><div class="ttdeci">Mat distCoeffs</div><div class="ttdoc">distortion coefficients of the camera </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00125">main.cpp:125</a></div></div>
<div class="ttc" id="main_8cpp_html_acf655f393e3996144226399a338e8d3b"><div class="ttname"><a href="main_8cpp.html#acf655f393e3996144226399a338e8d3b">gotOrder</a></div><div class="ttdeci">bool gotOrder</div><div class="ttdoc">order of the list_points3d and list_points3d already tetermined or not, has to be done once ...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00120">main.cpp:120</a></div></div>
<div class="ttc" id="main_8cpp_html_a2104a5d9d6b9f1e29bc4cd858c59882e"><div class="ttname"><a href="main_8cpp.html#a2104a5d9d6b9f1e29bc4cd858c59882e">projectCoordinateFrame</a></div><div class="ttdeci">void projectCoordinateFrame(Mat pictureFrame)</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l01099">main.cpp:1099</a></div></div>
<div class="ttc" id="main_8cpp_html_a85d3d8c8a0e3e9cfb6157c247470d934"><div class="ttname"><a href="main_8cpp.html#a85d3d8c8a0e3e9cfb6157c247470d934">list_points2dOld</a></div><div class="ttdeci">std::vector&lt; Point2d &gt; list_points2dOld</div><div class="ttdoc">marker positions in previous picture in 2D in camera image CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00109">main.cpp:109</a></div></div>
<div class="ttc" id="main_8cpp_html_a53e8957a459b639ca82d938157f3b085"><div class="ttname"><a href="main_8cpp.html#a53e8957a459b639ca82d938157f3b085">cameraMatrix</a></div><div class="ttdeci">Mat cameraMatrix</div><div class="ttdoc">camera matrix of the camera </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00124">main.cpp:124</a></div></div>
<div class="ttc" id="main_8cpp_html_a4e18b0b26ecc511ca7d2f2205313e537"><div class="ttname"><a href="main_8cpp.html#a4e18b0b26ecc511ca7d2f2205313e537">intIntensity</a></div><div class="ttdeci">int intIntensity</div><div class="ttdoc">max infrared spot light intensity is 15 1-6 is strobe 7-15 is continuous 13 and 14 are meaningless ...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00089">main.cpp:89</a></div></div>
<div class="ttc" id="main_8cpp_html_a11ff459289305229597defd39f510959"><div class="ttname"><a href="main_8cpp.html#a11ff459289305229597defd39f510959">determineOrder</a></div><div class="ttdeci">void determineOrder()</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l01516">main.cpp:1516</a></div></div>
<div class="ttc" id="main_8cpp_html_ac6dab448fd1f9b3aed1205fbd8179f5d"><div class="ttname"><a href="main_8cpp.html#ac6dab448fd1f9b3aed1205fbd8179f5d">position</a></div><div class="ttdeci">Vec3d position</div><div class="ttdoc">position vector x,y,z for object position in O-CoSy, unit is meter </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00081">main.cpp:81</a></div></div>
<div class="ttc" id="main_8cpp_html_a1d543a183197268bcb54a06bf157852c"><div class="ttname"><a href="main_8cpp.html#a1d543a183197268bcb54a06bf157852c">positionOld</a></div><div class="ttdeci">Vec3d positionOld</div><div class="ttdoc">old position in O-CoSy for finite differences velocity calculation </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00083">main.cpp:83</a></div></div>
<div class="ttc" id="main_8cpp_html_ae101daeaec726e27690c862b7edea825"><div class="ttname"><a href="main_8cpp.html#ae101daeaec726e27690c862b7edea825">RvecOriginal</a></div><div class="ttdeci">Mat RvecOriginal</div><div class="ttdoc">initial values as start values for algorithms and algorithm tests </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00101">main.cpp:101</a></div></div>
<div class="ttc" id="main_8cpp_html_a4ee4d2abbe47b92c21b81c5c4389086e"><div class="ttname"><a href="main_8cpp.html#a4ee4d2abbe47b92c21b81c5c4389086e">RmatRef</a></div><div class="ttdeci">Mat RmatRef</div><div class="ttdoc">reference rotation matrix from camera CoSy to marker CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00096">main.cpp:96</a></div></div>
<div class="ttc" id="main_8cpp_html_a9215ba881de0242c883e5b065d6d2ff9"><div class="ttname"><a href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a></div><div class="ttdeci">Mat Tvec</div><div class="ttdoc">translation vector from camera CoSy to marker CoSy in camera CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00100">main.cpp:100</a></div></div>
<div class="ttc" id="main_8cpp_html_a8fc3524f4e679a41dcc8d0f302d637ed"><div class="ttname"><a href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a></div><div class="ttdeci">std::stringstream ss</div><div class="ttdoc">stream that sends the strBuf buffer to the Qt GUI </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00142">main.cpp:142</a></div></div>
<div class="ttc" id="main_8cpp_html_af6430ad2592a955a3618549547dfc5be"><div class="ttname"><a href="main_8cpp.html#af6430ad2592a955a3618549547dfc5be">drawPositionText</a></div><div class="ttdeci">void drawPositionText(cv::Mat &amp;Picture, cv::Vec3d &amp;Position, cv::Vec3d &amp;Euler, double error)</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l01333">main.cpp:1333</a></div></div>
<div class="ttc" id="main_8cpp_html_a0a53d01e06c71d6360afcb0fabf2aa8e"><div class="ttname"><a href="main_8cpp.html#a0a53d01e06c71d6360afcb0fabf2aa8e">eulerAngles</a></div><div class="ttdeci">Vec3d eulerAngles</div><div class="ttdoc">Roll Pitch Heading in this order, units in degrees. </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00082">main.cpp:82</a></div></div>
<div class="ttc" id="main_8cpp_html_aa5b833b78b107a1a04eb4edba151c0ba"><div class="ttname"><a href="main_8cpp.html#aa5b833b78b107a1a04eb4edba151c0ba">intFrameRate</a></div><div class="ttdeci">int intFrameRate</div><div class="ttdoc">CoSy rate of camera, maximum is 100 fps. </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00091">main.cpp:91</a></div></div>
<div class="ttc" id="main_8cpp_html_ae1d37a43f631aefe76b6e540da786064"><div class="ttname"><a href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a></div><div class="ttdeci">int numberMarkers</div><div class="ttdoc">number of markers. Is loaded during start up from the marker configuration file </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00106">main.cpp:106</a></div></div>
<div class="ttc" id="main_8cpp_html_ab2b71933055cf32cc8e5e2100fd7723f"><div class="ttname"><a href="main_8cpp.html#ab2b71933055cf32cc8e5e2100fd7723f">getEulerAngles</a></div><div class="ttdeci">void getEulerAngles(Mat &amp;rotCamerMatrix, Vec3d &amp;eulerAngles)</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00256">main.cpp:256</a></div></div>
<div class="ttc" id="main_8cpp_html_a0416912fce6274568e80019b10ba294f"><div class="ttname"><a href="main_8cpp.html#a0416912fce6274568e80019b10ba294f">determineExposure</a></div><div class="ttdeci">int determineExposure()</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l01380">main.cpp:1380</a></div></div>
<div class="ttc" id="main_8cpp_html_acd6966c004a57c4080ba204152200e7f"><div class="ttname"><a href="main_8cpp.html#acd6966c004a57c4080ba204152200e7f">eulerRef</a></div><div class="ttdeci">Vec3d eulerRef</div><div class="ttdoc">initial euler angle of object respectivley to camera CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00086">main.cpp:86</a></div></div>
<div class="ttc" id="main_8cpp_html_ad583e75f176dafdb7de3f214673851de"><div class="ttname"><a href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a></div><div class="ttdeci">std::vector&lt; Point2d &gt; list_points2d</div><div class="ttdoc">marker positions projected in 2D in camera image CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00108">main.cpp:108</a></div></div>
<div class="ttc" id="main_8cpp_html_a043bf1deaf5d42d47e0cce8982c1f18b"><div class="ttname"><a href="main_8cpp.html#a043bf1deaf5d42d47e0cce8982c1f18b">TvecOriginal</a></div><div class="ttdeci">Mat TvecOriginal</div><div class="ttdoc">initial values as start values for algorithms and algorithm tests </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00102">main.cpp:102</a></div></div>
<div class="ttc" id="main_8cpp_html_a933edb4ba1c0589d59020164c2f1ff87"><div class="ttname"><a href="main_8cpp.html#a933edb4ba1c0589d59020164c2f1ff87">list_points3d</a></div><div class="ttdeci">std::vector&lt; Point3d &gt; list_points3d</div><div class="ttdoc">marker positions in marker CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00107">main.cpp:107</a></div></div>
<div class="ttc" id="main_8cpp_html_ab5e634b66221f494504aea1557af5df9"><div class="ttname"><a href="main_8cpp.html#ab5e634b66221f494504aea1557af5df9">methodPNP</a></div><div class="ttdeci">int methodPNP</div><div class="ttdoc">solvePNP algorithm 0 = iterative 1 = EPNP 2 = P3P 4 = UPNP //!&lt; 4 and 1 are the same and not implemen...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00105">main.cpp:105</a></div></div>
<div class="ttc" id="main_8cpp_html_a9d2e25dbfda0ebcdbb488652c8b15fad"><div class="ttname"><a href="main_8cpp.html#a9d2e25dbfda0ebcdbb488652c8b15fad">posRef</a></div><div class="ttdeci">Vec3d posRef</div><div class="ttdoc">initial position of object in camera CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00085">main.cpp:85</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="main_8h_a1e6662e0f16887fe97c7bebe05065972_cgraph.svg" width="318" height="291"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a3d3afd29ce54eb7fc5cc7e74ab666586"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d3afd29ce54eb7fc5cc7e74ab666586">&#9670;&nbsp;</a></span>startTracking()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int startTracking </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Start the loop that fetches frames, computes the position etc and sends it to other computers. This function is the core of this program, hence the pose estimation is done here. </p>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l00276">276</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                    {</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <a class="code" href="main_8cpp.html#acf655f393e3996144226399a338e8d3b">gotOrder</a> = <span class="keyword">false</span>; <span class="comment">//! The order of points, hence which entry in list_points3d corresponds to which in list_points2d is not calculated yet</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment"></span>    <a class="code" href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a> = <a class="code" href="main_8cpp.html#ae101daeaec726e27690c862b7edea825">RvecOriginal</a>; <span class="comment">//! Use the value of Rvec that was set in main() as starting value for the solvePnP algorithm</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment"></span>    <a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a> = <a class="code" href="main_8cpp.html#a043bf1deaf5d42d47e0cce8982c1f18b">TvecOriginal</a>; <span class="comment">//! Use the value of Tvec that was set in main() as starting value for the solvePnP algorithm</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment"></span>    GetLocalTime(&amp;<a class="code" href="main_8cpp.html#aba7ea4b1074abf42199ab9ab295e9c33">logDate</a>); <span class="comment">//! Get the current date and time to name the log file</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment"></span><span class="comment"></span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">    //! Concat the log file name as followed. The file is saved in the folder /logs in the Rigid Track installation folder</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment"></span>    <a class="code" href="main_8cpp.html#a10895c5c32e9441213c79f05d2b5ba45">logFileName</a> = <span class="stringliteral">&quot;./logs/positionLog_&quot;</span> + QString::number(<a class="code" href="main_8cpp.html#aba7ea4b1074abf42199ab9ab295e9c33">logDate</a>.wDay) + <span class="stringliteral">&quot;_&quot;</span> + QString::number(<a class="code" href="main_8cpp.html#aba7ea4b1074abf42199ab9ab295e9c33">logDate</a>.wMonth) + <span class="stringliteral">&quot;_&quot;</span> + QString::number(<a class="code" href="main_8cpp.html#aba7ea4b1074abf42199ab9ab295e9c33">logDate</a>.wYear);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="main_8cpp.html#a10895c5c32e9441213c79f05d2b5ba45">logFileName</a> += <span class="stringliteral">&quot;_&quot;</span> + QString::number(<a class="code" href="main_8cpp.html#aba7ea4b1074abf42199ab9ab295e9c33">logDate</a>.wHour) + <span class="stringliteral">&quot;_&quot;</span> + QString::number(<a class="code" href="main_8cpp.html#aba7ea4b1074abf42199ab9ab295e9c33">logDate</a>.wMinute) + <span class="stringliteral">&quot;_&quot;</span> + QString::number(<a class="code" href="main_8cpp.html#aba7ea4b1074abf42199ab9ab295e9c33">logDate</a>.wSecond) + <span class="stringliteral">&quot;.txt&quot;</span>;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="main_8cpp.html#a7a642b2c947e62ff5ec692ec95783bd0">logName</a> = <a class="code" href="main_8cpp.html#a10895c5c32e9441213c79f05d2b5ba45">logFileName</a>.toStdString(); <span class="comment">//! Convert the QString to a standard string</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <a class="code" href="main_8cpp.html#a0416912fce6274568e80019b10ba294f">determineExposure</a>(); <span class="comment">//! Get the exposure where the right amount of markers is detected</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment"></span><span class="comment"></span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">    //! For OptiTrack Ethernet cameras, it&#39;s important to enable development mode if you</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">    //! want to stop execution for an extended time while debugging without disconnecting</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">    //! the Ethernet devices.  Lets do that now:</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    CameraLibrary_EnableDevelopment();</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    CameraLibrary::CameraManager::X(); <span class="comment">//! Initialize Camera SDK</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"></span><span class="comment"></span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">    //! At this point the Camera SDK is actively looking for all connected cameras and will initialize</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">    //! them on it&#39;s own</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment"></span><span class="comment"></span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">    //! Get a connected camera</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment"></span>    CameraManager::X().WaitForInitialization();</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    Camera *camera = CameraManager::X().GetCamera();</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">    //! If no camera can be found, inform user in message log and exit function</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment"></span>    <span class="keywordflow">if</span> (camera == 0)</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(<span class="stringliteral">&quot;No camera found!&quot;</span>);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    }</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">    //! Determine camera resolution to size application window </span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment"></span>    <span class="keywordtype">int</span> cameraWidth = camera-&gt;Width();</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordtype">int</span> cameraHeight = camera-&gt;Height();</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    camera-&gt;SetVideoType(Core::PrecisionMode);  <span class="comment">//! Set the camera mode to precision mode, it used greyscale imformation for marker property calculations</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    camera-&gt;Start(); <span class="comment">//! Start camera output</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment"></span><span class="comment"></span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">    //! Turn on some overlay text so it&#39;s clear things are</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">    //! working even if there is nothing in the camera&#39;s view</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment"></span>    camera-&gt;SetTextOverlay(<span class="keyword">true</span>);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    camera-&gt;SetExposure(<a class="code" href="main_8cpp.html#afcaebd6cfd12b2e558363a06db8396ea">intExposure</a>);   <span class="comment">//! Set the camera exposure</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment"></span>    camera-&gt;SetIntensity(<a class="code" href="main_8cpp.html#a4e18b0b26ecc511ca7d2f2205313e537">intIntensity</a>); <span class="comment">//! Set the camera infrared LED intensity</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment"></span>    camera-&gt;SetFrameRate(<a class="code" href="main_8cpp.html#aa5b833b78b107a1a04eb4edba151c0ba">intFrameRate</a>); <span class="comment">//! Set the camera framerate to 100 Hz</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment"></span>    camera-&gt;SetIRFilter(<span class="keyword">true</span>);  <span class="comment">//! Enable the filter that blocks visible light and only passes infrared light</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment"></span>    camera-&gt;SetHighPowerMode(<span class="keyword">true</span>); <span class="comment">//! Enable high power mode of the LEDs</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment"></span>    camera-&gt;SetContinuousIR(<span class="keyword">false</span>); <span class="comment">//! Disable continuous LED light</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment"></span>    camera-&gt;SetThreshold(<a class="code" href="main_8cpp.html#ac61559ce6020b8ec00161bc3a994ddcc">intThreshold</a>); <span class="comment">//! Set threshold for marker detection</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment"></span><span class="comment"></span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">    //! Create a new matrix that stores the grayscale picture from the camera</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment"></span>    Mat matFrame = Mat::zeros(cv::Size(cameraWidth, cameraHeight), CV_8UC1);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    QPixmap QPFrame; <span class="comment">//! QPixmap is the corresponding Qt class that saves images</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment"></span><span class="comment">    //! Matrix that stores the colored picture, hence marker points, coordinate frame and reprojected points</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment"></span>    Mat cFrame(480, 640, CV_8UC3, Scalar(0, 0, 0));</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordtype">int</span> v = 0;  <span class="comment">//! Helper variable used to kick safety switch</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment"></span><span class="comment">    //! Variables for the min and max values that are needed for sanity checks</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> maxValue = 0;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordtype">double</span> minValue = 0;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordtype">int</span> framesDropped = 0; <span class="comment">//! Ff a marker is not visible or accuracy is bad increase this counter</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> projectionError = 0; <span class="comment">//! Equals the quality of the tracking</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <a class="code" href="main_8cpp.html#ae624b0189bc5e32cbbb1f178b9f1a360">setUpUDP</a>(); <span class="comment">//! Open sockets and ports for UDP communication</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="main_8cpp.html#aa6266eedab8b3c011be53baffbfc42ab">safetyEnable</a>) <span class="comment">//! If the safety feature is enabled send the starting message</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment"></span>    {<span class="comment"></span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">        //! Send enable message, hence send a 9 and then a 1 </span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment"></span>        <a class="code" href="main_8cpp.html#ad44c6ce322034044d573e6d4678d630b">data</a>.setNum((<span class="keywordtype">int</span>)(9));</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <a class="code" href="main_8cpp.html#a6aa0c3a69dc10d5c4432dcf62e2155d3">udpSocketSafety</a>-&gt;write(<a class="code" href="main_8cpp.html#ad44c6ce322034044d573e6d4678d630b">data</a>);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <a class="code" href="main_8cpp.html#ad44c6ce322034044d573e6d4678d630b">data</a>.setNum((<span class="keywordtype">int</span>)(1));</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <a class="code" href="main_8cpp.html#a6aa0c3a69dc10d5c4432dcf62e2155d3">udpSocketSafety</a>-&gt;write(<a class="code" href="main_8cpp.html#ad44c6ce322034044d573e6d4678d630b">data</a>);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    }</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">    //! Fetch a new frame from the camera</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment"></span>    <span class="keywordtype">bool</span> gotTime = <span class="keyword">false</span>; <span class="comment">//! Get the timestamp of the first frame. This time is subtracted from every subseeding frame so the time starts at 0 in the logs</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment"></span>    <span class="keywordflow">while</span> (!gotTime) <span class="comment">//! While no new frame is received loop </span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment"></span>    {</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        Frame *frame = camera-&gt;GetFrame(); <span class="comment">//! Get a new camera frame</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment"></span>        <span class="keywordflow">if</span> (frame)  <span class="comment">//! There is actually a new frame</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment"></span>        {</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            <a class="code" href="main_8cpp.html#ac7de3790df75e7d70bfe280b9af47a56">timeFirstFrame</a> = frame-&gt;TimeStamp(); <span class="comment">//! Get the time stamp for the first frame. It is subtracted for the following frames</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment"></span>            frame-&gt;Release();   <span class="comment">//! Release the frame so the camera can continue</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment"></span>            gotTime = <span class="keyword">true</span>; <span class="comment">//! Exit the while loop</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment"></span>        }</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    }</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">    //! Now enter the main loop that processes each frame and computes the pose, sends it and logs stuff</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment"></span>    <span class="keywordflow">while</span> (!<a class="code" href="main_8cpp.html#a6b1342fd3f76c3ce13245825cff8e400">exitRequested</a>) <span class="comment">//! Check if the user has not pressed &quot;Stop Tracking&quot; yet</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment"></span>    {</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        Frame *frame = camera-&gt;GetFrame(); <span class="comment">//! Fetch a new frame from the camera</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="keywordflow">if</span> (frame) <span class="comment">//! Did we got a new frame or does the camera still need more time</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment"></span>        {</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            framesDropped++; <span class="comment">//! Increase by one, if everything is okay it is decreased at the end of the loop again</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment"></span><span class="comment"></span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">            //! Only use this frame it the right number of markers is found in the picture</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment"></span>            <span class="keywordflow">if</span> (frame-&gt;ObjectCount() == <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>)</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            {<span class="comment"></span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">                //! Get the marker points in 2D in the camera image frame and store them in the list_points2dUnsorted vector</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">                //! The order of points that come from the camera corresponds to the Y coordinate</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment"></span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>; i++)</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                {</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                    cObject *obj = frame-&gt;Object(i);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                    <a class="code" href="main_8cpp.html#a54cb682bd037283c18b5a9a447ff5e5e">list_points2dUnsorted</a>[i] = cv::Point2d(obj-&gt;X(), obj-&gt;Y());</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                }</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="main_8cpp.html#acf655f393e3996144226399a338e8d3b">gotOrder</a> == <span class="keyword">false</span>) <span class="comment">//! Was the order already determined? This is false for the first frame and from then on true</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment"></span>                {</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                    <a class="code" href="main_8cpp.html#a11ff459289305229597defd39f510959">determineOrder</a>(); <span class="comment">//! Now compute the order</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment"></span>                }</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">                //! Sort the 2d points with the correct indices as found in the preceeding order determination algorithm</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment"></span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> w = 0; w &lt; <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>; w++)</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                {</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                    <a class="code" href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a>[w] = <a class="code" href="main_8cpp.html#a54cb682bd037283c18b5a9a447ff5e5e">list_points2dUnsorted</a>[<a class="code" href="main_8cpp.html#ac06fee052099b9fc9f0826315bb64a4a">pointOrderIndices</a>[w]]; <span class="comment">//! pointOrderIndices was calculated in determineOrder()</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment"></span>                }</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">                //! The first time the 2D-3D corresspondence was determined with gotOrder was okay. </span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">                //! But this order can change as the object moves and the marker objects appear in a</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">                //! different order in the frame-&gt;Object() array.</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">                //! The solution is that: When a marker point (in the camera image, hence in 2D) was at</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">                //! a position then it wont move that much from one frame to the other.</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">                //! So for the new frame we take a marker object and check which marker was closest this point  </span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">                //! in the old image frame? This is probably the same (true) marker. And we do that for every other marker as well.</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">                //! When tracking is good and no frames are dropped because of missing markers this should work every frame.</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment"></span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>; j++)</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                {</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                    <a class="code" href="main_8cpp.html#ab826a7ca5876afdd6c0bccf04b73b30b">minPointDistance</a> = 5000; <span class="comment">//! The sum of point distances is set to something unrealistic large</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment"></span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>; k++)</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                    {<span class="comment"></span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">                        //! Calculate N_2 norm of unsorted points minus old points</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment"></span>                        <a class="code" href="main_8cpp.html#afe37bd67ad83a2d897cf5977cba70ef3">currentPointDistance</a> = norm(<a class="code" href="main_8cpp.html#a54cb682bd037283c18b5a9a447ff5e5e">list_points2dUnsorted</a>[<a class="code" href="main_8cpp.html#ac06fee052099b9fc9f0826315bb64a4a">pointOrderIndices</a>[j]] - <a class="code" href="main_8cpp.html#a85d3d8c8a0e3e9cfb6157c247470d934">list_points2dOld</a>[k]);<span class="comment"></span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">                        //! If the norm is smaller than minPointDistance the correspondence is more likely to be correct</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment"></span>                        <span class="keywordflow">if</span> (<a class="code" href="main_8cpp.html#afe37bd67ad83a2d897cf5977cba70ef3">currentPointDistance</a> &lt; <a class="code" href="main_8cpp.html#ab826a7ca5876afdd6c0bccf04b73b30b">minPointDistance</a>)</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                        {<span class="comment"></span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">                            //! Update the array that saves the new point order</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment"></span>                            <a class="code" href="main_8cpp.html#ab826a7ca5876afdd6c0bccf04b73b30b">minPointDistance</a> = <a class="code" href="main_8cpp.html#afe37bd67ad83a2d897cf5977cba70ef3">currentPointDistance</a>;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                            <a class="code" href="main_8cpp.html#acc9e758efd664582db86f976cec195fa">pointOrderIndicesNew</a>[j] = k;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                        }</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                    }</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                }</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">                //! Now the new order is found, set the point order to the new value</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment"></span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>; k++)</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                {</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                    <a class="code" href="main_8cpp.html#ac06fee052099b9fc9f0826315bb64a4a">pointOrderIndices</a>[k] = <a class="code" href="main_8cpp.html#acc9e758efd664582db86f976cec195fa">pointOrderIndicesNew</a>[k];</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                    <a class="code" href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a>[k] = <a class="code" href="main_8cpp.html#a54cb682bd037283c18b5a9a447ff5e5e">list_points2dUnsorted</a>[<a class="code" href="main_8cpp.html#ac06fee052099b9fc9f0826315bb64a4a">pointOrderIndices</a>[k]];</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                }</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">                //! Save the unsorted position of the marker points for the next loop</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment"></span>                <a class="code" href="main_8cpp.html#a85d3d8c8a0e3e9cfb6157c247470d934">list_points2dOld</a> = <a class="code" href="main_8cpp.html#a54cb682bd037283c18b5a9a447ff5e5e">list_points2dUnsorted</a>;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">                //!Compute the object pose from the 3D-2D corresponses</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment"></span>                solvePnP(<a class="code" href="main_8cpp.html#a933edb4ba1c0589d59020164c2f1ff87">list_points3d</a>, <a class="code" href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a>, <a class="code" href="main_8cpp.html#a53e8957a459b639ca82d938157f3b085">cameraMatrix</a>, <a class="code" href="main_8cpp.html#a8d67876da148be9118bba1c0d017fb57">distCoeffs</a>, <a class="code" href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a>, <a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>, <a class="code" href="main_8cpp.html#ab1cc9be1ff0871bc5de1eb4c2811ae3e">useGuess</a>, <a class="code" href="main_8cpp.html#ab5e634b66221f494504aea1557af5df9">methodPNP</a>);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">                //! Project the marker 3d points with the solution into the camera image CoSy and calculate difference to true camera image</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment"></span>                projectPoints(<a class="code" href="main_8cpp.html#a933edb4ba1c0589d59020164c2f1ff87">list_points3d</a>, <a class="code" href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a>, <a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>, <a class="code" href="main_8cpp.html#a53e8957a459b639ca82d938157f3b085">cameraMatrix</a>, <a class="code" href="main_8cpp.html#a8d67876da148be9118bba1c0d017fb57">distCoeffs</a>, <a class="code" href="main_8cpp.html#a7b88d0425a68875639d40a17079df819">list_points2dProjected</a>);</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                projectionError = norm(<a class="code" href="main_8cpp.html#a7b88d0425a68875639d40a17079df819">list_points2dProjected</a>, <a class="code" href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a>); <span class="comment">//! Difference of true pose and found pose</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment"></span><span class="comment"></span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">                //! Increase the framesDropped variable if accuracy of tracking is too bad</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment"></span>                <span class="keywordflow">if</span> (projectionError &gt; 5)</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                {</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                    framesDropped++;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                }</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                {</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                    framesDropped = 0;  <span class="comment">//! Set number of subsequent frames dropped to zero because error is small enough and no marker was missing</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment"></span>                }</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">                //! Get the min and max values from TVec for sanity check</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment"></span>                minMaxLoc(<a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>.at&lt;<span class="keywordtype">double</span>&gt;(2), &amp;minValue, &amp;maxValue);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">                //! Sanity check of values. negative z means the marker CoSy is behind the camera, that&#39;s not possible.</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment"></span>                <span class="keywordflow">if</span> (minValue &lt; 0)</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                {</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                    <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(<span class="stringliteral">&quot;Negative z distance, that is not possible. Start the set zero routine again or restart Program.&quot;</span>);</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                    frame-&gt;Release(); <span class="comment">//! Release the frame so the camera can move on</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment"></span>                    camera-&gt;Release(); <span class="comment">//! Release the camera</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment"></span>                    <a class="code" href="main_8cpp.html#af2a8b7de0b15dc17198c147ba39e85f3">closeUDP</a>(); <span class="comment">//! Close all UDP connections so the programm can be closed later on and no resources are locked</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment"></span>                    <span class="keywordflow">return</span> 1; <span class="comment">//! Exit the function</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment"></span>                }</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">                //! Next step is the transformation from camera CoSy to navigation CoSy</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">                //! Compute the relative object position from the reference position to the current one</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">                //! given in the camera CoSy: \f$ T_C^{NM} = Tvec - Tvec_{Ref} \f$</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment"></span>                subtract(<a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>, <a class="code" href="main_8cpp.html#a9d2e25dbfda0ebcdbb488652c8b15fad">posRef</a>, <a class="code" href="main_8cpp.html#ac6dab448fd1f9b3aed1205fbd8179f5d">position</a>);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">                //! Transform the position from the camera CoSy to the navigation CoSy with INS alligned heading and convert from [mm] to [m]</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">                //! \f$ T_N^{NM} = M_{NC} \times T_C^{NM} \f$</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment"></span>                Mat V = 0.001 * <a class="code" href="main_8cpp.html#a7b0c222d472eacfd5b0d73ed769baae0">M_HeadingOffset</a> * <a class="code" href="main_8cpp.html#af604b9538ec8923428a78439eaf55f8e">M_CN</a>.t() * (Mat)<a class="code" href="main_8cpp.html#ac6dab448fd1f9b3aed1205fbd8179f5d">position</a>;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                <a class="code" href="main_8cpp.html#ac6dab448fd1f9b3aed1205fbd8179f5d">position</a> = V;   <span class="comment">//! Position is the result of the preceeding calculation </span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment"></span>                <a class="code" href="main_8cpp.html#ac6dab448fd1f9b3aed1205fbd8179f5d">position</a>[2] *= <a class="code" href="main_8cpp.html#a5cc3bd09f5801804b7ae65846e0b9824">invertZ</a>; <span class="comment">//! Invert Z if check box in GUI is activated, hence height above ground is considered</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment"></span><span class="comment"></span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">                //! Realtive angle between reference orientation and current orientation</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment"></span>                Rodrigues(<a class="code" href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a>, <a class="code" href="main_8cpp.html#adb13e6a4e95f0640adf01ada840748d9">Rmat</a>);  <span class="comment">//! Convert axis angle respresentation to ordinary rotation matrix</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment"></span><span class="comment"></span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">                //! The difference of the reference rotation and the current rotation</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">                //! \f$ R_{ NM } = M_{ NC } \times R_{ CM } \f$</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment"></span>                <a class="code" href="main_8cpp.html#adb13e6a4e95f0640adf01ada840748d9">Rmat</a> = <a class="code" href="main_8cpp.html#a4ee4d2abbe47b92c21b81c5c4389086e">RmatRef</a>.t() *<a class="code" href="main_8cpp.html#adb13e6a4e95f0640adf01ada840748d9">Rmat</a>;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">                //! Euler Angles, finally </span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment"></span>                <a class="code" href="main_8cpp.html#ab2b71933055cf32cc8e5e2100fd7723f">getEulerAngles</a>(<a class="code" href="main_8cpp.html#adb13e6a4e95f0640adf01ada840748d9">Rmat</a>, <a class="code" href="main_8cpp.html#a0a53d01e06c71d6360afcb0fabf2aa8e">eulerAngles</a>);  <span class="comment">//! Get the euler angles from the rotation matrix </span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment"></span>                <a class="code" href="main_8cpp.html#a0a53d01e06c71d6360afcb0fabf2aa8e">eulerAngles</a>[2] += <a class="code" href="main_8cpp.html#a377d62efbf6892902616cb71a4a5d5d7">headingOffset</a>; <span class="comment">//! Add the heading offset to the heading angle</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment"></span><span class="comment"></span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">                //! Compute the velocity with finite differences. Only use is the log file. It is done here because the more precise time stamp can be used</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment"></span>                <a class="code" href="main_8cpp.html#ada7a8f4e3e45f929a512ffb0d9ff9012">frameTime</a> = frame-&gt;TimeStamp() - <a class="code" href="main_8cpp.html#acf4e0d12f76439e42c1ce9fd3d2bcbc8">timeOld</a>;   <span class="comment">//! Time between the old frame and the current frame</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment"></span>                <a class="code" href="main_8cpp.html#acf4e0d12f76439e42c1ce9fd3d2bcbc8">timeOld</a> = frame-&gt;TimeStamp();   <span class="comment">//! Set the old frame time to the current  one</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment"></span>                <a class="code" href="main_8cpp.html#a700b8df52e2beb702d06651ed6130e73">velocity</a>[0] = (<a class="code" href="main_8cpp.html#ac6dab448fd1f9b3aed1205fbd8179f5d">position</a>[0] - <a class="code" href="main_8cpp.html#a1d543a183197268bcb54a06bf157852c">positionOld</a>[0]) / <a class="code" href="main_8cpp.html#ada7a8f4e3e45f929a512ffb0d9ff9012">frameTime</a>;   <span class="comment">//! Calculate the x velocity with finite differences</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment"></span>                <a class="code" href="main_8cpp.html#a700b8df52e2beb702d06651ed6130e73">velocity</a>[1] = (<a class="code" href="main_8cpp.html#ac6dab448fd1f9b3aed1205fbd8179f5d">position</a>[1] - <a class="code" href="main_8cpp.html#a1d543a183197268bcb54a06bf157852c">positionOld</a>[1]) / <a class="code" href="main_8cpp.html#ada7a8f4e3e45f929a512ffb0d9ff9012">frameTime</a>;   <span class="comment">//! Calculate the y velocity with finite differences</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment"></span>                <a class="code" href="main_8cpp.html#a700b8df52e2beb702d06651ed6130e73">velocity</a>[2] = (<a class="code" href="main_8cpp.html#ac6dab448fd1f9b3aed1205fbd8179f5d">position</a>[2] - <a class="code" href="main_8cpp.html#a1d543a183197268bcb54a06bf157852c">positionOld</a>[2]) / <a class="code" href="main_8cpp.html#ada7a8f4e3e45f929a512ffb0d9ff9012">frameTime</a>;   <span class="comment">//! Calculate the z velocity with finite differences</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment"></span>                <a class="code" href="main_8cpp.html#a1d543a183197268bcb54a06bf157852c">positionOld</a> = <a class="code" href="main_8cpp.html#ac6dab448fd1f9b3aed1205fbd8179f5d">position</a>; <span class="comment">//! Set the old position to the current one for next frame velocity calcuation</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                <a class="code" href="main_8cpp.html#a0a53d01e06c71d6360afcb0fabf2aa8e">eulerAngles</a>[0] = <a class="code" href="main_8cpp.html#a0a53d01e06c71d6360afcb0fabf2aa8e">eulerAngles</a>[0] * -3.141592653589 / 180.0; <span class="comment">//! Convert the Euler angles from degrees to rad</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment"></span>                <a class="code" href="main_8cpp.html#a0a53d01e06c71d6360afcb0fabf2aa8e">eulerAngles</a>[1] = <a class="code" href="main_8cpp.html#a0a53d01e06c71d6360afcb0fabf2aa8e">eulerAngles</a>[1] * -3.141592653589 / 180.0;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                <a class="code" href="main_8cpp.html#a0a53d01e06c71d6360afcb0fabf2aa8e">eulerAngles</a>[2] = <a class="code" href="main_8cpp.html#a0a53d01e06c71d6360afcb0fabf2aa8e">eulerAngles</a>[2] * 3.141592653589 / 180.0;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">                //! Send position and Euler angles over WiFi with 100 Hz</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment"></span>                <a class="code" href="main_8cpp.html#a54b6b6db348b48d21e1265e22829c61f">sendDataUDP</a>(<a class="code" href="main_8cpp.html#ac6dab448fd1f9b3aed1205fbd8179f5d">position</a>, <a class="code" href="main_8cpp.html#a0a53d01e06c71d6360afcb0fabf2aa8e">eulerAngles</a>);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">                //! Save the values in a log file, values are:</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">                //! Time sinc tracking started  Position    Euler Angles    Velocity</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment"></span>                <a class="code" href="main_8cpp.html#a267046e6c367b4c2dec18b9b772ab67a">logfile</a>.open(<a class="code" href="main_8cpp.html#a7a642b2c947e62ff5ec692ec95783bd0">logName</a>, std::ios::app); <span class="comment">//! Open the log file, the folder is RigidTrackInstallationFolder/logs</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment"></span>                <a class="code" href="main_8cpp.html#a267046e6c367b4c2dec18b9b772ab67a">logfile</a> &lt;&lt; frame-&gt;TimeStamp() - <a class="code" href="main_8cpp.html#ac7de3790df75e7d70bfe280b9af47a56">timeFirstFrame</a> &lt;&lt; <span class="stringliteral">&quot;;&quot;</span> &lt;&lt; <a class="code" href="main_8cpp.html#ac6dab448fd1f9b3aed1205fbd8179f5d">position</a>[0] &lt;&lt; <span class="stringliteral">&quot;;&quot;</span> &lt;&lt; <a class="code" href="main_8cpp.html#ac6dab448fd1f9b3aed1205fbd8179f5d">position</a>[1] &lt;&lt; <span class="stringliteral">&quot;;&quot;</span> &lt;&lt; <a class="code" href="main_8cpp.html#ac6dab448fd1f9b3aed1205fbd8179f5d">position</a>[2] &lt;&lt; <span class="stringliteral">&quot;;&quot;</span>;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                <a class="code" href="main_8cpp.html#a267046e6c367b4c2dec18b9b772ab67a">logfile</a> &lt;&lt; <a class="code" href="main_8cpp.html#a0a53d01e06c71d6360afcb0fabf2aa8e">eulerAngles</a>[0] &lt;&lt; <span class="stringliteral">&quot;;&quot;</span> &lt;&lt; <a class="code" href="main_8cpp.html#a0a53d01e06c71d6360afcb0fabf2aa8e">eulerAngles</a>[1] &lt;&lt; <span class="stringliteral">&quot;;&quot;</span> &lt;&lt; <a class="code" href="main_8cpp.html#a0a53d01e06c71d6360afcb0fabf2aa8e">eulerAngles</a>[2] &lt;&lt; <span class="stringliteral">&quot;;&quot;</span>;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                <a class="code" href="main_8cpp.html#a267046e6c367b4c2dec18b9b772ab67a">logfile</a> &lt;&lt; <a class="code" href="main_8cpp.html#a700b8df52e2beb702d06651ed6130e73">velocity</a>[0] &lt;&lt; <span class="stringliteral">&quot;;&quot;</span> &lt;&lt; <a class="code" href="main_8cpp.html#a700b8df52e2beb702d06651ed6130e73">velocity</a>[1] &lt;&lt; <span class="stringliteral">&quot;;&quot;</span> &lt;&lt; <a class="code" href="main_8cpp.html#a700b8df52e2beb702d06651ed6130e73">velocity</a>[2] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                <a class="code" href="main_8cpp.html#a267046e6c367b4c2dec18b9b772ab67a">logfile</a>.close(); <span class="comment">//! Close the file to save values</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment"></span>            }</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">            //! Check if the position and euler angles are below the allowed value, if yes send OKAY signal (1), if not send shutdown signal (0)</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">            //! Absolute x, y and z position in navigation CoSy must be smaller than the allowed distance</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment"></span>            <span class="keywordflow">if</span> (<a class="code" href="main_8cpp.html#aa6266eedab8b3c011be53baffbfc42ab">safetyEnable</a>)</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            {</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                <span class="keywordflow">if</span> ((abs(position[0]) &lt; <a class="code" href="main_8cpp.html#a2c1b807fcb2de5a6759bd60ccae6dd7e">safetyBoxLength</a> &amp;&amp; abs(position[1]) &lt; <a class="code" href="main_8cpp.html#a2c1b807fcb2de5a6759bd60ccae6dd7e">safetyBoxLength</a> &amp;&amp; abs(position[2]) &lt; <a class="code" href="main_8cpp.html#a2c1b807fcb2de5a6759bd60ccae6dd7e">safetyBoxLength</a>))</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                {<span class="comment"></span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">                    //! Absolute Euler angles must be smaller than allowed value. Heading is not considered </span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment"></span>                    <span class="keywordflow">if</span> ((abs(eulerAngles[0]) &lt; <a class="code" href="main_8cpp.html#ae65386c3310ab826e84fba757296de9a">safetyAngle</a> &amp;&amp; abs(eulerAngles[1]) &lt; <a class="code" href="main_8cpp.html#ae65386c3310ab826e84fba757296de9a">safetyAngle</a>))</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                    {<span class="comment"></span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">                        //! Send the OKAY signal to the desired computer every 5th time</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment"></span>                        <span class="keywordflow">if</span> (v == 5) {</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                            <a class="code" href="main_8cpp.html#ad44c6ce322034044d573e6d4678d630b">data</a>.setNum((<span class="keywordtype">int</span>)(1));</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                            <a class="code" href="main_8cpp.html#a6aa0c3a69dc10d5c4432dcf62e2155d3">udpSocketSafety</a>-&gt;write(<a class="code" href="main_8cpp.html#ad44c6ce322034044d573e6d4678d630b">data</a>); <span class="comment">//! Send the 1 </span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment"></span>                            v = 0; <span class="comment">//! reset the counter that is needed for decimation to every 5th time step</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment"></span>                        }</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                    }<span class="comment"></span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">                    //! The euler angles of the object exceeded the allowed euler angles, send the shutdown signal (0)</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment"></span>                    <span class="keywordflow">else</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                    {</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                        <a class="code" href="main_8cpp.html#ad44c6ce322034044d573e6d4678d630b">data</a>.setNum((<span class="keywordtype">int</span>)(0));  <span class="comment">//! Send the shutdown signal, a 0 </span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment"></span>                        <a class="code" href="main_8cpp.html#a6aa0c3a69dc10d5c4432dcf62e2155d3">udpSocketSafety</a>-&gt;write(<a class="code" href="main_8cpp.html#ad44c6ce322034044d573e6d4678d630b">data</a>);</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                        <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(<span class="stringliteral">&quot;Object exceeded allowed Euler angles, shutdown signal sent.&quot;</span>); <span class="comment">//! Inform the user</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                    }</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                }<span class="comment"></span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">                //! The position of the object exceeded the allowed position, shut the object down</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment"></span>                <span class="keywordflow">else</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                {</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                    <a class="code" href="main_8cpp.html#ad44c6ce322034044d573e6d4678d630b">data</a>.setNum((<span class="keywordtype">int</span>)(0));  <span class="comment">//! Send the shutdown signal, a 0 </span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment"></span>                    <a class="code" href="main_8cpp.html#a6aa0c3a69dc10d5c4432dcf62e2155d3">udpSocketSafety</a>-&gt;write(<a class="code" href="main_8cpp.html#ad44c6ce322034044d573e6d4678d630b">data</a>);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                    <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(<span class="stringliteral">&quot;Object left allowed area, shutdown signal sent.&quot;</span>); <span class="comment">//! Inform the user</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                }</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            }</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">            //! Inform the user if tracking system is disturbed (marker lost or so) or error was too big </span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment"></span>            <span class="keywordflow">if</span> (framesDropped &gt; 10)</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            {</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="main_8cpp.html#aa6266eedab8b3c011be53baffbfc42ab">safetyEnable</a>) <span class="comment">//! Also send the shutdown signal</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment"></span>                {</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                    <a class="code" href="main_8cpp.html#ad44c6ce322034044d573e6d4678d630b">data</a>.setNum((<span class="keywordtype">int</span>)(0));  <span class="comment">//! Send the shutdown signal, a 0 </span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment"></span>                    <a class="code" href="main_8cpp.html#a6aa0c3a69dc10d5c4432dcf62e2155d3">udpSocketSafety</a>-&gt;write(<a class="code" href="main_8cpp.html#ad44c6ce322034044d573e6d4678d630b">data</a>);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                }</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(<span class="stringliteral">&quot;Lost marker points or precision was bad!&quot;</span>); <span class="comment">//! Inform the user</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment"></span>                framesDropped = 0;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            }</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">            //! Rasterize the frame so it can be shown in the GUI</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment"></span>            frame-&gt;Rasterize(cameraWidth, cameraHeight, matFrame.step, <a class="code" href="main_8cpp.html#ae144f2eb508ffc763c259d875c600ab2">BACKBUFFER_BITSPERPIXEL</a>, matFrame.data);</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">            //! Convert the frame from greyscale as it comes from the camera to rgb color </span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment"></span>            cvtColor(matFrame, cFrame, COLOR_GRAY2RGB);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">            //! Project (draw) the marker CoSy origin into 2D and save it in the cFrame image</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment"></span>            <a class="code" href="main_8cpp.html#a2104a5d9d6b9f1e29bc4cd858c59882e">projectCoordinateFrame</a>(cFrame);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">            //! Project the marker points from 3D to the camera image frame (2d) with the computed pose</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment"></span>            projectPoints(<a class="code" href="main_8cpp.html#a933edb4ba1c0589d59020164c2f1ff87">list_points3d</a>, <a class="code" href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a>, <a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>, <a class="code" href="main_8cpp.html#a53e8957a459b639ca82d938157f3b085">cameraMatrix</a>, <a class="code" href="main_8cpp.html#a8d67876da148be9118bba1c0d017fb57">distCoeffs</a>, <a class="code" href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a>);</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>; i++)</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            {<span class="comment"></span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">                //! Draw a circle around the projected points so the result can be better compared to the real marker position</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">                //! In the resulting picture those are the red dots</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment"></span>                circle(cFrame, Point(<a class="code" href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a>[i].x, <a class="code" href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a>[i].y), 3, Scalar(225, 0, 0), 3);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            }</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">            //! Write the current position, attitude and error values as text in the frame</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment"></span>            <a class="code" href="main_8cpp.html#af6430ad2592a955a3618549547dfc5be">drawPositionText</a>(cFrame, position, eulerAngles, projectionError);</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">            //! Send the new camera picture to the GUI and call the GUI processing routine</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment"></span>            QPixmap QPFrame;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            QPFrame = <a class="code" href="main_8cpp.html#a3e3cc959a7ab6f93ea52863d86373ce5">Mat2QPixmap</a>(cFrame);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.changeImage(QPFrame); <span class="comment">//! Update the picture in the GUI</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment"></span>            QCoreApplication::processEvents(); <span class="comment">//! Give Qt time to handle everything</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment"></span><span class="comment"></span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">            //! Release the camera frame to fetch the new one</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment"></span>            frame-&gt;Release();</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        }</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    }</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">    //! User choose to stop the tracking, clean things up</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment"></span>    <a class="code" href="main_8cpp.html#af2a8b7de0b15dc17198c147ba39e85f3">closeUDP</a>(); <span class="comment">//! Close the UDP connections so resources are deallocated</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment"></span>    camera-&gt;Release();  <span class="comment">//! Release camera</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment"></span>    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;}</div><div class="ttc" id="main_8cpp_html_ac06fee052099b9fc9f0826315bb64a4a"><div class="ttname"><a href="main_8cpp.html#ac06fee052099b9fc9f0826315bb64a4a">pointOrderIndices</a></div><div class="ttdeci">int pointOrderIndices[]</div><div class="ttdoc">old correspondence from list_points3d and list_points_2d </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00115">main.cpp:115</a></div></div>
<div class="ttc" id="main_8cpp_html_af604b9538ec8923428a78439eaf55f8e"><div class="ttname"><a href="main_8cpp.html#af604b9538ec8923428a78439eaf55f8e">M_CN</a></div><div class="ttdeci">Mat M_CN</div><div class="ttdoc">rotation matrix from camera to ground, fixed for given camera position </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00097">main.cpp:97</a></div></div>
<div class="ttc" id="main_8cpp_html_ae095f10a005e68d20233dc15b4077ca6"><div class="ttname"><a href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a></div><div class="ttdeci">Mat Rvec</div><div class="ttdoc">rotation vector (axis-angle notation) from camera CoSy to marker CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00099">main.cpp:99</a></div></div>
<div class="ttc" id="main_8cpp_html_a6aa0c3a69dc10d5c4432dcf62e2155d3"><div class="ttname"><a href="main_8cpp.html#a6aa0c3a69dc10d5c4432dcf62e2155d3">udpSocketSafety</a></div><div class="ttdeci">QUdpSocket * udpSocketSafety</div><div class="ttdoc">socket for the communication with safety receiver </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00129">main.cpp:129</a></div></div>
<div class="ttc" id="main_8cpp_html_ae624b0189bc5e32cbbb1f178b9f1a360"><div class="ttname"><a href="main_8cpp.html#ae624b0189bc5e32cbbb1f178b9f1a360">setUpUDP</a></div><div class="ttdeci">void setUpUDP()</div><div class="ttdoc">Open the UDP ports for communication. </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l01108">main.cpp:1108</a></div></div>
<div class="ttc" id="main_8cpp_html_a54cb682bd037283c18b5a9a447ff5e5e"><div class="ttname"><a href="main_8cpp.html#a54cb682bd037283c18b5a9a447ff5e5e">list_points2dUnsorted</a></div><div class="ttdeci">std::vector&lt; Point2d &gt; list_points2dUnsorted</div><div class="ttdoc">marker points in 2D camera image CoSy, sorted with increasing x (camera image CoSy) but not sorted to...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00112">main.cpp:112</a></div></div>
<div class="ttc" id="main_8cpp_html_afcaebd6cfd12b2e558363a06db8396ea"><div class="ttname"><a href="main_8cpp.html#afcaebd6cfd12b2e558363a06db8396ea">intExposure</a></div><div class="ttdeci">int intExposure</div><div class="ttdoc">max is 480 increase if markers are badly visible but should be determined automatically during setRef...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00090">main.cpp:90</a></div></div>
<div class="ttc" id="main_8cpp_html_a7b88d0425a68875639d40a17079df819"><div class="ttname"><a href="main_8cpp.html#a7b88d0425a68875639d40a17079df819">list_points2dProjected</a></div><div class="ttdeci">std::vector&lt; Point2d &gt; list_points2dProjected</div><div class="ttdoc">3D marker points projected to 2D in camera image CoSy with the algorithm projectPoints ...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00111">main.cpp:111</a></div></div>
<div class="ttc" id="main_8cpp_html_acf4e0d12f76439e42c1ce9fd3d2bcbc8"><div class="ttname"><a href="main_8cpp.html#acf4e0d12f76439e42c1ce9fd3d2bcbc8">timeOld</a></div><div class="ttdeci">double timeOld</div><div class="ttdoc">old time for finite differences velocity calculation. Is later on replaced with the hardware timestam...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00078">main.cpp:78</a></div></div>
<div class="ttc" id="main_8cpp_html_adb13e6a4e95f0640adf01ada840748d9"><div class="ttname"><a href="main_8cpp.html#adb13e6a4e95f0640adf01ada840748d9">Rmat</a></div><div class="ttdeci">Mat Rmat</div><div class="ttdoc">Rotation, translation etc. matrix for PnP results. </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00095">main.cpp:95</a></div></div>
<div class="ttc" id="main_8cpp_html_a3e3cc959a7ab6f93ea52863d86373ce5"><div class="ttname"><a href="main_8cpp.html#a3e3cc959a7ab6f93ea52863d86373ce5">Mat2QPixmap</a></div><div class="ttdeci">QPixmap Mat2QPixmap(cv::Mat src)</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00225">main.cpp:225</a></div></div>
<div class="ttc" id="main_8cpp_html_ac61559ce6020b8ec00161bc3a994ddcc"><div class="ttname"><a href="main_8cpp.html#ac61559ce6020b8ec00161bc3a994ddcc">intThreshold</a></div><div class="ttdeci">int intThreshold</div><div class="ttdoc">threshold value for marker detection. If markers are badly visible lower this value but should not be...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00092">main.cpp:92</a></div></div>
<div class="ttc" id="main_8cpp_html_af29e7fc07ae0979d5fb61b473241d33d"><div class="ttname"><a href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a></div><div class="ttdeci">commObject commObj</div><div class="ttdoc">class that handles the communication from main.cpp to the GUI </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00068">main.cpp:68</a></div></div>
<div class="ttc" id="main_8cpp_html_ab1cc9be1ff0871bc5de1eb4c2811ae3e"><div class="ttname"><a href="main_8cpp.html#ab1cc9be1ff0871bc5de1eb4c2811ae3e">useGuess</a></div><div class="ttdeci">bool useGuess</div><div class="ttdoc">set to true and the algorithm uses the last result as starting value </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00104">main.cpp:104</a></div></div>
<div class="ttc" id="main_8cpp_html_a8d67876da148be9118bba1c0d017fb57"><div class="ttname"><a href="main_8cpp.html#a8d67876da148be9118bba1c0d017fb57">distCoeffs</a></div><div class="ttdeci">Mat distCoeffs</div><div class="ttdoc">distortion coefficients of the camera </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00125">main.cpp:125</a></div></div>
<div class="ttc" id="main_8cpp_html_a700b8df52e2beb702d06651ed6130e73"><div class="ttname"><a href="main_8cpp.html#a700b8df52e2beb702d06651ed6130e73">velocity</a></div><div class="ttdeci">Vec3d velocity</div><div class="ttdoc">velocity vector of object in o-CoSy in respect to o-CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00084">main.cpp:84</a></div></div>
<div class="ttc" id="main_8cpp_html_acf655f393e3996144226399a338e8d3b"><div class="ttname"><a href="main_8cpp.html#acf655f393e3996144226399a338e8d3b">gotOrder</a></div><div class="ttdeci">bool gotOrder</div><div class="ttdoc">order of the list_points3d and list_points3d already tetermined or not, has to be done once ...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00120">main.cpp:120</a></div></div>
<div class="ttc" id="main_8cpp_html_a2104a5d9d6b9f1e29bc4cd858c59882e"><div class="ttname"><a href="main_8cpp.html#a2104a5d9d6b9f1e29bc4cd858c59882e">projectCoordinateFrame</a></div><div class="ttdeci">void projectCoordinateFrame(Mat pictureFrame)</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l01099">main.cpp:1099</a></div></div>
<div class="ttc" id="main_8cpp_html_a85d3d8c8a0e3e9cfb6157c247470d934"><div class="ttname"><a href="main_8cpp.html#a85d3d8c8a0e3e9cfb6157c247470d934">list_points2dOld</a></div><div class="ttdeci">std::vector&lt; Point2d &gt; list_points2dOld</div><div class="ttdoc">marker positions in previous picture in 2D in camera image CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00109">main.cpp:109</a></div></div>
<div class="ttc" id="main_8cpp_html_a53e8957a459b639ca82d938157f3b085"><div class="ttname"><a href="main_8cpp.html#a53e8957a459b639ca82d938157f3b085">cameraMatrix</a></div><div class="ttdeci">Mat cameraMatrix</div><div class="ttdoc">camera matrix of the camera </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00124">main.cpp:124</a></div></div>
<div class="ttc" id="main_8cpp_html_a10895c5c32e9441213c79f05d2b5ba45"><div class="ttname"><a href="main_8cpp.html#a10895c5c32e9441213c79f05d2b5ba45">logFileName</a></div><div class="ttdeci">QString logFileName</div><div class="ttdoc">Filename for the logfiles. </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00143">main.cpp:143</a></div></div>
<div class="ttc" id="main_8cpp_html_a6b1342fd3f76c3ce13245825cff8e400"><div class="ttname"><a href="main_8cpp.html#a6b1342fd3f76c3ce13245825cff8e400">exitRequested</a></div><div class="ttdeci">bool exitRequested</div><div class="ttdoc">variable if tracking loop should be exited </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00074">main.cpp:74</a></div></div>
<div class="ttc" id="main_8cpp_html_a4e18b0b26ecc511ca7d2f2205313e537"><div class="ttname"><a href="main_8cpp.html#a4e18b0b26ecc511ca7d2f2205313e537">intIntensity</a></div><div class="ttdeci">int intIntensity</div><div class="ttdoc">max infrared spot light intensity is 15 1-6 is strobe 7-15 is continuous 13 and 14 are meaningless ...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00089">main.cpp:89</a></div></div>
<div class="ttc" id="main_8cpp_html_a11ff459289305229597defd39f510959"><div class="ttname"><a href="main_8cpp.html#a11ff459289305229597defd39f510959">determineOrder</a></div><div class="ttdeci">void determineOrder()</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l01516">main.cpp:1516</a></div></div>
<div class="ttc" id="main_8cpp_html_ac6dab448fd1f9b3aed1205fbd8179f5d"><div class="ttname"><a href="main_8cpp.html#ac6dab448fd1f9b3aed1205fbd8179f5d">position</a></div><div class="ttdeci">Vec3d position</div><div class="ttdoc">position vector x,y,z for object position in O-CoSy, unit is meter </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00081">main.cpp:81</a></div></div>
<div class="ttc" id="main_8cpp_html_a1d543a183197268bcb54a06bf157852c"><div class="ttname"><a href="main_8cpp.html#a1d543a183197268bcb54a06bf157852c">positionOld</a></div><div class="ttdeci">Vec3d positionOld</div><div class="ttdoc">old position in O-CoSy for finite differences velocity calculation </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00083">main.cpp:83</a></div></div>
<div class="ttc" id="main_8cpp_html_a377d62efbf6892902616cb71a4a5d5d7"><div class="ttname"><a href="main_8cpp.html#a377d62efbf6892902616cb71a4a5d5d7">headingOffset</a></div><div class="ttdeci">double headingOffset</div><div class="ttdoc">heading offset variable for aligning INS heading with tracking heading </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00087">main.cpp:87</a></div></div>
<div class="ttc" id="main_8cpp_html_ae101daeaec726e27690c862b7edea825"><div class="ttname"><a href="main_8cpp.html#ae101daeaec726e27690c862b7edea825">RvecOriginal</a></div><div class="ttdeci">Mat RvecOriginal</div><div class="ttdoc">initial values as start values for algorithms and algorithm tests </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00101">main.cpp:101</a></div></div>
<div class="ttc" id="main_8cpp_html_ada7a8f4e3e45f929a512ffb0d9ff9012"><div class="ttname"><a href="main_8cpp.html#ada7a8f4e3e45f929a512ffb0d9ff9012">frameTime</a></div><div class="ttdeci">double frameTime</div><div class="ttdoc">100 Hz CoSy rate, is later on replaced with the hardware timestamp delivered by the camera ...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00077">main.cpp:77</a></div></div>
<div class="ttc" id="main_8cpp_html_a7a642b2c947e62ff5ec692ec95783bd0"><div class="ttname"><a href="main_8cpp.html#a7a642b2c947e62ff5ec692ec95783bd0">logName</a></div><div class="ttdeci">std::string logName</div><div class="ttdoc">Filename for the logfiles as standard string. </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00144">main.cpp:144</a></div></div>
<div class="ttc" id="main_8cpp_html_a4ee4d2abbe47b92c21b81c5c4389086e"><div class="ttname"><a href="main_8cpp.html#a4ee4d2abbe47b92c21b81c5c4389086e">RmatRef</a></div><div class="ttdeci">Mat RmatRef</div><div class="ttdoc">reference rotation matrix from camera CoSy to marker CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00096">main.cpp:96</a></div></div>
<div class="ttc" id="main_8cpp_html_a9215ba881de0242c883e5b065d6d2ff9"><div class="ttname"><a href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a></div><div class="ttdeci">Mat Tvec</div><div class="ttdoc">translation vector from camera CoSy to marker CoSy in camera CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00100">main.cpp:100</a></div></div>
<div class="ttc" id="main_8cpp_html_ae65386c3310ab826e84fba757296de9a"><div class="ttname"><a href="main_8cpp.html#ae65386c3310ab826e84fba757296de9a">safetyAngle</a></div><div class="ttdeci">int safetyAngle</div><div class="ttdoc">bank and pitch angle protection in degrees </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00073">main.cpp:73</a></div></div>
<div class="ttc" id="main_8cpp_html_a267046e6c367b4c2dec18b9b772ab67a"><div class="ttname"><a href="main_8cpp.html#a267046e6c367b4c2dec18b9b772ab67a">logfile</a></div><div class="ttdeci">std::ofstream logfile</div><div class="ttdoc">file handler for writing the log file </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00146">main.cpp:146</a></div></div>
<div class="ttc" id="main_8cpp_html_afe37bd67ad83a2d897cf5977cba70ef3"><div class="ttname"><a href="main_8cpp.html#afe37bd67ad83a2d897cf5977cba70ef3">currentPointDistance</a></div><div class="ttdeci">double currentPointDistance</div><div class="ttdoc">distance from the projected 3D points (hence in 2d) to the real 2d marker positions in camera image C...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00117">main.cpp:117</a></div></div>
<div class="ttc" id="main_8cpp_html_ae144f2eb508ffc763c259d875c600ab2"><div class="ttname"><a href="main_8cpp.html#ae144f2eb508ffc763c259d875c600ab2">BACKBUFFER_BITSPERPIXEL</a></div><div class="ttdeci">const int BACKBUFFER_BITSPERPIXEL</div><div class="ttdoc">8 bit per pixel and greyscale image from camera </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00140">main.cpp:140</a></div></div>
<div class="ttc" id="main_8cpp_html_ac7de3790df75e7d70bfe280b9af47a56"><div class="ttname"><a href="main_8cpp.html#ac7de3790df75e7d70bfe280b9af47a56">timeFirstFrame</a></div><div class="ttdeci">double timeFirstFrame</div><div class="ttdoc">Time stamp of the first frame. This value is then subtracted for every other frame so the time in the...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00079">main.cpp:79</a></div></div>
<div class="ttc" id="main_8cpp_html_a7b0c222d472eacfd5b0d73ed769baae0"><div class="ttname"><a href="main_8cpp.html#a7b0c222d472eacfd5b0d73ed769baae0">M_HeadingOffset</a></div><div class="ttdeci">Mat M_HeadingOffset</div><div class="ttdoc">rotation matrix that turns the ground system to the INS magnetic heading for alignment ...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00098">main.cpp:98</a></div></div>
<div class="ttc" id="main_8cpp_html_acc9e758efd664582db86f976cec195fa"><div class="ttname"><a href="main_8cpp.html#acc9e758efd664582db86f976cec195fa">pointOrderIndicesNew</a></div><div class="ttdeci">int pointOrderIndicesNew[]</div><div class="ttdoc">new correspondence from list_points3d and list_points_2d </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00116">main.cpp:116</a></div></div>
<div class="ttc" id="main_8cpp_html_af2a8b7de0b15dc17198c147ba39e85f3"><div class="ttname"><a href="main_8cpp.html#af2a8b7de0b15dc17198c147ba39e85f3">closeUDP</a></div><div class="ttdeci">void closeUDP()</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l01191">main.cpp:1191</a></div></div>
<div class="ttc" id="main_8cpp_html_a54b6b6db348b48d21e1265e22829c61f"><div class="ttname"><a href="main_8cpp.html#a54b6b6db348b48d21e1265e22829c61f">sendDataUDP</a></div><div class="ttdeci">void sendDataUDP(cv::Vec3d &amp;Position, cv::Vec3d &amp;Euler)</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l01172">main.cpp:1172</a></div></div>
<div class="ttc" id="main_8cpp_html_af6430ad2592a955a3618549547dfc5be"><div class="ttname"><a href="main_8cpp.html#af6430ad2592a955a3618549547dfc5be">drawPositionText</a></div><div class="ttdeci">void drawPositionText(cv::Mat &amp;Picture, cv::Vec3d &amp;Position, cv::Vec3d &amp;Euler, double error)</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l01333">main.cpp:1333</a></div></div>
<div class="ttc" id="main_8cpp_html_a0a53d01e06c71d6360afcb0fabf2aa8e"><div class="ttname"><a href="main_8cpp.html#a0a53d01e06c71d6360afcb0fabf2aa8e">eulerAngles</a></div><div class="ttdeci">Vec3d eulerAngles</div><div class="ttdoc">Roll Pitch Heading in this order, units in degrees. </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00082">main.cpp:82</a></div></div>
<div class="ttc" id="main_8cpp_html_aba7ea4b1074abf42199ab9ab295e9c33"><div class="ttname"><a href="main_8cpp.html#aba7ea4b1074abf42199ab9ab295e9c33">logDate</a></div><div class="ttdeci">SYSTEMTIME logDate</div><div class="ttdoc">Systemtime struct that saves the current date and time thats needed for the log file name creation...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00145">main.cpp:145</a></div></div>
<div class="ttc" id="main_8cpp_html_aa5b833b78b107a1a04eb4edba151c0ba"><div class="ttname"><a href="main_8cpp.html#aa5b833b78b107a1a04eb4edba151c0ba">intFrameRate</a></div><div class="ttdeci">int intFrameRate</div><div class="ttdoc">CoSy rate of camera, maximum is 100 fps. </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00091">main.cpp:91</a></div></div>
<div class="ttc" id="main_8cpp_html_ae1d37a43f631aefe76b6e540da786064"><div class="ttname"><a href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a></div><div class="ttdeci">int numberMarkers</div><div class="ttdoc">number of markers. Is loaded during start up from the marker configuration file </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00106">main.cpp:106</a></div></div>
<div class="ttc" id="main_8cpp_html_aa6266eedab8b3c011be53baffbfc42ab"><div class="ttname"><a href="main_8cpp.html#aa6266eedab8b3c011be53baffbfc42ab">safetyEnable</a></div><div class="ttdeci">bool safetyEnable</div><div class="ttdoc">is the safety feature enabled </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00070">main.cpp:70</a></div></div>
<div class="ttc" id="main_8cpp_html_ab2b71933055cf32cc8e5e2100fd7723f"><div class="ttname"><a href="main_8cpp.html#ab2b71933055cf32cc8e5e2100fd7723f">getEulerAngles</a></div><div class="ttdeci">void getEulerAngles(Mat &amp;rotCamerMatrix, Vec3d &amp;eulerAngles)</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00256">main.cpp:256</a></div></div>
<div class="ttc" id="main_8cpp_html_a2c1b807fcb2de5a6759bd60ccae6dd7e"><div class="ttname"><a href="main_8cpp.html#a2c1b807fcb2de5a6759bd60ccae6dd7e">safetyBoxLength</a></div><div class="ttdeci">double safetyBoxLength</div><div class="ttdoc">length of the safety area cube in meters </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00072">main.cpp:72</a></div></div>
<div class="ttc" id="main_8cpp_html_ad44c6ce322034044d573e6d4678d630b"><div class="ttname"><a href="main_8cpp.html#ad44c6ce322034044d573e6d4678d630b">data</a></div><div class="ttdeci">QByteArray data</div><div class="ttdoc">data package that&amp;#39;s sent to the safety receiver </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00138">main.cpp:138</a></div></div>
<div class="ttc" id="main_8cpp_html_a0416912fce6274568e80019b10ba294f"><div class="ttname"><a href="main_8cpp.html#a0416912fce6274568e80019b10ba294f">determineExposure</a></div><div class="ttdeci">int determineExposure()</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l01380">main.cpp:1380</a></div></div>
<div class="ttc" id="main_8cpp_html_ad583e75f176dafdb7de3f214673851de"><div class="ttname"><a href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a></div><div class="ttdeci">std::vector&lt; Point2d &gt; list_points2d</div><div class="ttdoc">marker positions projected in 2D in camera image CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00108">main.cpp:108</a></div></div>
<div class="ttc" id="main_8cpp_html_a043bf1deaf5d42d47e0cce8982c1f18b"><div class="ttname"><a href="main_8cpp.html#a043bf1deaf5d42d47e0cce8982c1f18b">TvecOriginal</a></div><div class="ttdeci">Mat TvecOriginal</div><div class="ttdoc">initial values as start values for algorithms and algorithm tests </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00102">main.cpp:102</a></div></div>
<div class="ttc" id="main_8cpp_html_a933edb4ba1c0589d59020164c2f1ff87"><div class="ttname"><a href="main_8cpp.html#a933edb4ba1c0589d59020164c2f1ff87">list_points3d</a></div><div class="ttdeci">std::vector&lt; Point3d &gt; list_points3d</div><div class="ttdoc">marker positions in marker CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00107">main.cpp:107</a></div></div>
<div class="ttc" id="main_8cpp_html_ab826a7ca5876afdd6c0bccf04b73b30b"><div class="ttname"><a href="main_8cpp.html#ab826a7ca5876afdd6c0bccf04b73b30b">minPointDistance</a></div><div class="ttdeci">double minPointDistance</div><div class="ttdoc">minimum distance from the projected 3D points (hence in 2d) to the real 2d marker positions in camera...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00118">main.cpp:118</a></div></div>
<div class="ttc" id="main_8cpp_html_ab5e634b66221f494504aea1557af5df9"><div class="ttname"><a href="main_8cpp.html#ab5e634b66221f494504aea1557af5df9">methodPNP</a></div><div class="ttdeci">int methodPNP</div><div class="ttdoc">solvePNP algorithm 0 = iterative 1 = EPNP 2 = P3P 4 = UPNP //!&lt; 4 and 1 are the same and not implemen...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00105">main.cpp:105</a></div></div>
<div class="ttc" id="main_8cpp_html_a9d2e25dbfda0ebcdbb488652c8b15fad"><div class="ttname"><a href="main_8cpp.html#a9d2e25dbfda0ebcdbb488652c8b15fad">posRef</a></div><div class="ttdeci">Vec3d posRef</div><div class="ttdoc">initial position of object in camera CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00085">main.cpp:85</a></div></div>
<div class="ttc" id="main_8cpp_html_a5cc3bd09f5801804b7ae65846e0b9824"><div class="ttname"><a href="main_8cpp.html#a5cc3bd09f5801804b7ae65846e0b9824">invertZ</a></div><div class="ttdeci">int invertZ</div><div class="ttdoc">dummy variable to invert Z direction on request </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00075">main.cpp:75</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="main_8h_a3d3afd29ce54eb7fc5cc7e74ab666586_cgraph.svg" width="316" height="443"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="main_8h_a3d3afd29ce54eb7fc5cc7e74ab666586_icgraph.svg" width="276" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a847c0fbd3e513fb76ff145b31a9f5c37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a847c0fbd3e513fb76ff145b31a9f5c37">&#9670;&nbsp;</a></span>testAlgorithms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void testAlgorithms </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Project some points from 3D to 2D and then check the accuracy of the algorithms. Mainly to generate something that can be shown in the camera view so the user knows everything loaded correctly. </p>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l00970">970</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;{</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="keywordtype">int</span> _methodPNP;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    std::vector&lt;Point2d&gt; noise(<a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>);</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <a class="code" href="main_8cpp.html#ae101daeaec726e27690c862b7edea825">RvecOriginal</a> = <a class="code" href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a>;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <a class="code" href="main_8cpp.html#a043bf1deaf5d42d47e0cce8982c1f18b">TvecOriginal</a> = <a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    projectPoints(<a class="code" href="main_8cpp.html#a933edb4ba1c0589d59020164c2f1ff87">list_points3d</a>, <a class="code" href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a>, <a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>, <a class="code" href="main_8cpp.html#a53e8957a459b639ca82d938157f3b085">cameraMatrix</a>, <a class="code" href="main_8cpp.html#a8d67876da148be9118bba1c0d017fb57">distCoeffs</a>, <a class="code" href="main_8cpp.html#a7b88d0425a68875639d40a17079df819">list_points2dProjected</a>);</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;Unsorted Points 2D Projected \n&quot;</span>;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <a class="code" href="main_8cpp.html#a7b88d0425a68875639d40a17079df819">list_points2dProjected</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(QString::fromStdString(<a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str()));</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    Mat cFrame(480, 640, CV_8UC3, Scalar(0, 0, 0));</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>; i++)</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    {</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        circle(cFrame, Point(list_points2dProjected[i].x, list_points2dProjected[i].y), 6, Scalar(0, 255, 0), 3);</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    }</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <a class="code" href="main_8cpp.html#a2104a5d9d6b9f1e29bc4cd858c59882e">projectCoordinateFrame</a>(cFrame);</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;=====================================================\n&quot;</span>;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;================= Projected Points ==================\n&quot;</span>;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; list_points2dProjected &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    randn(noise, 0, 0.5);</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    add(list_points2dProjected, noise, list_points2dProjected);</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;================ With Noise Points ==================\n&quot;</span>;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; list_points2dProjected &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(QString::fromStdString(<a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str()));</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="main_8cpp.html#ab1cc9be1ff0871bc5de1eb4c2811ae3e">useGuess</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    _methodPNP = 0; <span class="comment">//!&lt; 0 = iterative 1 = EPNP 2 = P3P 4 = UPNP  //!&lt; not used</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    solvePnP(<a class="code" href="main_8cpp.html#a933edb4ba1c0589d59020164c2f1ff87">list_points3d</a>, list_points2dProjected, <a class="code" href="main_8cpp.html#a53e8957a459b639ca82d938157f3b085">cameraMatrix</a>, <a class="code" href="main_8cpp.html#a8d67876da148be9118bba1c0d017fb57">distCoeffs</a>, <a class="code" href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a>, <a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a>, useGuess, _methodPNP);</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;=====================================================\n&quot;</span>;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;==================== Iterative =====================\n&quot;</span>;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;rvec: &quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <a class="code" href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;tvec: &quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <a class="code" href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(QString::fromStdString(<a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str()));</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    _methodPNP = 1; <span class="comment">//!&lt; 0 = iterative 1 = EPNP 2 = P3P 4 = UPNP UPnP not used</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment"></span>    Rvec = cv::Mat::zeros(3, 1, CV_64F);</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    Tvec = cv::Mat::zeros(3, 1, CV_64F);</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    solvePnP(<a class="code" href="main_8cpp.html#a933edb4ba1c0589d59020164c2f1ff87">list_points3d</a>, list_points2dProjected, <a class="code" href="main_8cpp.html#a53e8957a459b639ca82d938157f3b085">cameraMatrix</a>, <a class="code" href="main_8cpp.html#a8d67876da148be9118bba1c0d017fb57">distCoeffs</a>, Rvec, Tvec, useGuess, _methodPNP);</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;=====================================================\n&quot;</span>;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;====================    EPNP    =====================\n&quot;</span>;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;rvec: &quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; Rvec &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;tvec: &quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; Tvec &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    projectPoints(<a class="code" href="main_8cpp.html#a933edb4ba1c0589d59020164c2f1ff87">list_points3d</a>, Rvec, Tvec, <a class="code" href="main_8cpp.html#a53e8957a459b639ca82d938157f3b085">cameraMatrix</a>, <a class="code" href="main_8cpp.html#a8d67876da148be9118bba1c0d017fb57">distCoeffs</a>, list_points2dProjected);</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>; i++)</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    {</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;        circle(cFrame, Point(list_points2dProjected[i].x, list_points2dProjected[i].y), 3, Scalar(255, 0, 0), 3);</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    }</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    QPixmap QPFrame;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    QPFrame = <a class="code" href="main_8cpp.html#a3e3cc959a7ab6f93ea52863d86373ce5">Mat2QPixmap</a>(cFrame);</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.changeImage(QPFrame);</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    QCoreApplication::processEvents();</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(QString::fromStdString(<a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str()));</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="keywordflow">if</span> (numberMarkers == 4)</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    {</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        _methodPNP = 2; <span class="comment">//!&lt; 0 = iterative 1 = EPNP 2 = P3P 4 = UPNP  //!&lt; not used</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="comment"></span>        Rvec = cv::Mat::zeros(3, 1, CV_64F);</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        Tvec = cv::Mat::zeros(3, 1, CV_64F);</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        solvePnP(<a class="code" href="main_8cpp.html#a933edb4ba1c0589d59020164c2f1ff87">list_points3d</a>, list_points2dProjected, <a class="code" href="main_8cpp.html#a53e8957a459b639ca82d938157f3b085">cameraMatrix</a>, <a class="code" href="main_8cpp.html#a8d67876da148be9118bba1c0d017fb57">distCoeffs</a>, Rvec, Tvec, useGuess, _methodPNP);</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;=====================================================\n&quot;</span>;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;====================     P3P    =====================\n&quot;</span>;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;rvec: &quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; Rvec &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;tvec: &quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; Tvec &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        projectPoints(<a class="code" href="main_8cpp.html#a933edb4ba1c0589d59020164c2f1ff87">list_points3d</a>, Rvec, Tvec, <a class="code" href="main_8cpp.html#a53e8957a459b639ca82d938157f3b085">cameraMatrix</a>, <a class="code" href="main_8cpp.html#a8d67876da148be9118bba1c0d017fb57">distCoeffs</a>, list_points2dProjected);</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a>; i++)</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        {</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;            circle(cFrame, Point(list_points2dProjected[i].x, list_points2dProjected[i].y), 3, Scalar(255, 0, 0), 3);</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        }</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        <span class="keywordtype">double</span> projectionError = norm(list_points2dProjected, <a class="code" href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a>);</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        putText(cFrame, <span class="stringliteral">&quot;Testing Algorithms Finished&quot;</span>, cv::Point(5, 420), 1, 1, cv::Scalar(255, 255, 255));</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        <a class="code" href="main_8cpp.html#af6430ad2592a955a3618549547dfc5be">drawPositionText</a>(cFrame, <a class="code" href="main_8cpp.html#ac6dab448fd1f9b3aed1205fbd8179f5d">position</a>, <a class="code" href="main_8cpp.html#a0a53d01e06c71d6360afcb0fabf2aa8e">eulerAngles</a>, projectionError);</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        QPixmap QPFrame;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        QPFrame = <a class="code" href="main_8cpp.html#a3e3cc959a7ab6f93ea52863d86373ce5">Mat2QPixmap</a>(cFrame);</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.changeImage(QPFrame);</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        QCoreApplication::processEvents();</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(QString::fromStdString(<a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str()));</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    }</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    _methodPNP = 4; <span class="comment">//!&lt; 0 = iterative 1 = EPNP 2 = P3P 4 = UPNP  //!&lt; not used</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="comment"></span>    Rvec = cv::Mat::zeros(3, 1, CV_64F);</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    Tvec = cv::Mat::zeros(3, 1, CV_64F);</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    solvePnP(<a class="code" href="main_8cpp.html#a933edb4ba1c0589d59020164c2f1ff87">list_points3d</a>, list_points2dProjected, <a class="code" href="main_8cpp.html#a53e8957a459b639ca82d938157f3b085">cameraMatrix</a>, <a class="code" href="main_8cpp.html#a8d67876da148be9118bba1c0d017fb57">distCoeffs</a>, Rvec, Tvec, useGuess, _methodPNP);</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;=====================================================\n&quot;</span>;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;====================    UPNP    =====================\n&quot;</span>;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;rvec: &quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; Rvec &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; <span class="stringliteral">&quot;tvec: &quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    <a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a> &lt;&lt; Tvec &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <a class="code" href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a>.addLog(QString::fromStdString(<a class="code" href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a>.str()));</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    Rvec = <a class="code" href="main_8cpp.html#ae101daeaec726e27690c862b7edea825">RvecOriginal</a>;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    Tvec = <a class="code" href="main_8cpp.html#a043bf1deaf5d42d47e0cce8982c1f18b">TvecOriginal</a>;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;}</div><div class="ttc" id="main_8cpp_html_ae095f10a005e68d20233dc15b4077ca6"><div class="ttname"><a href="main_8cpp.html#ae095f10a005e68d20233dc15b4077ca6">Rvec</a></div><div class="ttdeci">Mat Rvec</div><div class="ttdoc">rotation vector (axis-angle notation) from camera CoSy to marker CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00099">main.cpp:99</a></div></div>
<div class="ttc" id="main_8cpp_html_a7b88d0425a68875639d40a17079df819"><div class="ttname"><a href="main_8cpp.html#a7b88d0425a68875639d40a17079df819">list_points2dProjected</a></div><div class="ttdeci">std::vector&lt; Point2d &gt; list_points2dProjected</div><div class="ttdoc">3D marker points projected to 2D in camera image CoSy with the algorithm projectPoints ...</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00111">main.cpp:111</a></div></div>
<div class="ttc" id="main_8cpp_html_a3e3cc959a7ab6f93ea52863d86373ce5"><div class="ttname"><a href="main_8cpp.html#a3e3cc959a7ab6f93ea52863d86373ce5">Mat2QPixmap</a></div><div class="ttdeci">QPixmap Mat2QPixmap(cv::Mat src)</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00225">main.cpp:225</a></div></div>
<div class="ttc" id="main_8cpp_html_af29e7fc07ae0979d5fb61b473241d33d"><div class="ttname"><a href="main_8cpp.html#af29e7fc07ae0979d5fb61b473241d33d">commObj</a></div><div class="ttdeci">commObject commObj</div><div class="ttdoc">class that handles the communication from main.cpp to the GUI </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00068">main.cpp:68</a></div></div>
<div class="ttc" id="main_8cpp_html_ab1cc9be1ff0871bc5de1eb4c2811ae3e"><div class="ttname"><a href="main_8cpp.html#ab1cc9be1ff0871bc5de1eb4c2811ae3e">useGuess</a></div><div class="ttdeci">bool useGuess</div><div class="ttdoc">set to true and the algorithm uses the last result as starting value </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00104">main.cpp:104</a></div></div>
<div class="ttc" id="main_8cpp_html_a8d67876da148be9118bba1c0d017fb57"><div class="ttname"><a href="main_8cpp.html#a8d67876da148be9118bba1c0d017fb57">distCoeffs</a></div><div class="ttdeci">Mat distCoeffs</div><div class="ttdoc">distortion coefficients of the camera </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00125">main.cpp:125</a></div></div>
<div class="ttc" id="main_8cpp_html_a2104a5d9d6b9f1e29bc4cd858c59882e"><div class="ttname"><a href="main_8cpp.html#a2104a5d9d6b9f1e29bc4cd858c59882e">projectCoordinateFrame</a></div><div class="ttdeci">void projectCoordinateFrame(Mat pictureFrame)</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l01099">main.cpp:1099</a></div></div>
<div class="ttc" id="main_8cpp_html_a53e8957a459b639ca82d938157f3b085"><div class="ttname"><a href="main_8cpp.html#a53e8957a459b639ca82d938157f3b085">cameraMatrix</a></div><div class="ttdeci">Mat cameraMatrix</div><div class="ttdoc">camera matrix of the camera </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00124">main.cpp:124</a></div></div>
<div class="ttc" id="main_8cpp_html_ac6dab448fd1f9b3aed1205fbd8179f5d"><div class="ttname"><a href="main_8cpp.html#ac6dab448fd1f9b3aed1205fbd8179f5d">position</a></div><div class="ttdeci">Vec3d position</div><div class="ttdoc">position vector x,y,z for object position in O-CoSy, unit is meter </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00081">main.cpp:81</a></div></div>
<div class="ttc" id="main_8cpp_html_ae101daeaec726e27690c862b7edea825"><div class="ttname"><a href="main_8cpp.html#ae101daeaec726e27690c862b7edea825">RvecOriginal</a></div><div class="ttdeci">Mat RvecOriginal</div><div class="ttdoc">initial values as start values for algorithms and algorithm tests </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00101">main.cpp:101</a></div></div>
<div class="ttc" id="main_8cpp_html_a9215ba881de0242c883e5b065d6d2ff9"><div class="ttname"><a href="main_8cpp.html#a9215ba881de0242c883e5b065d6d2ff9">Tvec</a></div><div class="ttdeci">Mat Tvec</div><div class="ttdoc">translation vector from camera CoSy to marker CoSy in camera CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00100">main.cpp:100</a></div></div>
<div class="ttc" id="main_8cpp_html_a8fc3524f4e679a41dcc8d0f302d637ed"><div class="ttname"><a href="main_8cpp.html#a8fc3524f4e679a41dcc8d0f302d637ed">ss</a></div><div class="ttdeci">std::stringstream ss</div><div class="ttdoc">stream that sends the strBuf buffer to the Qt GUI </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00142">main.cpp:142</a></div></div>
<div class="ttc" id="main_8cpp_html_af6430ad2592a955a3618549547dfc5be"><div class="ttname"><a href="main_8cpp.html#af6430ad2592a955a3618549547dfc5be">drawPositionText</a></div><div class="ttdeci">void drawPositionText(cv::Mat &amp;Picture, cv::Vec3d &amp;Position, cv::Vec3d &amp;Euler, double error)</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l01333">main.cpp:1333</a></div></div>
<div class="ttc" id="main_8cpp_html_a0a53d01e06c71d6360afcb0fabf2aa8e"><div class="ttname"><a href="main_8cpp.html#a0a53d01e06c71d6360afcb0fabf2aa8e">eulerAngles</a></div><div class="ttdeci">Vec3d eulerAngles</div><div class="ttdoc">Roll Pitch Heading in this order, units in degrees. </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00082">main.cpp:82</a></div></div>
<div class="ttc" id="main_8cpp_html_ae1d37a43f631aefe76b6e540da786064"><div class="ttname"><a href="main_8cpp.html#ae1d37a43f631aefe76b6e540da786064">numberMarkers</a></div><div class="ttdeci">int numberMarkers</div><div class="ttdoc">number of markers. Is loaded during start up from the marker configuration file </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00106">main.cpp:106</a></div></div>
<div class="ttc" id="main_8cpp_html_ad583e75f176dafdb7de3f214673851de"><div class="ttname"><a href="main_8cpp.html#ad583e75f176dafdb7de3f214673851de">list_points2d</a></div><div class="ttdeci">std::vector&lt; Point2d &gt; list_points2d</div><div class="ttdoc">marker positions projected in 2D in camera image CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00108">main.cpp:108</a></div></div>
<div class="ttc" id="main_8cpp_html_a043bf1deaf5d42d47e0cce8982c1f18b"><div class="ttname"><a href="main_8cpp.html#a043bf1deaf5d42d47e0cce8982c1f18b">TvecOriginal</a></div><div class="ttdeci">Mat TvecOriginal</div><div class="ttdoc">initial values as start values for algorithms and algorithm tests </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00102">main.cpp:102</a></div></div>
<div class="ttc" id="main_8cpp_html_a933edb4ba1c0589d59020164c2f1ff87"><div class="ttname"><a href="main_8cpp.html#a933edb4ba1c0589d59020164c2f1ff87">list_points3d</a></div><div class="ttdeci">std::vector&lt; Point3d &gt; list_points3d</div><div class="ttdoc">marker positions in marker CoSy </div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00107">main.cpp:107</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="main_8h_a847c0fbd3e513fb76ff145b31a9f5c37_cgraph.svg" width="326" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="main_8h_a847c0fbd3e513fb76ff145b31a9f5c37_icgraph.svg" width="216" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="af29e7fc07ae0979d5fb61b473241d33d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af29e7fc07ae0979d5fb61b473241d33d">&#9670;&nbsp;</a></span>commObj</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">commObject commObj</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>class that handles the communication from <a class="el" href="main_8cpp.html" title="Rigid Track main file that contains most functionallity. ">main.cpp</a> to the GUI </p>
<p>Now declare variables that are used across the <a class="el" href="main_8cpp.html" title="Rigid Track main file that contains most functionallity. ">main.cpp</a> file. Basically almost every variable used is declared here. </p>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l00068">68</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_0a4a585469a8924d4665b56217bcc10e.html">RigidTrack</a></li><li class="navelem"><a class="el" href="main_8h.html">main.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
